<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Higher order neighbours lists — nblag • spdep</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Higher order neighbours lists — nblag" />
<meta property="og:description" content="The function creates higher order neighbour lists, where higher order neighbours are only lags links from each other on the graph described by the input neighbours list. It will refuse to lag neighbours lists with the attribute self.included set to TRUE. nblag_cumul cumulates neighbour lists to a single neighbour list (&amp;#8220;nb&amp;#8221; object)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spdep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1-7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/CO69.html">“The Problem of Spatial Autocorrelation:” forty years on</a>
    </li>
    <li>
      <a href="../articles/nb.html">Creating Neighbours</a>
    </li>
    <li>
      <a href="../articles/nb_igraph.html">Spatial weights objects as sparse matrices and graphs</a>
    </li>
    <li>
      <a href="../articles/nb_sf.html">Creating Neighbours using sf objects</a>
    </li>
    <li>
      <a href="../articles/sids.html">Introduction to the North Carolina SIDS data set (re-revised)</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-spatial/spdep/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Higher order neighbours lists</h1>
    
    <div class="hidden name"><code>nblag.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function creates higher order neighbour lists, where higher order neighbours are only <code>lags</code> links from each other on the graph described by the input neighbours list. It will refuse to lag neighbours lists with the attribute self.included set to TRUE. <code>nblag_cumul</code> cumulates neighbour lists to a single neighbour list (&#8220;nb&#8221; object).</p>
    </div>

    <pre class="usage"><span class='fu'>nblag</span><span class='op'>(</span><span class='va'>neighbours</span>, <span class='va'>maxlag</span><span class='op'>)</span>
<span class='fu'>nblag_cumul</span><span class='op'>(</span><span class='va'>nblags</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>neighbours</th>
      <td><p>input neighbours list of class <code>nb</code></p></td>
    </tr>
    <tr>
      <th>maxlag</th>
      <td><p>the maximum lag to be constructed</p></td>
    </tr>
    <tr>
      <th>nblags</th>
      <td><p>a list of neighbour lists as output by <code>nblag</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>returns a list of lagged neighbours lists each with class <code>nb</code></p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Roger Bivand <a href='mailto:Roger.Bivand@nhh.no'>Roger.Bivand@nhh.no</a> and Giovanni Millo</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='summary.nb.html'>summary.nb</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>columbus</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"shapes/columbus.shp"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, quiet<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>col.gal.nb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='read.gal.html'>read.gal</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"weights/columbus.gal"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>coords</span> <span class='op'>&lt;-</span> <span class='fu'>coordinates</span><span class='op'>(</span><span class='fu'>as</span><span class='op'>(</span><span class='va'>columbus</span>, <span class='st'>"Spatial"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>col.gal.nb</span>, <span class='va'>coords</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Neighbour list object:
#&gt; Number of regions: 49 
#&gt; Number of nonzero links: 230 
#&gt; Percentage nonzero weights: 9.579342 
#&gt; Average number of links: 4.693878 
#&gt; Link number distribution:
#&gt; 
#&gt;  2  3  4  5  6  7  8  9 10 
#&gt;  7  7 13  4  9  6  1  1  1 
#&gt; 7 least connected regions:
#&gt; 1 6 31 39 42 46 47 with 2 links
#&gt; 1 most connected region:
#&gt; 20 with 10 links
#&gt; Summary of link distances:
#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt;  0.1276  0.3613  0.4566  0.4694  0.5536  0.8924 
#&gt; 
#&gt;   The decimal point is 1 digit(s) to the left of the |
#&gt; 
#&gt;   1 | 3344
#&gt;   1 | 99
#&gt;   2 | 000011333344
#&gt;   2 | 556677779999
#&gt;   3 | 000011222222223344444444
#&gt;   3 | 556666777777888888889999999999
#&gt;   4 | 00001111112233333333334444
#&gt;   4 | 55666666666666777777777788888899
#&gt;   5 | 0011112222222222222233334444
#&gt;   5 | 556666667788
#&gt;   6 | 000000112244
#&gt;   6 | 5577889999
#&gt;   7 | 11112244
#&gt;   7 | 557777
#&gt;   8 | 1144
#&gt;   8 | 55999999
#&gt; </div><div class='input'><span class='va'>col.lags</span> <span class='op'>&lt;-</span> <span class='fu'>nblag</span><span class='op'>(</span><span class='va'>col.gal.nb</span>, <span class='fl'>2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>col.lags</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [[1]]
#&gt; Neighbour list object:
#&gt; Number of regions: 49 
#&gt; Number of nonzero links: 230 
#&gt; Percentage nonzero weights: 9.579342 
#&gt; Average number of links: 4.693878 
#&gt; 
#&gt; [[2]]
#&gt; Neighbour list object:
#&gt; Number of regions: 49 
#&gt; Number of nonzero links: 406 
#&gt; Percentage nonzero weights: 16.90962 
#&gt; Average number of links: 8.285714 
#&gt; 
#&gt; attr(,"call")
#&gt; nblag(neighbours = col.gal.nb, maxlag = 2)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>col.lags</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span>, <span class='va'>coords</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Neighbour list object:
#&gt; Number of regions: 49 
#&gt; Number of nonzero links: 406 
#&gt; Percentage nonzero weights: 16.90962 
#&gt; Average number of links: 8.285714 
#&gt; Link number distribution:
#&gt; 
#&gt;  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 
#&gt;  1  2  5  4  2  3  5  4  2  3  7  3  4  1  1  1  1 
#&gt; 1 least connected region:
#&gt; 36 with 1 link
#&gt; 1 most connected region:
#&gt; 25 with 17 links
#&gt; Summary of link distances:
#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt;  0.3209  0.7126  0.8481  0.9023  1.0860  1.6743 
#&gt; 
#&gt;   The decimal point is 1 digit(s) to the left of the |
#&gt; 
#&gt;    3 | 2233557799
#&gt;    4 | 1166777788888888
#&gt;    5 | 0011224455555566666688889999
#&gt;    6 | 11113333334455556666666666889999999999
#&gt;    7 | 00000011112222222233334444444455555555556666667777777777777777889999
#&gt;    8 | 000011111111222222222233333344444444445555555555666666999999
#&gt;    9 | 001111222222222233444444555555556666667777778899
#&gt;   10 | 0000002222223333333344666666777788889999
#&gt;   11 | 00112233334444555566777788
#&gt;   12 | 1122223333555566667777888888889999
#&gt;   13 | 0000001166668899
#&gt;   14 | 002244558888
#&gt;   15 | 00667788
#&gt;   16 | 77
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>st_geometry</span><span class='op'>(</span><span class='va'>columbus</span><span class='op'>)</span>, border<span class='op'>=</span><span class='st'>"grey"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>col.gal.nb</span>, <span class='va'>coords</span>, add<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/title.html'>title</a></span><span class='op'>(</span>main<span class='op'>=</span><span class='st'>"GAL order 1 (black) and 2 (red) links"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>col.lags</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span>, <span class='va'>coords</span>, add<span class='op'>=</span><span class='cn'>TRUE</span>, col<span class='op'>=</span><span class='st'>"red"</span>, lty<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='img'><img src='nblag-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>cuml</span> <span class='op'>&lt;-</span> <span class='fu'>nblag_cumul</span><span class='op'>(</span><span class='va'>col.lags</span><span class='op'>)</span>
<span class='va'>cuml</span>
</div><div class='output co'>#&gt; Neighbour list object:
#&gt; Number of regions: 49 
#&gt; Number of nonzero links: 636 
#&gt; Percentage nonzero weights: 26.48896 
#&gt; Average number of links: 12.97959 </div><div class='input'><span class='va'>run</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://igraph.org'>igraph</a></span>, quietly<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='va'>run</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>W</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>col.gal.nb</span><span class='op'>)</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='va'>G</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_adjacency_matrix.html'>graph.adjacency</a></span><span class='op'>(</span><span class='va'>W</span>, mode<span class='op'>=</span><span class='st'>"directed"</span>, weight<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>
<span class='va'>D</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/diameter.html'>diameter</a></span><span class='op'>(</span><span class='va'>G</span><span class='op'>)</span>
<span class='va'>nbs</span> <span class='op'>&lt;-</span> <span class='fu'>nblag</span><span class='op'>(</span><span class='va'>col.gal.nb</span>, maxlag<span class='op'>=</span><span class='va'>D</span><span class='op'>)</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>col.gal.nb</span><span class='op'>)</span>
<span class='va'>lmat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>nbs</span>, <span class='va'>nb2mat</span>, style<span class='op'>=</span><span class='st'>"B"</span>, zero.policy<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>mat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>n</span>, <span class='va'>n</span><span class='op'>)</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>along<span class='op'>=</span><span class='va'>lmat</span><span class='op'>)</span><span class='op'>)</span> <span class='va'>mat</span> <span class='op'>=</span> <span class='va'>mat</span> <span class='op'>+</span> <span class='va'>i</span><span class='op'>*</span><span class='va'>lmat</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span>
<span class='va'>G2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/distances.html'>shortest.paths</a></span><span class='op'>(</span><span class='va'>G</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>G2</span>, <span class='va'>mat</span>, check.attributes<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; [1] TRUE</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Roger Bivand.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


