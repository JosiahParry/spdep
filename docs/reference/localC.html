<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compute Local Geary statistic — localC • spdep</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compute Local Geary statistic — localC"><meta property="og:description" content="The Local Geary is a local adaptation of Geary's C statistic of spatial autocorrelation. The Local Geary uses squared differences to measure dissimilarity unlike the Local Moran. Low values of the Local Geary indicate positive spatial autocorrelation and large refers to negative spatial autocorrelation.
Inference for the Local Geary is based on a permutation approach which compares the observed value to the reference distribution under spatial randomness. localC_perm() returns a pseudo p-value. This is not an analytical p-value and is based on the number of permutations and as such should be used with care."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spdep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/CO69.html">“The Problem of Spatial Autocorrelation:” forty years on</a>
    </li>
    <li>
      <a href="../articles/nb.html">Creating Neighbours</a>
    </li>
    <li>
      <a href="../articles/nb_sf.html">Creating Neighbours using sf objects</a>
    </li>
    <li>
      <a href="../articles/sids.html">Introduction to the North Carolina SIDS data set (re-revised)</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/r-spatial/spdep/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute Local Geary statistic</h1>
    <small class="dont-index">Source: <a href="https://github.com/r-spatial/spdep/blob/HEAD/R/localC-dev.R" class="external-link"><code>R/localC-dev.R</code></a></small>
    <div class="hidden name"><code>localC.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The Local Geary is a local adaptation of Geary's C statistic of spatial autocorrelation. The Local Geary uses squared differences to measure dissimilarity unlike the Local Moran. Low values of the Local Geary indicate positive spatial autocorrelation and large refers to negative spatial autocorrelation.</p>
<p>Inference for the Local Geary is based on a permutation approach which compares the observed value to the reference distribution under spatial randomness. <code>localC_perm()</code> returns a pseudo p-value. This is not an analytical p-value and is based on the number of permutations and as such should be used with care.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">localC</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, zero.policy<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span>

<span class="co"># S3 method for default</span>
<span class="fu">localC</span><span class="op">(</span><span class="va">x</span>, <span class="va">listw</span>, <span class="va">...</span>, zero.policy<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span>

<span class="co"># S3 method for formula</span>
<span class="fu">localC</span><span class="op">(</span><span class="va">formula</span>, <span class="va">listw</span>, <span class="va">data</span>, <span class="va">...</span>, zero.policy<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span>

<span class="co"># S3 method for list</span>
<span class="fu">localC</span><span class="op">(</span><span class="va">x</span>, <span class="va">listw</span>, <span class="va">...</span>, zero.policy<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span>

<span class="co"># S3 method for matrix</span>
<span class="fu">localC</span><span class="op">(</span><span class="va">x</span>, <span class="va">listw</span>, <span class="va">...</span>, zero.policy<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span>

<span class="co"># S3 method for data.frame</span>
<span class="fu">localC</span><span class="op">(</span><span class="va">x</span>, <span class="va">listw</span>, <span class="va">...</span>, zero.policy<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span>

<span class="fu">localC_perm</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, conditional<span class="op">=</span><span class="cn">FALSE</span>, zero.policy<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span>

<span class="co"># S3 method for default</span>
<span class="fu">localC_perm</span><span class="op">(</span><span class="va">x</span>, <span class="va">listw</span>, nsim <span class="op">=</span> <span class="fl">499</span>, alternative <span class="op">=</span> <span class="st">"less"</span>, <span class="va">...</span>,
 conditional<span class="op">=</span><span class="cn">FALSE</span>, zero.policy<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span>

<span class="co"># S3 method for formula</span>
<span class="fu">localC_perm</span><span class="op">(</span><span class="va">formula</span>, <span class="va">listw</span>, <span class="va">data</span>, nsim <span class="op">=</span> <span class="fl">499</span>,
 alternative <span class="op">=</span> <span class="st">"less"</span>, <span class="va">...</span>, conditional<span class="op">=</span><span class="cn">FALSE</span>, zero.policy<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>a numeric vector, numeric matrix, or list. See details for more.</p></dd>
<dt>formula</dt>
<dd><p>A one-sided formula determining which variables to be used.</p></dd>
<dt>listw</dt>
<dd><p>a <code>listw</code> object created for example by <code>nb2listw</code>.</p></dd>
<dt>data</dt>
<dd><p>Used when a formula is provided. A matrix or data frame containing the variables in the formula <code>formula</code>.</p></dd>
<dt>nsim</dt>
<dd><p>The number of simulations to be used for permutation test.</p></dd>
<dt>alternative</dt>
<dd><p>A character defining the alternative hypothesis. Must be one of <code>"less"</code> or <code>"greater"</code>.</p></dd>
<dt>...</dt>
<dd><p>other arguments passed to methods.</p></dd>
<dt>zero.policy</dt>
<dd><p>default NULL, use global option value; if TRUE assign zero to the lagged value of zones without neighbours, if FALSE assign NA.</p></dd>
<dt>conditional</dt>
<dd><p>default FALSE, sample from the whole data set; if TRUE, sample from all observations but the one which is being tested.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The Local Geary can be extended to a multivariate context. When <code>x</code> is a numeric vector, the univariate Local Geary will be calculated. To calculate the multivariate Local Moran provide either a list or a matrix. When <code>x</code> is a list, each element must be a numeric vector of the same length and of the same length as the neighbours in <code>listw</code>. In the case that <code>x</code> is a matrix the number of rows must be the same as the length of the neighbours in <code>listw</code>.</p>
<p>While not required in the univariate context, the standardized Local Geary is calculated. The multivariate Local Geary is <em>always</em> standardized.</p>
<p>The univariate Local Geary is calculated as \(c_i = \sum_j w_{ij}(x_i - x_j)^2\) and the multivariate Local Geary is calculated as \(c_{k,i} = \sum_{v=1}^{k} c_{v,i}\) as described in Anselin (2019).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Anselin, L. (1995), Local Indicators of Spatial Association—LISA. Geographical Analysis, 27: 93-115. doi: <a href="https://doi.org/10.1111/j.1538-4632.1995.tb00338.x" class="external-link">10.1111/j.1538-4632.1995.tb00338.x</a></p>
<p>Anselin, L. (2019), A Local Indicator of Multivariate Spatial Association: Extending Geary's c. Geogr Anal, 51: 133-150. doi: <a href="https://doi.org/10.1111/gean.12164" class="external-link">10.1111/gean.12164</a></p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Josiah Parry, <a href="mailto:josiah.parry@gmail.com">josiah.parry@gmail.com</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">orig</span> <span class="op">&lt;-</span> <span class="fu">spData</span><span class="fu">::</span><span class="va"><a href="https://nowosad.github.io/spData/reference/afcon.html" class="external-link">africa.rook.nb</a></span></span>
<span class="r-in"><span class="va">listw</span> <span class="op">&lt;-</span> <span class="fu"><a href="nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="va">orig</span><span class="op">)</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">spData</span><span class="fu">::</span><span class="va"><a href="https://nowosad.github.io/spData/reference/afcon.html" class="external-link">afcon</a></span><span class="op">$</span><span class="va">totcon</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="op">(</span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu">localC</span><span class="op">(</span><span class="va">x</span>, <span class="va">listw</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.39025457 0.50460439 0.15303047 2.90814878 3.40006901 0.17103368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] 0.29947832 0.72444806 2.30617282 5.70252541 2.23161263 0.17833029</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] 0.18420002 0.18680408 0.37851643 0.11056720 0.14814835 0.17257920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] 0.03254150 0.18992772 0.08749322 3.71970760 0.09566918 0.26112918</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] 0.09505331 2.99934478 1.17465032 1.64868780 0.87901004 0.05909537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] 2.54591475 3.85570655 2.99413462 0.96084992 0.80678832 1.56869350</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37] 0.86422915 0.38817470 0.23425755 1.26191610 1.34455327 1.80707481</span>
<span class="r-in"><span class="va">listw1</span> <span class="op">&lt;-</span> <span class="fu"><a href="nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="fu"><a href="droplinks.html">droplinks</a></span><span class="op">(</span><span class="fu"><a href="testnb.html">sym.attr.nb</a></span><span class="op">(</span><span class="va">orig</span><span class="op">)</span>, <span class="fl">3</span>, sym<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, zero.policy<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="op">(</span><span class="va">A1</span> <span class="op">&lt;-</span> <span class="fu">localC</span><span class="op">(</span><span class="va">x</span>, <span class="va">listw1</span>, zero.policy<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.39025457 0.57491918         NA 2.90814878 3.40006901 0.17103368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] 0.29947832 0.72444806 2.30617282 5.70252541 2.23161263 0.17833029</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] 0.18420002 0.18680408 0.37851643 0.11056720 0.14814835 0.17257920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] 0.03254150 0.18992772 0.08749322 3.71970760 0.09566918 0.26112918</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] 0.09505331 2.99934478 1.17465032 1.64868780 0.87901004 0.05909537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] 2.54591475 3.85570655 2.99413462 0.96084992 0.80678832 1.56869350</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37] 0.86422915 0.38817470 0.23425755 1.26191610 1.34455327 1.80707481</span>
<span class="r-in"><span class="op">(</span><span class="va">A2</span> <span class="op">&lt;-</span> <span class="fu">localC</span><span class="op">(</span><span class="va">x</span>, <span class="va">listw1</span>, zero.policy<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.39025457 0.57491918 0.00000000 2.90814878 3.40006901 0.17103368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] 0.29947832 0.72444806 2.30617282 5.70252541 2.23161263 0.17833029</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] 0.18420002 0.18680408 0.37851643 0.11056720 0.14814835 0.17257920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] 0.03254150 0.18992772 0.08749322 3.71970760 0.09566918 0.26112918</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] 0.09505331 2.99934478 1.17465032 1.64868780 0.87901004 0.05909537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] 2.54591475 3.85570655 2.99413462 0.96084992 0.80678832 1.56869350</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37] 0.86422915 0.38817470 0.23425755 1.26191610 1.34455327 1.80707481</span>
<span class="r-in"><span class="va">run</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/geodacenter/rgeoda/" class="external-link">rgeoda</a></span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="va">run</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘rgeoda’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:spdep’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     skater</span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="va">run</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://geodacenter.github.io/rgeoda/reference/create_weights.html" class="external-link">create_weights</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">listw</span><span class="op">$</span><span class="va">neighbours</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">    <span class="fu"><a href="https://geodacenter.github.io/rgeoda/reference/set_neighbors_with_weights.html" class="external-link">set_neighbors_with_weights</a></span><span class="op">(</span><span class="va">W</span>, <span class="va">i</span>, <span class="va">listw</span><span class="op">$</span><span class="va">neighbours</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">listw</span><span class="op">$</span><span class="va">weights</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in">    <span class="fu"><a href="https://geodacenter.github.io/rgeoda/reference/update_weights.html" class="external-link">update_weights</a></span><span class="op">(</span><span class="va">W</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">}</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-in">  <span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://geodacenter.github.io/rgeoda/reference/local_geary.html" class="external-link">local_geary</a></span><span class="op">(</span><span class="va">W</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">A</span>, <span class="fu"><a href="https://geodacenter.github.io/rgeoda/reference/lisa_values.html" class="external-link">lisa_values</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="va">run</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-in">  <span class="va">C</span> <span class="op">&lt;-</span> <span class="fu">localC_perm</span><span class="op">(</span><span class="va">x</span>, <span class="va">listw</span>, nsim <span class="op">=</span> <span class="fl">499</span>, conditional<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span class="r-in">    alternative<span class="op">=</span><span class="st">"two.sided"</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://geodacenter.github.io/rgeoda/reference/lisa_pvalues.html" class="external-link">lisa_pvalues</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.5</span>, <span class="fu"><a href="https://geodacenter.github.io/rgeoda/reference/lisa_pvalues.html" class="external-link">lisa_pvalues</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span>, <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://geodacenter.github.io/rgeoda/reference/lisa_pvalues.html" class="external-link">lisa_pvalues</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">C</span>, <span class="st">"pseudo-p"</span><span class="op">)</span><span class="op">[</span>,<span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.985611</span>
<span class="r-in"><span class="co"># pseudo-p values probably wrongly folded https://github.com/GeoDaCenter/rgeoda/issues/28</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/reticulate" class="external-link">reticulate</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/reticulate/man/use_python.html" class="external-link">use_python</a></span><span class="op">(</span><span class="st">"/usr/bin/python"</span>, required <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">gp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reticulate/man/import.html" class="external-link">import</a></span><span class="op">(</span><span class="st">"geopandas"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reticulate/man/import.html" class="external-link">import</a></span><span class="op">(</span><span class="st">"libpysal"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">tf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext<span class="op">=</span><span class="st">".gal"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="write.nb.gal.html">write.nb.gal</a></span><span class="op">(</span><span class="va">orig</span>, <span class="va">tf</span><span class="op">)</span></span>
<span class="r-in"><span class="va">fl</span> <span class="op">&lt;-</span> <span class="va">ps</span><span class="op">$</span><span class="va">io</span><span class="op">$</span><span class="fu">open</span><span class="op">(</span><span class="va">tf</span><span class="op">)</span></span>
<span class="r-in"><span class="va">w</span><span class="op">$</span><span class="va">transform</span> <span class="op">&lt;-</span> <span class="st">"R"</span></span>
<span class="r-in"><span class="va">esda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reticulate/man/import.html" class="external-link">import</a></span><span class="op">(</span><span class="st">"esda"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">lM</span> <span class="op">&lt;-</span> <span class="va">esda</span><span class="op">$</span><span class="fu">Moran_Local</span><span class="op">(</span><span class="va">x</span>, <span class="va">w</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="localmoran.html">localmoran</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">listw</span>, mlvar<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lM</span><span class="op">$</span><span class="va">Is</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># confirm x and w the same</span></span>
<span class="r-in"><span class="va">lC</span> <span class="op">&lt;-</span> <span class="va">esda</span><span class="op">$</span><span class="fu">Geary_Local</span><span class="op">(</span>connectivity<span class="op">=</span><span class="va">w</span><span class="op">)</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># np$std missing ddof=1 </span></span>
<span class="r-in"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-in"><span class="va">D01</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">:::</span><span class="fu">geary.intern</span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="va">n</span><span class="op">)</span>, <span class="va">listw</span>, n<span class="op">=</span><span class="va">n</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># lC components probably wrongly ordered https://github.com/pysal/esda/issues/192</span></span>
<span class="r-in"><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">D0</span>, <span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">lC</span><span class="op">$</span><span class="va">localG</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lC</span><span class="op">$</span><span class="va">localG</span><span class="op">)</span><span class="op">[</span><span class="va">o</span><span class="op">]</span>, <span class="va">D0</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># simulation order not retained</span></span>
<span class="r-in"><span class="va">lC</span><span class="op">$</span><span class="va">p_sim</span><span class="op">[</span><span class="va">o</span><span class="op">]</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">C</span>, <span class="st">"pseudo-p"</span><span class="op">)</span><span class="op">[</span>,<span class="fl">6</span><span class="op">]</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Roger Bivand.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

