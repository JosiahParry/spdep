<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Deprecated Functions in Package spdep — spdep-deprecated • spdep</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Deprecated Functions in Package spdep — spdep-deprecated" />
<meta property="og:description" content="These functions are provided for compatibility with older versions of
  spdep only, and may be defunct as soon as the next release. The
  functions have been moved to the spatialreg package." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spdep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1-9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/CO69.html">“The Problem of Spatial Autocorrelation:” forty years on</a>
    </li>
    <li>
      <a href="../articles/nb.html">Creating Neighbours</a>
    </li>
    <li>
      <a href="../articles/nb_igraph.html">Spatial weights objects as sparse matrices and graphs</a>
    </li>
    <li>
      <a href="../articles/nb_sf.html">Creating Neighbours using sf objects</a>
    </li>
    <li>
      <a href="../articles/sids.html">Introduction to the North Carolina SIDS data set (re-revised)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-spatial/spdep/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Deprecated Functions in Package <span class="pkg">spdep</span></h1>
    
    <div class="hidden name"><code>spdep-deprecated.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These functions are provided for compatibility with older versions of
  <span class="pkg">spdep</span> only, and may be defunct as soon as the next release. The
  functions have been moved to the <span class="pkg">spatialreg</span> package.</p>
    </div>

    <pre class="usage"><span class='fu'>lextrB</span><span class='op'>(</span><span class='va'>lw</span>, zero.policy <span class='op'>=</span> <span class='cn'>TRUE</span>, control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>lextrW</span><span class='op'>(</span><span class='va'>lw</span>, zero.policy<span class='op'>=</span><span class='cn'>TRUE</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>lextrS</span><span class='op'>(</span><span class='va'>lw</span>, zero.policy<span class='op'>=</span><span class='cn'>TRUE</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>#l_max(lw, zero.policy=TRUE, control=list())</span>
<span class='fu'>griffith_sone</span><span class='op'>(</span><span class='va'>P</span>, <span class='va'>Q</span>, type<span class='op'>=</span><span class='st'>"rook"</span><span class='op'>)</span>
<span class='fu'>subgraph_eigenw</span><span class='op'>(</span><span class='va'>nb</span>, glist<span class='op'>=</span><span class='cn'>NULL</span>, style<span class='op'>=</span><span class='st'>"W"</span>, zero.policy<span class='op'>=</span><span class='cn'>NULL</span>, quiet<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='fu'>mom_calc</span><span class='op'>(</span><span class='va'>lw</span>, <span class='va'>m</span><span class='op'>)</span>
<span class='fu'>mom_calc_int2</span><span class='op'>(</span><span class='va'>is</span>, <span class='va'>m</span>, <span class='va'>nb</span>, <span class='va'>weights</span>, <span class='va'>Card</span><span class='op'>)</span>
<span class='fu'>stsls</span><span class='op'>(</span><span class='va'>formula</span>, data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>listw</span>, zero.policy <span class='op'>=</span> <span class='cn'>NULL</span>,
 na.action <span class='op'>=</span> <span class='va'>na.fail</span>, robust <span class='op'>=</span> <span class='cn'>FALSE</span>, HC<span class='op'>=</span><span class='cn'>NULL</span>, legacy<span class='op'>=</span><span class='cn'>FALSE</span>, W2X <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='co'># S3 method for stsls</span>
<span class='fu'>impacts</span><span class='op'>(</span><span class='va'>obj</span>, <span class='va'>...</span>, <span class='va'>tr</span>, R <span class='op'>=</span> <span class='cn'>NULL</span>, listw <span class='op'>=</span> <span class='cn'>NULL</span>, evalues<span class='op'>=</span><span class='cn'>NULL</span>,
 tol <span class='op'>=</span> <span class='fl'>1e-06</span>, empirical <span class='op'>=</span> <span class='cn'>FALSE</span>, Q<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='fu'>GMerrorsar</span><span class='op'>(</span><span class='va'>formula</span>, data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>listw</span>, na.action <span class='op'>=</span> <span class='va'>na.fail</span>,
 zero.policy <span class='op'>=</span> <span class='cn'>NULL</span>, method<span class='op'>=</span><span class='st'>"nlminb"</span>, arnoldWied<span class='op'>=</span><span class='cn'>FALSE</span>, 
 control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, pars<span class='op'>=</span><span class='cn'>NULL</span>, scaleU<span class='op'>=</span><span class='cn'>FALSE</span>, verbose<span class='op'>=</span><span class='cn'>NULL</span>, legacy<span class='op'>=</span><span class='cn'>FALSE</span>,
 se.lambda<span class='op'>=</span><span class='cn'>TRUE</span>, returnHcov<span class='op'>=</span><span class='cn'>FALSE</span>, pWOrder<span class='op'>=</span><span class='fl'>250</span>, tol.Hcov<span class='op'>=</span><span class='fl'>1.0e-10</span><span class='op'>)</span>
<span class='co'># S3 method for gmsar</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>object</span>, correlation <span class='op'>=</span> <span class='cn'>FALSE</span>, Hausman<span class='op'>=</span><span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='fu'>GMargminImage</span><span class='op'>(</span><span class='va'>obj</span>, <span class='va'>lambdaseq</span>, <span class='va'>s2seq</span><span class='op'>)</span>
<span class='fu'>gstsls</span><span class='op'>(</span><span class='va'>formula</span>, data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>listw</span>, listw2 <span class='op'>=</span> <span class='cn'>NULL</span>, na.action <span class='op'>=</span> <span class='va'>na.fail</span>, 
    zero.policy <span class='op'>=</span> <span class='cn'>NULL</span>, pars<span class='op'>=</span><span class='cn'>NULL</span>, scaleU<span class='op'>=</span><span class='cn'>FALSE</span>, control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, 
    verbose<span class='op'>=</span><span class='cn'>NULL</span>, method<span class='op'>=</span><span class='st'>"nlminb"</span>, robust<span class='op'>=</span><span class='cn'>FALSE</span>, legacy<span class='op'>=</span><span class='cn'>FALSE</span>, W2X<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span> 
<span class='co'># S3 method for gmsar</span>
<span class='fu'>impacts</span><span class='op'>(</span><span class='va'>obj</span>, <span class='va'>...</span>, n <span class='op'>=</span> <span class='cn'>NULL</span>, tr <span class='op'>=</span> <span class='cn'>NULL</span>, R <span class='op'>=</span> <span class='cn'>NULL</span>,
 listw <span class='op'>=</span> <span class='cn'>NULL</span>, evalues<span class='op'>=</span><span class='cn'>NULL</span>, tol <span class='op'>=</span> <span class='fl'>1e-06</span>, empirical <span class='op'>=</span> <span class='cn'>FALSE</span>, Q<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='co'># S3 method for gmsar</span>
<span class='fu'>Hausman.test</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span>, tol<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='fu'>lagmess</span><span class='op'>(</span><span class='va'>formula</span>, data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>listw</span>, zero.policy <span class='op'>=</span> <span class='cn'>NULL</span>, na.action <span class='op'>=</span> <span class='va'>na.fail</span>,
 q <span class='op'>=</span> <span class='fl'>10</span>, start <span class='op'>=</span> <span class='op'>-</span><span class='fl'>2.5</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, method<span class='op'>=</span><span class='st'>"BFGS"</span>, verbose<span class='op'>=</span><span class='cn'>NULL</span>,
 use_expm<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'>ME</span><span class='op'>(</span><span class='va'>formula</span>, data<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, family <span class='op'>=</span> <span class='va'>gaussian</span>, <span class='va'>weights</span>, <span class='va'>offset</span>,
 na.action<span class='op'>=</span><span class='va'>na.fail</span>, listw<span class='op'>=</span><span class='cn'>NULL</span>, alpha<span class='op'>=</span><span class='fl'>0.05</span>, nsim<span class='op'>=</span><span class='fl'>99</span>, verbose<span class='op'>=</span><span class='cn'>NULL</span>,
 stdev<span class='op'>=</span><span class='cn'>FALSE</span>, zero.policy <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
<span class='fu'>SpatialFiltering</span><span class='op'>(</span><span class='va'>formula</span>, lagformula<span class='op'>=</span><span class='cn'>NULL</span>, data<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, na.action<span class='op'>=</span><span class='va'>na.fail</span>,
 nb<span class='op'>=</span><span class='cn'>NULL</span>, glist <span class='op'>=</span> <span class='cn'>NULL</span>, style <span class='op'>=</span> <span class='st'>"C"</span>, zero.policy <span class='op'>=</span> <span class='cn'>NULL</span>, tol <span class='op'>=</span> <span class='fl'>0.1</span>,
 zerovalue <span class='op'>=</span> <span class='fl'>1e-04</span>, ExactEV <span class='op'>=</span> <span class='cn'>FALSE</span>, symmetric <span class='op'>=</span> <span class='cn'>TRUE</span>, alpha<span class='op'>=</span><span class='cn'>NULL</span>,
 alternative<span class='op'>=</span><span class='st'>"two.sided"</span>, verbose<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='fu'>LR.sarlm</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span>
<span class='co'># S3 method for sarlm</span>
<span class='fu'><a href='https://rdrr.io/r/stats/logLik.html'>logLik</a></span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='fu'>LR1.sarlm</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>
<span class='fu'>Wald1.sarlm</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>
<span class='co'># S3 method for sarlm</span>
<span class='fu'>Hausman.test</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span>, tol<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='fu'>as.spam.listw</span><span class='op'>(</span><span class='va'>listw</span><span class='op'>)</span>
<span class='fu'>as_dgRMatrix_listw</span><span class='op'>(</span><span class='va'>listw</span><span class='op'>)</span>
<span class='fu'>as_dsTMatrix_listw</span><span class='op'>(</span><span class='va'>listw</span><span class='op'>)</span>
<span class='fu'>as_dsCMatrix_I</span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>
<span class='fu'>as_dsCMatrix_IrW</span><span class='op'>(</span><span class='va'>W</span>, <span class='va'>rho</span><span class='op'>)</span>
<span class='fu'>Jacobian_W</span><span class='op'>(</span><span class='va'>W</span>, <span class='va'>rho</span><span class='op'>)</span>
<span class='fu'>powerWeights</span><span class='op'>(</span><span class='va'>W</span>, <span class='va'>rho</span>, order<span class='op'>=</span><span class='fl'>250</span>, <span class='va'>X</span>, tol<span class='op'>=</span><span class='va'>.Machine</span><span class='op'>$</span><span class='va'>double.eps</span><span class='op'>^</span><span class='op'>(</span><span class='fl'>3</span><span class='op'>/</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># S3 method for lagImpact</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span>, choice<span class='op'>=</span><span class='st'>"direct"</span>, trace<span class='op'>=</span><span class='cn'>FALSE</span>, density<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='co'># S3 method for lagImpact</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span>, reportQ<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='co'># S3 method for lagImpact</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span>, zstats<span class='op'>=</span><span class='cn'>FALSE</span>, short<span class='op'>=</span><span class='cn'>FALSE</span>, reportQ<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='co'># S3 method for lagImpact</span>
<span class='fu'>HPDinterval</span><span class='op'>(</span><span class='va'>obj</span>, prob <span class='op'>=</span> <span class='fl'>0.95</span>, <span class='va'>...</span>, choice<span class='op'>=</span><span class='st'>"direct"</span><span class='op'>)</span>
<span class='fu'>intImpacts</span><span class='op'>(</span><span class='va'>rho</span>, <span class='va'>beta</span>, <span class='va'>P</span>, <span class='va'>n</span>, <span class='va'>mu</span>, <span class='va'>Sigma</span>, <span class='va'>irho</span>, <span class='va'>drop2beta</span>, <span class='va'>bnames</span>, <span class='va'>interval</span>,
 <span class='va'>type</span>, <span class='va'>tr</span>, <span class='va'>R</span>, <span class='va'>listw</span>, <span class='va'>evalues</span>, <span class='va'>tol</span>, <span class='va'>empirical</span>, <span class='va'>Q</span>, <span class='va'>icept</span>, <span class='va'>iicept</span>, <span class='va'>p</span>, mess<span class='op'>=</span><span class='cn'>FALSE</span>,
 samples<span class='op'>=</span><span class='cn'>NULL</span>, zero_fill <span class='op'>=</span> <span class='cn'>NULL</span>, dvars <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
<span class='fu'>can.be.simmed</span><span class='op'>(</span><span class='va'>listw</span><span class='op'>)</span>
<span class='fu'>eigenw</span><span class='op'>(</span><span class='va'>listw</span>, quiet<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='fu'>similar.listw</span><span class='op'>(</span><span class='va'>listw</span><span class='op'>)</span>
<span class='fu'>do_ldet</span><span class='op'>(</span><span class='va'>coef</span>, <span class='va'>env</span>, which<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'>jacobianSetup</span><span class='op'>(</span><span class='va'>method</span>, <span class='va'>env</span>, <span class='va'>con</span>, pre_eig<span class='op'>=</span><span class='cn'>NULL</span>, trs<span class='op'>=</span><span class='cn'>NULL</span>, interval<span class='op'>=</span><span class='cn'>NULL</span>, which<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'>cheb_setup</span><span class='op'>(</span><span class='va'>env</span>, q<span class='op'>=</span><span class='fl'>5</span>, which<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'>mcdet_setup</span><span class='op'>(</span><span class='va'>env</span>, p<span class='op'>=</span><span class='fl'>16</span>, m<span class='op'>=</span><span class='fl'>30</span>, which<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'>eigen_setup</span><span class='op'>(</span><span class='va'>env</span>, which<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'>eigen_pre_setup</span><span class='op'>(</span><span class='va'>env</span>, <span class='va'>pre_eig</span>, which<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'>spam_setup</span><span class='op'>(</span><span class='va'>env</span>, pivot<span class='op'>=</span><span class='st'>"MMD"</span>, which<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'>spam_update_setup</span><span class='op'>(</span><span class='va'>env</span>, in_coef<span class='op'>=</span><span class='fl'>0.1</span>, pivot<span class='op'>=</span><span class='st'>"MMD"</span>, which<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'>Matrix_setup</span><span class='op'>(</span><span class='va'>env</span>, <span class='va'>Imult</span>, super<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/logical.html'>as.logical</a></span><span class='op'>(</span><span class='cn'>NA</span><span class='op'>)</span>, which<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'>Matrix_J_setup</span><span class='op'>(</span><span class='va'>env</span>, super<span class='op'>=</span><span class='cn'>FALSE</span>, which<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'>LU_setup</span><span class='op'>(</span><span class='va'>env</span>, which<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'>LU_prepermutate_setup</span><span class='op'>(</span><span class='va'>env</span>, coef<span class='op'>=</span><span class='fl'>0.1</span>, order<span class='op'>=</span><span class='cn'>FALSE</span>, which<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'>moments_setup</span><span class='op'>(</span><span class='va'>env</span>, trs<span class='op'>=</span><span class='cn'>NULL</span>, <span class='va'>m</span>, <span class='va'>p</span>, type<span class='op'>=</span><span class='st'>"MC"</span>, correct<span class='op'>=</span><span class='cn'>TRUE</span>, trunc<span class='op'>=</span><span class='cn'>TRUE</span>, eq7<span class='op'>=</span><span class='cn'>TRUE</span>, which<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'>SE_classic_setup</span><span class='op'>(</span><span class='va'>env</span>, SE_method<span class='op'>=</span><span class='st'>"LU"</span>, p<span class='op'>=</span><span class='fl'>16</span>, m<span class='op'>=</span><span class='fl'>30</span>, nrho<span class='op'>=</span><span class='fl'>200</span>, interpn<span class='op'>=</span><span class='fl'>2000</span>,
 interval<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>0.999</span><span class='op'>)</span>, SElndet<span class='op'>=</span><span class='cn'>NULL</span>, which<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'>SE_whichMin_setup</span><span class='op'>(</span><span class='va'>env</span>, SE_method<span class='op'>=</span><span class='st'>"LU"</span>, p<span class='op'>=</span><span class='fl'>16</span>, m<span class='op'>=</span><span class='fl'>30</span>, nrho<span class='op'>=</span><span class='fl'>200</span>, interpn<span class='op'>=</span><span class='fl'>2000</span>,
 interval<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>0.999</span><span class='op'>)</span>, SElndet<span class='op'>=</span><span class='cn'>NULL</span>, which<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'>SE_interp_setup</span><span class='op'>(</span><span class='va'>env</span>, SE_method<span class='op'>=</span><span class='st'>"LU"</span>, p<span class='op'>=</span><span class='fl'>16</span>, m<span class='op'>=</span><span class='fl'>30</span>, nrho<span class='op'>=</span><span class='fl'>200</span>,
 interval<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>0.999</span><span class='op'>)</span>, which<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'>MCMCsamp</span><span class='op'>(</span><span class='va'>object</span>, mcmc <span class='op'>=</span> <span class='fl'>1L</span>, verbose <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='co'># S3 method for spautolm</span>
<span class='fu'>MCMCsamp</span><span class='op'>(</span><span class='va'>object</span>, mcmc <span class='op'>=</span> <span class='fl'>1L</span>, verbose <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>...</span>,
 burnin <span class='op'>=</span> <span class='fl'>0L</span>, scale<span class='op'>=</span><span class='fl'>1</span>, <span class='va'>listw</span>, control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># S3 method for sarlm</span>
<span class='fu'>MCMCsamp</span><span class='op'>(</span><span class='va'>object</span>, mcmc <span class='op'>=</span> <span class='fl'>1L</span>, verbose <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>...</span>,
    burnin<span class='op'>=</span><span class='fl'>0L</span>, scale<span class='op'>=</span><span class='fl'>1</span>, <span class='va'>listw</span>, listw2<span class='op'>=</span><span class='cn'>NULL</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>spautolm</span><span class='op'>(</span><span class='va'>formula</span>, data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>listw</span>, <span class='va'>weights</span>,
 <span class='va'>na.action</span>, family <span class='op'>=</span> <span class='st'>"SAR"</span>, method<span class='op'>=</span><span class='st'>"eigen"</span>, verbose <span class='op'>=</span> <span class='cn'>NULL</span>, trs<span class='op'>=</span><span class='cn'>NULL</span>,
 interval<span class='op'>=</span><span class='cn'>NULL</span>, zero.policy <span class='op'>=</span> <span class='cn'>NULL</span>, tol.solve<span class='op'>=</span><span class='va'>.Machine</span><span class='op'>$</span><span class='va'>double.eps</span>,
 llprof<span class='op'>=</span><span class='cn'>NULL</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># S3 method for spautolm</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>object</span>, correlation <span class='op'>=</span> <span class='cn'>FALSE</span>, adj.se<span class='op'>=</span><span class='cn'>FALSE</span>,
 Nagelkerke<span class='op'>=</span><span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='fu'>spBreg_sac</span><span class='op'>(</span><span class='va'>formula</span>, data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>listw</span>, listw2<span class='op'>=</span><span class='cn'>NULL</span>, <span class='va'>na.action</span>, 
    <span class='va'>Durbin</span>, <span class='va'>type</span>, zero.policy<span class='op'>=</span><span class='cn'>NULL</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># S3 method for MCMC_sar_g</span>
<span class='fu'>impacts</span><span class='op'>(</span><span class='va'>obj</span>, <span class='va'>...</span>, tr<span class='op'>=</span><span class='cn'>NULL</span>, listw<span class='op'>=</span><span class='cn'>NULL</span>, evalues<span class='op'>=</span><span class='cn'>NULL</span>, Q<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='co'># S3 method for MCMC_sem_g</span>
<span class='fu'>impacts</span><span class='op'>(</span><span class='va'>obj</span>, <span class='va'>...</span>, tr<span class='op'>=</span><span class='cn'>NULL</span>, listw<span class='op'>=</span><span class='cn'>NULL</span>, evalues<span class='op'>=</span><span class='cn'>NULL</span>, Q<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='co'># S3 method for MCMC_sac_g</span>
<span class='fu'>impacts</span><span class='op'>(</span><span class='va'>obj</span>, <span class='va'>...</span>, tr<span class='op'>=</span><span class='cn'>NULL</span>, listw<span class='op'>=</span><span class='cn'>NULL</span>, evalues<span class='op'>=</span><span class='cn'>NULL</span>, Q<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='fu'>spBreg_err</span><span class='op'>(</span><span class='va'>formula</span>, data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>listw</span>, <span class='va'>na.action</span>, <span class='va'>Durbin</span>, <span class='va'>etype</span>,
    zero.policy<span class='op'>=</span><span class='cn'>NULL</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>spBreg_lag</span><span class='op'>(</span><span class='va'>formula</span>, data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>listw</span>, <span class='va'>na.action</span>, <span class='va'>Durbin</span>, <span class='va'>type</span>,
    zero.policy<span class='op'>=</span><span class='cn'>NULL</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># S3 method for SLX</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>newdata</span>, <span class='va'>listw</span>, zero.policy<span class='op'>=</span><span class='cn'>NULL</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='fu'>lmSLX</span><span class='op'>(</span><span class='va'>formula</span>, data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>listw</span>, <span class='va'>na.action</span>, weights<span class='op'>=</span><span class='cn'>NULL</span>,
 Durbin<span class='op'>=</span><span class='cn'>TRUE</span>, zero.policy<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='co'># S3 method for SLX</span>
<span class='fu'>impacts</span><span class='op'>(</span><span class='va'>obj</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='fu'>create_WX</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>listw</span>, zero.policy<span class='op'>=</span><span class='cn'>NULL</span>, prefix<span class='op'>=</span><span class='st'>""</span><span class='op'>)</span>
<span class='co'># S3 method for sarlm</span>
<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='fu'>bptest.sarlm</span><span class='op'>(</span><span class='va'>object</span>, varformula<span class='op'>=</span><span class='cn'>NULL</span>, studentize <span class='op'>=</span> <span class='cn'>TRUE</span>, data<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>formula</span>, data<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>listw</span>, <span class='va'>na.action</span>, weights<span class='op'>=</span><span class='cn'>NULL</span>,
 <span class='va'>Durbin</span>, <span class='va'>etype</span>, method<span class='op'>=</span><span class='st'>"eigen"</span>, quiet<span class='op'>=</span><span class='cn'>NULL</span>, zero.policy<span class='op'>=</span><span class='cn'>NULL</span>,
 interval <span class='op'>=</span> <span class='cn'>NULL</span>, tol.solve<span class='op'>=</span><span class='fl'>1.0e-10</span>, trs<span class='op'>=</span><span class='cn'>NULL</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># S3 method for sarlm</span>
<span class='fu'>impacts</span><span class='op'>(</span><span class='va'>obj</span>, <span class='va'>...</span>, <span class='va'>tr</span>, R <span class='op'>=</span> <span class='cn'>NULL</span>, listw <span class='op'>=</span> <span class='cn'>NULL</span>, evalues<span class='op'>=</span><span class='cn'>NULL</span>,
 useHESS <span class='op'>=</span> <span class='cn'>NULL</span>, tol <span class='op'>=</span> <span class='fl'>1e-06</span>, empirical <span class='op'>=</span> <span class='cn'>FALSE</span>, Q<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>formula</span>, data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>listw</span>, 
  <span class='va'>na.action</span>, <span class='va'>Durbin</span>, <span class='va'>type</span>, method<span class='op'>=</span><span class='st'>"eigen"</span>, quiet<span class='op'>=</span><span class='cn'>NULL</span>, 
  zero.policy<span class='op'>=</span><span class='cn'>NULL</span>, interval<span class='op'>=</span><span class='cn'>NULL</span>, tol.solve<span class='op'>=</span><span class='fl'>1.0e-10</span>, trs<span class='op'>=</span><span class='cn'>NULL</span>, 
  control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># S3 method for sarlm</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>object</span>, newdata <span class='op'>=</span> <span class='cn'>NULL</span>, listw <span class='op'>=</span> <span class='cn'>NULL</span>, pred.type <span class='op'>=</span> <span class='st'>"TS"</span>, all.data <span class='op'>=</span> <span class='cn'>FALSE</span>,
 zero.policy <span class='op'>=</span> <span class='cn'>NULL</span>, legacy <span class='op'>=</span> <span class='cn'>TRUE</span>, legacy.mixed <span class='op'>=</span> <span class='cn'>FALSE</span>, power <span class='op'>=</span> <span class='cn'>NULL</span>, order <span class='op'>=</span> <span class='fl'>250</span>,
 tol <span class='op'>=</span> <span class='va'>.Machine</span><span class='op'>$</span><span class='va'>double.eps</span><span class='op'>^</span><span class='op'>(</span><span class='fl'>3</span><span class='op'>/</span><span class='fl'>5</span><span class='op'>)</span>, spChk <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='co'># S3 method for sarlm.pred</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='co'># S3 method for sarlm.pred</span>
<span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='co'># S3 method for sarlm</span>
<span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='co'># S3 method for sarlm</span>
<span class='fu'><a href='https://rdrr.io/r/stats/deviance.html'>deviance</a></span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='co'># S3 method for sarlm</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='co'># S3 method for sarlm</span>
<span class='fu'><a href='https://rdrr.io/r/stats/vcov.html'>vcov</a></span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='co'># S3 method for sarlm</span>
<span class='fu'><a href='https://rdrr.io/r/stats/fitted.values.html'>fitted</a></span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='fu'>sacsarlm</span><span class='op'>(</span><span class='va'>formula</span>, data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>listw</span>, listw2 <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>na.action</span>, <span class='va'>Durbin</span>, <span class='va'>type</span>,
 method <span class='op'>=</span> <span class='st'>"eigen"</span>, quiet <span class='op'>=</span> <span class='cn'>NULL</span>, zero.policy <span class='op'>=</span> <span class='cn'>NULL</span>, tol.solve <span class='op'>=</span> <span class='fl'>1e-10</span>,
 llprof<span class='op'>=</span><span class='cn'>NULL</span>, interval1<span class='op'>=</span><span class='cn'>NULL</span>, interval2<span class='op'>=</span><span class='cn'>NULL</span>, trs1<span class='op'>=</span><span class='cn'>NULL</span>, trs2<span class='op'>=</span><span class='cn'>NULL</span>,
 control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># S3 method for sarlm</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>object</span>, correlation <span class='op'>=</span> <span class='cn'>FALSE</span>, Nagelkerke <span class='op'>=</span> <span class='cn'>FALSE</span>, Hausman<span class='op'>=</span><span class='cn'>FALSE</span>, adj.se<span class='op'>=</span><span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='co'># S3 method for sarlm</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='co'># S3 method for summary.sarlm</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span>, digits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='va'>.Options</span><span class='op'>$</span><span class='va'>digits</span> <span class='op'>-</span> <span class='fl'>3</span><span class='op'>)</span>,
  signif.stars <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='fu'>trW</span><span class='op'>(</span>W<span class='op'>=</span><span class='cn'>NULL</span>, m <span class='op'>=</span> <span class='fl'>30</span>, p <span class='op'>=</span> <span class='fl'>16</span>, type <span class='op'>=</span> <span class='st'>"mult"</span>, listw<span class='op'>=</span><span class='cn'>NULL</span>, momentsSymmetry<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>lw</th>
      <td><p>a binary symmetric <code>listw</code> object from, for example, <code>nb2listw</code> with style &#8220;B&#8221; for <code>lextrB</code>, style &#8220;W&#8221; for <code>lextrW</code> and style &#8220;S&#8221; for <code>lextrS</code>; for <code>l_max</code>, the object may be asymmetric and does not have to be binary</p></td>
    </tr>
    <tr>
      <th>zero.policy</th>
      <td><p>default NULL, use global option value; if TRUE assign zero to the lagged value of zones without neighbours, if FALSE assign NA</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>a list of control arguments</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>default NULL, use global !verbose option value; set to FALSE for short summary</p></td>
    </tr>
    <tr>
      <th>P</th>
      <td><p>number of columns in the grid (number of units in a horizontal axis direction)</p></td>
    </tr>
    <tr>
      <th>Q</th>
      <td><p>number of rows in the grid (number of units in a vertical axis direction.)</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>&#8220;rook&#8221; or &#8220;queen&#8221;</p></td>
    </tr>
    <tr>
      <th>nb</th>
      <td><p>an object of class <code>nb</code></p></td>
    </tr>
    <tr>
      <th>glist</th>
      <td><p>list of general weights corresponding to neighbours</p></td>
    </tr>
    <tr>
      <th>style</th>
      <td><p><code>style</code> can take values &#8220;W&#8221;, &#8220;B&#8221;, &#8220;C&#8221;, &#8220;U&#8221;, &#8220;minmax&#8221; and &#8220;S&#8221;</p></td>
    </tr>
    <tr>
      <th>m</th>
      <td><p>The number of powers; must be an even number for &#8216;type&#8217;=&#8220;moments&#8221; (default changed from 100 to 30 (2010-11-17))</p></td>
    </tr>
    <tr>
      <th>is</th>
      <td><p>(used internally only in <code>mom_calc_int2</code> for &#8216;type&#8217;=&#8220;moments&#8221; on a cluster)</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>(used internally only in <code>mom_calc_int2</code> for &#8216;type&#8217;=&#8220;moments&#8221; on a cluster)</p></td>
    </tr>
    <tr>
      <th>Card</th>
      <td><p>(used internally only in <code>mom_calc_int2</code> for &#8216;type&#8217;=&#8220;moments&#8221; on a cluster)</p></td>
    </tr>
    <tr>
      <th>formula</th>
      <td><p>a symbolic description of the model to be fit. The details 
of model specification are given for <code><a href='https://rdrr.io/r/stats/lm.html'>lm()</a></code></p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>an optional data frame containing the variables in the model. 
By default the variables are taken from the environment which the function 
is called.</p></td>
    </tr>
    <tr>
      <th>listw</th>
      <td><p>a <code>listw</code> object created for example by <code>nb2listw</code></p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>a function (default <code>na.fail</code>), can also be <code>na.omit</code> or <code>na.exclude</code> with consequences for residuals and fitted values - in these cases the weights list will be subsetted to remove NAs in the data. It may be necessary to set zero.policy to TRUE because this subsetting may create no-neighbour observations. Note that only weights lists created without using the glist argument to <code>nb2listw</code> may be subsetted.</p></td>
    </tr>
    <tr>
      <th>robust</th>
      <td><p>default FALSE, if TRUE, apply a heteroskedasticity correction to the coefficients covariances</p></td>
    </tr>
    <tr>
      <th>HC</th>
      <td><p>default NULL, if <code>robust</code> is TRUE, assigned &#8220;HC0&#8221;, may take values &#8220;HC0&#8221; or &#8220;HC1&#8221; for White estimates or MacKinnon-White estimates respectively</p></td>
    </tr>
    <tr>
      <th>legacy</th>
      <td><p>the argument chooses between two implementations of the robustness correction: default FALSE - use the estimate of Omega only in the White consistent estimator of the variance-covariance matrix, if TRUE, use the original implementation which runs a GLS using the estimate of Omega, and yields different coefficient estimates as well - see example below</p></td>
    </tr>
    <tr>
      <th>W2X</th>
      <td><p>default TRUE, if FALSE only WX are used as instruments in the spatial two stage least squares; until release 0.4-60, only WX were used - see example below</p></td>
    </tr>
    <tr>
      <th>obj</th>
      <td><p>A spatial regression object created by <code>lagsarlm</code>, <code>lagmess</code> or by <code>lmSLX</code>; in <code>HPDinterval.lagImpact</code>, a lagImpact object</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments passed through to methods in the <span class="pkg">coda</span> package</p></td>
    </tr>
    <tr>
      <th>tr</th>
      <td><p>A vector of traces of powers of the spatial weights matrix created using <code>trW</code>, for approximate impact measures; if not given, <code>listw</code> must be given for exact measures (for small to moderate spatial weights matrices); the traces must be for the same spatial weights as were used in fitting the spatial regression, and must be row-standardised</p></td>
    </tr>
    <tr>
      <th>evalues</th>
      <td><p>vector of eigenvalues of spatial weights matrix for impacts calculations</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>defaults to <code><a href='https://rdrr.io/r/base/length.html'>length(obj$residuals)</a></code>; in the method for <code>gmsar</code> objects it may be used in panel settings to compute the impacts for cross-sectional weights only, suggested by Angela Parenti</p></td>
    </tr>
    <tr>
      <th>R</th>
      <td><p>If given, simulations are used to compute distributions for the impact measures, returned as <code>mcmc</code> objects; the objects are used for convenience but are not output by an MCMC process</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>Argument passed to <code>mvrnorm</code>: tolerance (relative to largest variance) for numerical lack of positive-definiteness in the coefficient covariance matrix</p></td>
    </tr>
    <tr>
      <th>empirical</th>
      <td><p>Argument passed to <code>mvrnorm</code> (default FALSE): if true, the coefficients and their covariance matrix specify the empirical not population mean and covariance matrix</p></td>
    </tr>
    <tr>
      <th>listw2</th>
      <td><p>a <code>listw</code> object created for example by <code>nb2listw</code>, if not given, set to the same spatial weights as the listw argument</p></td>
    </tr>
    <tr>
      <th>pars</th>
      <td><p>starting values for \(\lambda\) and \(\sigma^2\) for GMM optimisation, 
  if missing (default), approximated from initial 2sls model as the autocorrelation coefficient corrected for weights style 
  and model sigma squared</p></td>
    </tr>
    <tr>
      <th>scaleU</th>
      <td><p>Default FALSE: scale the OLS residuals before computing the moment matrices; only used if the <code>pars</code> argument is missing</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>default <code>"nlminb"</code>, or optionally a method passed to <code>optim</code> to use an alternative optimizer</p></td>
    </tr>
    <tr>
      <th>arnoldWied</th>
      <td><p>default FALSE</p></td>
    </tr>
    <tr>
      <th>returnHcov</th>
      <td><p>default FALSE, return the Vo matrix for a spatial Hausman test</p></td>
    </tr>
    <tr>
      <th>tol.Hcov</th>
      <td><p>the tolerance for computing the Vo matrix (default=1.0e-10)</p></td>
    </tr>
    <tr>
      <th>pWOrder</th>
      <td><p>default 250, if returnHcov=TRUE, pass this order to <code>powerWeights</code> as the power series maximum limit</p></td>
    </tr>
    <tr>
      <th>lambdaseq</th>
      <td><p>if given, an increasing sequence of lambda values for gridding</p></td>
    </tr>
    <tr>
      <th>s2seq</th>
      <td><p>if given, an increasing sequence of sigma squared values for gridding</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p><code>gmsar</code> object from <code>GMerrorsar</code></p></td>
    </tr>
    <tr>
      <th>correlation</th>
      <td><p>logical; (default=FALSE), TRUE not available</p></td>
    </tr>
    <tr>
      <th>Hausman</th>
      <td><p>if TRUE, the results of the Hausman test for error models are reported</p></td>
    </tr>
    <tr>
      <th>se.lambda</th>
      <td><p>default TRUE, use the analytical method described in <a href='http://econweb.umd.edu/~prucha/STATPROG/OLS/desols.pdf'>http://econweb.umd.edu/~prucha/STATPROG/OLS/desols.pdf</a></p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>default NULL, use global option value; if TRUE, reports function values during optimization.</p></td>
    </tr>
    <tr>
      <th>q</th>
      <td><p>default 10; number of powers of the spatial weights to use</p></td>
    </tr>
    <tr>
      <th>start</th>
      <td><p>starting value for numerical optimization, should be a small negative number</p></td>
    </tr>
    <tr>
      <th>use_expm</th>
      <td><p>default FALSE; if TRUE use <code><a href='https://rdrr.io/pkg/expm/man/expAtv.html'>expm::expAtv</a></code> instead of a truncated power series of W</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>a description of the error distribution and link function to
          be used in the model</p></td>
    </tr>
    <tr>
      <th>offset</th>
      <td><p>this can be used to specify an a priori known component to be included in the linear predictor during fitting</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>used as a stopping rule to choose all eigenvectors up to and including the one with a p-value exceeding alpha</p></td>
    </tr>
    <tr>
      <th>nsim</th>
      <td><p>number of permutations for permutation bootstrap for finding p-values</p></td>
    </tr>
    <tr>
      <th>stdev</th>
      <td><p>if TRUE, p-value calculated from bootstrap permutation standard deviate using <code>pnorm</code> with alternative="greater", if FALSE the Hope-type p-value</p></td>
    </tr>
    <tr>
      <th>lagformula</th>
      <td><p>An extra one-sided formula to be used when a spatial lag representation is desired; the intercept is excluded within the function if present because it is part of the formula argument, but excluding it explicitly in the lagformula argument in the presence of factors generates a collinear model matrix</p></td>
    </tr>
    <tr>
      <th>zerovalue</th>
      <td><p>eigenvectors with eigenvalues of an absolute value smaller than zerovalue will be excluded in eigenvector search</p></td>
    </tr>
    <tr>
      <th>ExactEV</th>
      <td><p>Set ExactEV=TRUE to use exact expectations and variances rather than the expectation and variance of Moran's I from the previous iteration, default FALSE</p></td>
    </tr>
    <tr>
      <th>symmetric</th>
      <td><p>Should the spatial weights matrix be forced to symmetry, default TRUE</p></td>
    </tr>
    <tr>
      <th>alternative</th>
      <td><p>a character string specifying the alternative hypothesis, must be one of greater, less or two.sided (default).</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>a <code>logLik</code> object or an object for which a <code><a href='https://rdrr.io/r/stats/logLik.html'>logLik()</a></code> function exists</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>a <code>logLik</code> object or an object for which a <code><a href='https://rdrr.io/r/stats/logLik.html'>logLik()</a></code> function exists</p></td>
    </tr>
    <tr>
      <th>W</th>
      <td><p>a <code>dsTMatrix</code> object created using <code>as_dsTMatrix_listw</code> from a symmetric <code>listw</code> object</p></td>
    </tr>
    <tr>
      <th>rho</th>
      <td><p>spatial regression coefficient</p></td>
    </tr>
    <tr>
      <th>order</th>
      <td><p>Power series maximum limit</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>A numerical matrix</p></td>
    </tr>
    <tr>
      <th>choice</th>
      <td><p>One of three impacts: direct, indirect, or total</p></td>
    </tr>
    <tr>
      <th>trace</th>
      <td><p>Argument passed to <code>plot.mcmc</code>: plot trace plots</p></td>
    </tr>
    <tr>
      <th>density</th>
      <td><p>Argument passed to <code>plot.mcmc</code>: plot density plots</p></td>
    </tr>
    <tr>
      <th>prob</th>
      <td><p>Argument passed to <code>HPDinterval.mcmc</code>: a numeric scalar in the interval (0,1) giving the target probability content of the intervals</p></td>
    </tr>
    <tr>
      <th>
beta, 
mu, Sigma, irho, drop2beta, bnames,
    interval, 
 icept, iicept, p, mess, samples, zero_fill, dvars</th>
      <td><p>internal arguments shared inside impacts methods</p></td>
    </tr>
    <tr>
      <th>reportQ</th>
      <td><p>default NULL; if TRUE and <code>Q</code> given as an argument to <code>impacts</code>, report impact components</p></td>
    </tr>
    <tr>
      <th>zstats</th>
      <td><p>default FALSE, if TRUE, also return z-values and p-values for the impacts based on the simulations</p></td>
    </tr>
    <tr>
      <th>short</th>
      <td><p>default FALSE, if TRUE passed to the print summary method to omit printing of the mcmc summaries</p></td>
    </tr>
    <tr>
      <th>coef</th>
      <td><p>spatial coefficient value</p></td>
    </tr>
    <tr>
      <th>env</th>
      <td><p>environment containing pre-computed objects, fixed after assignment in setup functions</p></td>
    </tr>
    <tr>
      <th>which</th>
      <td><p>default 1; if 2, use second listw object</p></td>
    </tr>
    <tr>
      <th>con</th>
      <td><p>control list passed from model fitting function and parsed in <code>jacobianSetup</code> to set environment variables for method-specific setup</p></td>
    </tr>
    <tr>
      <th>pre_eig</th>
      <td><p>pre-computed eigenvalues of length n</p></td>
    </tr>
    <tr>
      <th>pivot</th>
      <td><p>default &#8220;MMD&#8221;, may also be &#8220;RCM&#8221; for Cholesky decompisition using spam</p></td>
    </tr>
    <tr>
      <th>in_coef</th>
      <td><p>fill-in initiation coefficient value, default 0.1</p></td>
    </tr>
    <tr>
      <th>Imult</th>
      <td><p>see <code><a href='https://rdrr.io/pkg/Matrix/man/Cholesky.html'>Cholesky</a></code>; numeric scalar which defaults to zero. The matrix that is decomposed is A+m*I where m is the value of Imult and I is the identity matrix of order ncol(A). Default in calling spdep functions is 2, here it cannot be missing and does not have a default, but is rescaled for binary weights matrices in proportion to the maximim row sum in those calling functions</p></td>
    </tr>
    <tr>
      <th>super</th>
      <td><p>see <code><a href='https://rdrr.io/pkg/Matrix/man/Cholesky.html'>Cholesky</a></code>; logical scalar indicating is a supernodal decomposition should be created.  The alternative is a simplicial decomposition. Default in calling spdep functions is FALSE for &#8220;Matrix_J&#8221; and <code><a href='https://rdrr.io/r/base/logical.html'>as.logical(NA)</a></code> for &#8220;Matrix&#8221;.  Setting it to NA leaves the choice to a CHOLMOD-internal heuristic</p></td>
    </tr>
    <tr>
      <th>trs, trs1, trs2</th>
      <td><p>A numeric vector of <code>m</code> traces, as from <code>trW</code></p></td>
    </tr>
    <tr>
      <th>correct</th>
      <td><p>default TRUE: use Smirnov correction term, see <code>trW</code></p></td>
    </tr>
    <tr>
      <th>trunc</th>
      <td><p>default TRUE: truncate Smirnov correction term, see <code>trW</code></p></td>
    </tr>
    <tr>
      <th>eq7</th>
      <td><p>default TRUE</p></td>
    </tr>
    <tr>
      <th>SE_method</th>
      <td><p>default &#8220;LU&#8221;, alternatively &#8220;MC&#8221;; underlying lndet method to use for generating SE toolbox emulation grid</p></td>
    </tr>
    <tr>
      <th>nrho</th>
      <td><p>default 200, number of lndet values in first stage SE toolbox emulation grid</p></td>
    </tr>
    <tr>
      <th>interval1, interval2</th>
      <td><p>default c(-1,0.999) if interval argument NULL, bounds for SE toolbox emulation grid</p></td>
    </tr>
    <tr>
      <th>interpn</th>
      <td><p>default 2000, number of lndet values to interpolate in second stage SE toolbox emulation grid</p></td>
    </tr>
    <tr>
      <th>SElndet</th>
      <td><p>default NULL, used to pass a pre-computed two-column matrix of coefficient values and corresponding interpolated lndet values</p></td>
    </tr>
    <tr>
      <th>mcmc</th>
      <td><p>The number of MCMC iterations after burnin</p></td>
    </tr>
    <tr>
      <th>burnin</th>
      <td><p>The number of burn-in iterations for the sampler</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>a positive scale parameter</p></td>
    </tr>
    <tr>
      <th>tol.solve</th>
      <td><p>the tolerance for detecting linear dependencies in the columns of matrices to be inverted - passed to <code><a href='https://rdrr.io/r/base/solve.html'>solve()</a></code> (default=double precision machine tolerance). Errors in <code><a href='https://rdrr.io/r/base/solve.html'>solve()</a></code> may constitute indications of poorly scaled variables: if the variables have scales differing much from the autoregressive coefficient, the values in this matrix may be very different in scale, and inverting such a matrix is analytically possible by definition, but numerically unstable; rescaling the RHS variables alleviates this better than setting tol.solve to a very small value</p></td>
    </tr>
    <tr>
      <th>llprof</th>
      <td><p>default NULL, can either be an integer, to divide the feasible range into llprof points, or a sequence of spatial coefficient values, at which to evaluate the likelihood function</p></td>
    </tr>
    <tr>
      <th>adj.se</th>
      <td><p>if TRUE, adjust the coefficient standard errors for the number of fitted coefficients</p></td>
    </tr>
    <tr>
      <th>Nagelkerke</th>
      <td><p>if TRUE, the Nagelkerke pseudo R-squared is reported</p></td>
    </tr>
    <tr>
      <th>Durbin</th>
      <td><p>default FALSE (spatial lag model); if TRUE, full spatial Durbin model; if a formula object, the subset of explanatory variables to lag</p></td>
    </tr>
    <tr>
      <th>etype</th>
      <td><p>(use the &#8216;Durbin=&#8217; argument - retained for backwards compatibility only) default "error", may be set to "emixed" to include the spatially lagged independent variables added to X; when "emixed", the lagged intercept is dropped for spatial weights style "W", that is row-standardised weights, but otherwise included</p></td>
    </tr>
    <tr>
      <th>newdata</th>
      <td><p>data frame in which to predict --- if NULL, predictions are
for the data on which the model was fitted. Should have row names corresponding to region.id. If row names are exactly the same than the ones used for training, it uses in-sample predictors for forecast.  See &#8216;Details&#8217;</p></td>
    </tr>
    <tr>
      <th>prefix</th>
      <td><p>default empty string, may be &#8220;lag&#8221; in some cases</p></td>
    </tr>
    <tr>
      <th>varformula</th>
      <td><p>a formula describing only the potential explanatory variables for the variance (no dependent variable needed). By default the same explanatory variables are taken as in the main regression model</p></td>
    </tr>
    <tr>
      <th>studentize</th>
      <td><p>logical. If set to <code>TRUE</code> Koenker's studentized
   version of the test statistic will be used.</p></td>
    </tr>
    <tr>
      <th>useHESS, pred.type, all.data, legacy.mixed, power, spChk, digits, signif.stars</th>
      <td><p>other arguments in deprecated functions</p></td>
    </tr>
    <tr>
      <th>momentsSymmetry</th>
      <td><p>default TRUE; assert Smirnov/Anselin symmetry assumption</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Model-fitting functions and functions supporting model fitting are being moved to the <span class="pkg">spatialreg</span> package.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/base/Deprecated.html'>Deprecated</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>boston</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span>
<span class='va'>ab.listb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>boston.soi</span>, style<span class='op'>=</span><span class='st'>"B"</span><span class='op'>)</span>
<span class='va'>er</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='fu'>eigenw</span><span class='op'>(</span><span class='va'>ab.listb</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>er</span>
<span class='va'>res_1</span> <span class='op'>&lt;-</span> <span class='fu'>lextrB</span><span class='op'>(</span><span class='va'>ab.listb</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>res_1</span><span class='op'>)</span>
<span class='va'>run</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/yixuan/RSpectra'>"RSpectra"</a></span>, quietly<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='va'>run</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>B</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>ab.listb</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/RSpectra/man/eigs.html'>eigs</a></span><span class='op'>(</span><span class='va'>B</span>, k<span class='op'>=</span><span class='fl'>1</span>, which<span class='op'>=</span><span class='st'>"SR"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>values</span>
<span class='op'>}</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/pkg/RSpectra/man/eigs.html'>eigs</a></span><span class='op'>(</span><span class='va'>B</span>, k<span class='op'>=</span><span class='fl'>1</span>, which<span class='op'>=</span><span class='st'>"LR"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>values</span>
<span class='op'>}</span>
<span class='va'>k5</span> <span class='op'>&lt;-</span> <span class='fu'><a href='knn2nb.html'>knn2nb</a></span><span class='op'>(</span><span class='fu'><a href='knearneigh.html'>knearneigh</a></span><span class='op'>(</span><span class='va'>boston.utm</span>, k<span class='op'>=</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'>l_max</span><span class='op'>(</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>k5</span>, style<span class='op'>=</span><span class='st'>"B"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Re</a></span><span class='op'>(</span><span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>k5</span>, style<span class='op'>=</span><span class='st'>"B"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'>l_max</span><span class='op'>(</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>k5</span>, style<span class='op'>=</span><span class='st'>"C"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Re</a></span><span class='op'>(</span><span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>k5</span>, style<span class='op'>=</span><span class='st'>"C"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>ab.listw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>boston.soi</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>
<span class='va'>er</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'>similar.listw</span><span class='op'>(</span><span class='va'>ab.listw</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>er</span>
<span class='va'>res_1</span> <span class='op'>&lt;-</span> <span class='fu'>lextrW</span><span class='op'>(</span><span class='va'>ab.listw</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>res_1</span><span class='op'>)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>B</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='fu'>similar.listw</span><span class='op'>(</span><span class='va'>ab.listw</span><span class='op'>)</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/RSpectra/man/eigs.html'>eigs</a></span><span class='op'>(</span><span class='va'>B</span>, k<span class='op'>=</span><span class='fl'>1</span>, which<span class='op'>=</span><span class='st'>"SR"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>values</span>
<span class='op'>}</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/pkg/RSpectra/man/eigs.html'>eigs</a></span><span class='op'>(</span><span class='va'>B</span>, k<span class='op'>=</span><span class='fl'>1</span>, which<span class='op'>=</span><span class='st'>"LR"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>values</span>
<span class='op'>}</span>
<span class='va'>ab.listw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>boston.soi</span>, style<span class='op'>=</span><span class='st'>"S"</span><span class='op'>)</span>
<span class='va'>er</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'>similar.listw</span><span class='op'>(</span><span class='va'>ab.listw</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>er</span>
<span class='va'>res_1</span> <span class='op'>&lt;-</span> <span class='fu'>lextrS</span><span class='op'>(</span><span class='va'>ab.listw</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>res_1</span><span class='op'>)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>B</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='fu'>similar.listw</span><span class='op'>(</span><span class='va'>ab.listw</span><span class='op'>)</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/RSpectra/man/eigs.html'>eigs</a></span><span class='op'>(</span><span class='va'>B</span>, k<span class='op'>=</span><span class='fl'>1</span>, which<span class='op'>=</span><span class='st'>"SR"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>values</span>
<span class='op'>}</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/pkg/RSpectra/man/eigs.html'>eigs</a></span><span class='op'>(</span><span class='va'>B</span>, k<span class='op'>=</span><span class='fl'>1</span>, which<span class='op'>=</span><span class='st'>"LR"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>values</span>
<span class='op'>}</span>
<span class='va'>rg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='cell2nb.html'>cell2nb</a></span><span class='op'>(</span>ncol<span class='op'>=</span><span class='fl'>7</span>, nrow<span class='op'>=</span><span class='fl'>7</span>, type<span class='op'>=</span><span class='st'>"rook"</span><span class='op'>)</span>
<span class='va'>rg_eig</span> <span class='op'>&lt;-</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>rg</span>, style<span class='op'>=</span><span class='st'>"B"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>rg_GS</span> <span class='op'>&lt;-</span> <span class='fu'>griffith_sone</span><span class='op'>(</span>P<span class='op'>=</span><span class='fl'>7</span>, Q<span class='op'>=</span><span class='fl'>7</span>, type<span class='op'>=</span><span class='st'>"rook"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>rg_eig</span>, <span class='va'>rg_GS</span><span class='op'>)</span>
<span class='co'># subgraphs</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>oldcol</span><span class='op'>)</span>
<span class='va'>crds</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>COL.OLD</span><span class='op'>$</span><span class='va'>X</span>, <span class='va'>COL.OLD</span><span class='op'>$</span><span class='va'>Y</span><span class='op'>)</span>
<span class='va'>k3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='knn2nb.html'>knn2nb</a></span><span class='op'>(</span><span class='fu'><a href='knearneigh.html'>knearneigh</a></span><span class='op'>(</span><span class='va'>crds</span>, k<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>nc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='Graph Components.html'>n.comp.nb</a></span><span class='op'>(</span><span class='va'>k3</span><span class='op'>)</span>
<span class='va'>nc</span><span class='op'>$</span><span class='va'>nc</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>nc</span><span class='op'>$</span><span class='va'>comp.id</span><span class='op'>)</span>
<span class='va'>k3eig</span> <span class='op'>&lt;-</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>k3</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>k3eigSG</span> <span class='op'>&lt;-</span> <span class='fu'>subgraph_eigenw</span><span class='op'>(</span><span class='va'>k3</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='va'>k3eig</span><span class='op'>)</span>, <span class='va'>k3eigSG</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>oldcol</span><span class='op'>)</span>
<span class='va'>COL.lag.eig</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.lag.eig</span>, correlation<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>COL.lag.stsls</span> <span class='op'>&lt;-</span> <span class='fu'>stsls</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.lag.stsls</span>, correlation<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>COL.lag.stslsW</span> <span class='op'>&lt;-</span> <span class='fu'>stsls</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span>, W2X<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.lag.stslsW</span>, correlation<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>COL.lag.stslsR</span> <span class='op'>&lt;-</span> <span class='fu'>stsls</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span>,
robust<span class='op'>=</span><span class='cn'>TRUE</span>, W2X<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.lag.stslsR</span>, correlation<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>COL.lag.stslsRl</span> <span class='op'>&lt;-</span> <span class='fu'>stsls</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span>,
robust<span class='op'>=</span><span class='cn'>TRUE</span>, legacy<span class='op'>=</span><span class='cn'>TRUE</span>, W2X<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.lag.stslsRl</span>, correlation<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>boston</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span>
<span class='va'>gp2a</span> <span class='op'>&lt;-</span> <span class='fu'>stsls</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>CMEDV</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>CRIM</span> <span class='op'>+</span> <span class='va'>ZN</span> <span class='op'>+</span> <span class='va'>INDUS</span> <span class='op'>+</span> <span class='va'>CHAS</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>NOX</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>RM</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='va'>AGE</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>DIS</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>RAD</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>TAX</span> <span class='op'>+</span> <span class='va'>PTRATIO</span> <span class='op'>+</span> <span class='va'>B</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>LSTAT</span><span class='op'>)</span>,
 data<span class='op'>=</span><span class='va'>boston.c</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>boston.soi</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>gp2a</span><span class='op'>)</span>
<span class='va'>columbus</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"shapes/columbus.shp"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, quiet<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>col.gal.nb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='read.gal.html'>read.gal</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"weights/columbus.gal"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>listw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>col.gal.nb</span><span class='op'>)</span>
<span class='va'>ev</span> <span class='op'>&lt;-</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='va'>listw</span><span class='op'>)</span>
<span class='va'>W</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>listw</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='va'>trMatc</span> <span class='op'>&lt;-</span> <span class='fu'>trW</span><span class='op'>(</span><span class='va'>W</span>, type<span class='op'>=</span><span class='st'>"mult"</span><span class='op'>)</span>
<span class='va'>lobj1</span> <span class='op'>&lt;-</span> <span class='fu'>stsls</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, <span class='va'>columbus</span>, <span class='va'>listw</span><span class='op'>)</span>
<span class='va'>loobj1</span> <span class='op'>&lt;-</span> <span class='fu'>impacts</span><span class='op'>(</span><span class='va'>lobj1</span>, R<span class='op'>=</span><span class='fl'>200</span>, tr<span class='op'>=</span><span class='va'>trMatc</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>loobj1</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span>, short<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>loobj2</span> <span class='op'>&lt;-</span> <span class='fu'>impacts</span><span class='op'>(</span><span class='va'>lobj1</span>, R<span class='op'>=</span><span class='fl'>200</span>, evalues<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>loobj2</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span>, short<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>coda</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/coda/man/HPDinterval.html'>HPDinterval</a></span><span class='op'>(</span><span class='va'>loobj1</span><span class='op'>)</span>
<span class='va'>lobj1r</span> <span class='op'>&lt;-</span> <span class='fu'>stsls</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, <span class='va'>columbus</span>, <span class='va'>listw</span>, robust<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>loobj1r</span> <span class='op'>&lt;-</span> <span class='fu'>impacts</span><span class='op'>(</span><span class='va'>lobj1r</span>, tr<span class='op'>=</span><span class='va'>trMatc</span>, R<span class='op'>=</span><span class='fl'>200</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>loobj1r</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span>, short<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>oldcol</span><span class='op'>)</span>
<span class='va'>COL.errW.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>, method<span class='op'>=</span><span class='st'>"eigen"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span>, Hausman<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>COL.errW.GM</span> <span class='op'>&lt;-</span> <span class='fu'>GMerrorsar</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>, returnHcov<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.errW.GM</span>, Hausman<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>aa</span> <span class='op'>&lt;-</span> <span class='fu'>GMargminImage</span><span class='op'>(</span><span class='va'>COL.errW.GM</span><span class='op'>)</span>
<span class='va'>levs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>aa</span><span class='op'>$</span><span class='va'>z</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>/</span><span class='fl'>12</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/image.html'>image</a></span><span class='op'>(</span><span class='va'>aa</span>, breaks<span class='op'>=</span><span class='va'>levs</span>, xlab<span class='op'>=</span><span class='st'>"lambda"</span>, ylab<span class='op'>=</span><span class='st'>"s2"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>COL.errW.GM</span><span class='op'>$</span><span class='va'>lambda</span>, <span class='va'>COL.errW.GM</span><span class='op'>$</span><span class='va'>s2</span>, pch<span class='op'>=</span><span class='fl'>3</span>, lwd<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/contour.html'>contour</a></span><span class='op'>(</span><span class='va'>aa</span>, levels<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>signif</a></span><span class='op'>(</span><span class='va'>levs</span>, <span class='fl'>4</span><span class='op'>)</span>, add<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>COL.errW.GM1</span> <span class='op'>&lt;-</span> <span class='fu'>GMerrorsar</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.errW.GM1</span><span class='op'>)</span>
<span class='va'>nydata</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"shapes/NY8_bna_utm18.gpkg"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, quiet<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressMessages</a></span><span class='op'>(</span><span class='va'>nyadjmat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='fu'>foreign</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/foreign/man/read.dbf.html'>read.dbf</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span>
 <span class='st'>"misc/nyadjwts.dbf"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressMessages</a></span><span class='op'>(</span><span class='va'>ID</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='fu'>foreign</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/foreign/man/read.dbf.html'>read.dbf</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span>
 <span class='st'>"misc/nyadjwts.dbf"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/identical.html'>identical</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substring</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='fl'>2</span>, <span class='fl'>10</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substring</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>nydata</span><span class='op'>$</span><span class='va'>AREAKEY</span><span class='op'>)</span>, <span class='fl'>2</span>, <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>nyadjlw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mat2listw.html'>mat2listw</a></span><span class='op'>(</span><span class='va'>nyadjmat</span>, <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>nydata</span><span class='op'>$</span><span class='va'>AREAKEY</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>listw_NY</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>nyadjlw</span><span class='op'>$</span><span class='va'>neighbours</span>, style<span class='op'>=</span><span class='st'>"B"</span><span class='op'>)</span>
<span class='va'>esar1f</span> <span class='op'>&lt;-</span> <span class='fu'>spautolm</span><span class='op'>(</span><span class='va'>Z</span> <span class='op'>~</span> <span class='va'>PEXPOSURE</span> <span class='op'>+</span> <span class='va'>PCTAGE65P</span> <span class='op'>+</span> <span class='va'>PCTOWNHOME</span>, data<span class='op'>=</span><span class='va'>nydata</span>,
 listw<span class='op'>=</span><span class='va'>listw_NY</span>, family<span class='op'>=</span><span class='st'>"SAR"</span>, method<span class='op'>=</span><span class='st'>"eigen"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>esar1f</span><span class='op'>)</span>
<span class='va'>esar1gm</span> <span class='op'>&lt;-</span> <span class='fu'>GMerrorsar</span><span class='op'>(</span><span class='va'>Z</span> <span class='op'>~</span> <span class='va'>PEXPOSURE</span> <span class='op'>+</span> <span class='va'>PCTAGE65P</span> <span class='op'>+</span> <span class='va'>PCTOWNHOME</span>,
 data<span class='op'>=</span><span class='va'>nydata</span>, listw<span class='op'>=</span><span class='va'>listw_NY</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>esar1gm</span><span class='op'>)</span>
<span class='va'>esar1gm1</span> <span class='op'>&lt;-</span> <span class='fu'>GMerrorsar</span><span class='op'>(</span><span class='va'>Z</span> <span class='op'>~</span> <span class='va'>PEXPOSURE</span> <span class='op'>+</span> <span class='va'>PCTAGE65P</span> <span class='op'>+</span> <span class='va'>PCTOWNHOME</span>,
 data<span class='op'>=</span><span class='va'>nydata</span>, listw<span class='op'>=</span><span class='va'>listw_NY</span>, method<span class='op'>=</span><span class='st'>"Nelder-Mead"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>esar1gm1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>baltimore</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span>
<span class='va'>baltimore</span><span class='op'>$</span><span class='va'>AGE</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>baltimore</span><span class='op'>$</span><span class='va'>AGE</span> <span class='op'>&lt;</span> <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='va'>baltimore</span><span class='op'>$</span><span class='va'>AGE</span><span class='op'>)</span>
<span class='va'>lw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='fu'><a href='knn2nb.html'>knn2nb</a></span><span class='op'>(</span><span class='fu'><a href='knearneigh.html'>knearneigh</a></span><span class='op'>(</span><span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>baltimore</span><span class='op'>$</span><span class='va'>X</span>, <span class='va'>baltimore</span><span class='op'>$</span><span class='va'>Y</span><span class='op'>)</span>, k<span class='op'>=</span><span class='fl'>7</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>obj1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>PRICE</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>PATIO</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>AGE</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>SQFT</span><span class='op'>)</span>,
 data<span class='op'>=</span><span class='va'>baltimore</span><span class='op'>)</span>
<span class='fu'><a href='lm.morantest.html'>lm.morantest</a></span><span class='op'>(</span><span class='va'>obj1</span>, <span class='va'>lw</span><span class='op'>)</span>
<span class='fu'><a href='lm.LMtests.html'>lm.LMtests</a></span><span class='op'>(</span><span class='va'>obj1</span>, <span class='va'>lw</span>, test<span class='op'>=</span><span class='st'>"all"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>obj2</span> <span class='op'>&lt;-</span> <span class='fu'>lagmess</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>PRICE</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>PATIO</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>AGE</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>SQFT</span><span class='op'>)</span>, data<span class='op'>=</span><span class='va'>baltimore</span>, listw<span class='op'>=</span><span class='va'>lw</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>obj2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>obj2a</span> <span class='op'>&lt;-</span> <span class='fu'>lagmess</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>PRICE</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>PATIO</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>AGE</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>SQFT</span><span class='op'>)</span>, data<span class='op'>=</span><span class='va'>baltimore</span>, listw<span class='op'>=</span><span class='va'>lw</span>,
 use_expm<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>obj2a</span><span class='op'>)</span>
<span class='va'>obj3</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>PRICE</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>PATIO</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>AGE</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>SQFT</span><span class='op'>)</span>, data<span class='op'>=</span><span class='va'>baltimore</span>, listw<span class='op'>=</span><span class='va'>lw</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>obj3</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>boston</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span>
<span class='va'>lw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>boston.soi</span><span class='op'>)</span>
<span class='va'>gp2</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>CMEDV</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>CRIM</span> <span class='op'>+</span> <span class='va'>ZN</span> <span class='op'>+</span> <span class='va'>INDUS</span> <span class='op'>+</span> <span class='va'>CHAS</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>NOX</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>RM</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>
 <span class='op'>+</span>  <span class='va'>AGE</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>DIS</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>RAD</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>TAX</span> <span class='op'>+</span> <span class='va'>PTRATIO</span> <span class='op'>+</span> <span class='va'>B</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>LSTAT</span><span class='op'>)</span>,
 data<span class='op'>=</span><span class='va'>boston.c</span>, <span class='va'>lw</span>, method<span class='op'>=</span><span class='st'>"Matrix"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>gp2</span><span class='op'>)</span>
<span class='va'>gp2a</span> <span class='op'>&lt;-</span> <span class='fu'>lagmess</span><span class='op'>(</span><span class='va'>CMEDV</span> <span class='op'>~</span> <span class='va'>CRIM</span> <span class='op'>+</span> <span class='va'>ZN</span> <span class='op'>+</span> <span class='va'>INDUS</span> <span class='op'>+</span> <span class='va'>CHAS</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>NOX</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>RM</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>
 <span class='op'>+</span>  <span class='va'>AGE</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>DIS</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>RAD</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>TAX</span> <span class='op'>+</span> <span class='va'>PTRATIO</span> <span class='op'>+</span> <span class='va'>B</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>LSTAT</span><span class='op'>)</span>,
 data<span class='op'>=</span><span class='va'>boston.c</span>, <span class='va'>lw</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>gp2a</span><span class='op'>)</span>
<span class='va'>columbus</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"shapes/columbus.shp"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, quiet<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>col.gal.nb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='read.gal.html'>read.gal</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"weights/columbus.gal"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>lmbase</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>columbus</span><span class='op'>)</span>
<span class='va'>lagcol</span> <span class='op'>&lt;-</span> <span class='fu'>SpatialFiltering</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='fl'>1</span>, <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>columbus</span>,
 nb<span class='op'>=</span><span class='va'>col.gal.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span>, alpha<span class='op'>=</span><span class='fl'>0.1</span>, verbose<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>lagcol</span>
<span class='va'>lmlag</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/fitted.values.html'>fitted</a></span><span class='op'>(</span><span class='va'>lagcol</span><span class='op'>)</span>, data<span class='op'>=</span><span class='va'>columbus</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>lmbase</span>, <span class='va'>lmlag</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>
<span class='va'>lagcol1</span> <span class='op'>&lt;-</span> <span class='fu'>ME</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>columbus</span>, family<span class='op'>=</span><span class='st'>"gaussian"</span>,
 listw<span class='op'>=</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>col.gal.nb</span><span class='op'>)</span>, alpha<span class='op'>=</span><span class='fl'>0.1</span>, verbose<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>lagcol1</span>
<span class='va'>lmlag1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/fitted.values.html'>fitted</a></span><span class='op'>(</span><span class='va'>lagcol1</span><span class='op'>)</span>, data<span class='op'>=</span><span class='va'>columbus</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>lmbase</span>, <span class='va'>lmlag1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>
<span class='va'>lagcol2</span> <span class='op'>&lt;-</span> <span class='fu'>ME</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>columbus</span>, family<span class='op'>=</span><span class='st'>"gaussian"</span>,
 listw<span class='op'>=</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>col.gal.nb</span><span class='op'>)</span>, alpha<span class='op'>=</span><span class='fl'>0.1</span>, stdev<span class='op'>=</span><span class='cn'>TRUE</span>, verbose<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>lagcol2</span>
<span class='va'>lmlag2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/fitted.values.html'>fitted</a></span><span class='op'>(</span><span class='va'>lagcol2</span><span class='op'>)</span>, data<span class='op'>=</span><span class='va'>columbus</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>lmbase</span>, <span class='va'>lmlag2</span><span class='op'>)</span>
<span class='va'>NA.columbus</span> <span class='op'>&lt;-</span> <span class='va'>columbus</span>
<span class='va'>NA.columbus</span><span class='op'>$</span><span class='va'>CRIME</span><span class='op'>[</span><span class='fl'>20</span><span class='op'>:</span><span class='fl'>25</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
<span class='va'>COL.ME.NA</span> <span class='op'>&lt;-</span> <span class='fu'>ME</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>NA.columbus</span>, family<span class='op'>=</span><span class='st'>"gaussian"</span>,
 listw<span class='op'>=</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>col.gal.nb</span><span class='op'>)</span>, alpha<span class='op'>=</span><span class='fl'>0.1</span>, stdev<span class='op'>=</span><span class='cn'>TRUE</span>, verbose<span class='op'>=</span><span class='cn'>TRUE</span>,
 na.action<span class='op'>=</span><span class='va'>na.exclude</span><span class='op'>)</span>
<span class='va'>COL.ME.NA</span><span class='op'>$</span><span class='va'>na.action</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/fitted.values.html'>fitted</a></span><span class='op'>(</span><span class='va'>COL.ME.NA</span><span class='op'>)</span>, data<span class='op'>=</span><span class='va'>NA.columbus</span>,
 na.action<span class='op'>=</span><span class='va'>na.exclude</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>#nc.sids &lt;- st_read(system.file("shapes/sids.shp", package="spData")[1], quiet=TRUE)</span>
<span class='co'>#rn &lt;- as.character(nc.sids$FIPS)</span>
<span class='co'>#ncCC89_nb &lt;- read.gal(system.file("weights/ncCC89.gal", package="spData")[1],</span>
<span class='co'># region.id=rn)</span>
<span class='co'>#ncCR85_nb &lt;- read.gal(system.file("weights/ncCR85.gal", package="spData")[1],</span>
<span class='co'># region.id=rn)</span>
<span class='co'>#glmbase &lt;- glm(SID74 ~ 1, data=nc.sids, offset=log(BIR74),</span>
<span class='co'># family="poisson")</span>
<span class='co'>#set.seed(123)</span>
<span class='co'>#MEpois1 &lt;- ME(SID74 ~ 1, data=nc.sids, offset=log(BIR74),</span>
<span class='co'># family="poisson", listw=nb2listw(ncCR85_nb, style="B"), alpha=0.2, verbose=TRUE)</span>
<span class='co'>#MEpois1</span>
<span class='co'>#glmME &lt;- glm(SID74 ~ 1 + fitted(MEpois1), data=nc.sids, offset=log(BIR74),</span>
<span class='co'># family="poisson")</span>
<span class='co'>#anova(glmME, test="Chisq")</span>
<span class='co'>#anova(glmbase, glmME, test="Chisq")</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>hopkins</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span>
<span class='va'>hopkins_part</span> <span class='op'>&lt;-</span> <span class='va'>hopkins</span><span class='op'>[</span><span class='fl'>21</span><span class='op'>:</span><span class='fl'>36</span>,<span class='fl'>36</span><span class='op'>:</span><span class='fl'>21</span><span class='op'>]</span>
<span class='va'>hopkins_part</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>hopkins_part</span> <span class='op'>&gt;</span> <span class='fl'>0</span>, arr.ind<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>hopkins.rook.nb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='cell2nb.html'>cell2nb</a></span><span class='op'>(</span><span class='fl'>16</span>, <span class='fl'>16</span>, type<span class='op'>=</span><span class='st'>"rook"</span><span class='op'>)</span>
<span class='va'>glmbase</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>hopkins_part</span><span class='op'>)</span> <span class='op'>~</span> <span class='fl'>1</span>, family<span class='op'>=</span><span class='st'>"binomial"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>
<span class='va'>MEbinom1</span> <span class='op'>&lt;-</span> <span class='fu'>ME</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>hopkins_part</span><span class='op'>)</span> <span class='op'>~</span> <span class='fl'>1</span>, family<span class='op'>=</span><span class='st'>"binomial"</span>,
 listw<span class='op'>=</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>hopkins.rook.nb</span>, style<span class='op'>=</span><span class='st'>"B"</span><span class='op'>)</span>, alpha<span class='op'>=</span><span class='fl'>0.2</span>, verbose<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>glmME</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>hopkins_part</span><span class='op'>)</span> <span class='op'>~</span> <span class='fl'>1</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/fitted.values.html'>fitted</a></span><span class='op'>(</span><span class='va'>MEbinom1</span><span class='op'>)</span>, family<span class='op'>=</span><span class='st'>"binomial"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>glmME</span>, test<span class='op'>=</span><span class='st'>"Chisq"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>glmbase</span>, <span class='va'>glmME</span>, test<span class='op'>=</span><span class='st'>"Chisq"</span><span class='op'>)</span>
<span class='va'>columbus</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"shapes/columbus.shp"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, quiet<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>col.gal.nb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='read.gal.html'>read.gal</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"weights/columbus.gal"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>lmbase</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>columbus</span><span class='op'>)</span>
<span class='va'>sarcol</span> <span class='op'>&lt;-</span> <span class='fu'>SpatialFiltering</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>columbus</span>,
 nb<span class='op'>=</span><span class='va'>col.gal.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span>, ExactEV<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>sarcol</span>
<span class='va'>lmsar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/fitted.values.html'>fitted</a></span><span class='op'>(</span><span class='va'>sarcol</span><span class='op'>)</span>, data<span class='op'>=</span><span class='va'>columbus</span><span class='op'>)</span>
<span class='va'>lmsar</span>
<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>lmbase</span>, <span class='va'>lmsar</span><span class='op'>)</span>
<span class='fu'><a href='lm.morantest.html'>lm.morantest</a></span><span class='op'>(</span><span class='va'>lmsar</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>col.gal.nb</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>lagcol</span> <span class='op'>&lt;-</span> <span class='fu'>SpatialFiltering</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='fl'>1</span>, <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span> <span class='op'>-</span> <span class='fl'>1</span>, data<span class='op'>=</span><span class='va'>columbus</span>,
 nb<span class='op'>=</span><span class='va'>col.gal.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>
<span class='va'>lagcol</span>
<span class='va'>lmlag</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/fitted.values.html'>fitted</a></span><span class='op'>(</span><span class='va'>lagcol</span><span class='op'>)</span>, data<span class='op'>=</span><span class='va'>columbus</span><span class='op'>)</span>
<span class='va'>lmlag</span>
<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>lmbase</span>, <span class='va'>lmlag</span><span class='op'>)</span>
<span class='fu'><a href='lm.morantest.html'>lm.morantest</a></span><span class='op'>(</span><span class='va'>lmlag</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>col.gal.nb</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>NA.columbus</span> <span class='op'>&lt;-</span> <span class='va'>columbus</span>
<span class='va'>NA.columbus</span><span class='op'>$</span><span class='va'>CRIME</span><span class='op'>[</span><span class='fl'>20</span><span class='op'>:</span><span class='fl'>25</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
<span class='va'>COL.SF.NA</span> <span class='op'>&lt;-</span> <span class='fu'>SpatialFiltering</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>NA.columbus</span>,
 nb<span class='op'>=</span><span class='va'>col.gal.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span>, na.action<span class='op'>=</span><span class='va'>na.exclude</span><span class='op'>)</span>
<span class='va'>COL.SF.NA</span><span class='op'>$</span><span class='va'>na.action</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/fitted.values.html'>fitted</a></span><span class='op'>(</span><span class='va'>COL.SF.NA</span><span class='op'>)</span>, data<span class='op'>=</span><span class='va'>NA.columbus</span>,
 na.action<span class='op'>=</span><span class='va'>na.exclude</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>columbus</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"shapes/columbus.shp"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, quiet<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>col.gal.nb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='read.gal.html'>read.gal</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"weights/columbus.gal"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>mixed</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>HOVAL</span> <span class='op'>+</span> <span class='va'>INC</span>, data<span class='op'>=</span><span class='va'>columbus</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>col.gal.nb</span><span class='op'>)</span>,
  type<span class='op'>=</span><span class='st'>"mixed"</span><span class='op'>)</span>
<span class='va'>error</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>HOVAL</span> <span class='op'>+</span> <span class='va'>INC</span>, data<span class='op'>=</span><span class='va'>columbus</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>col.gal.nb</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>LR.sarlm</span><span class='op'>(</span><span class='va'>mixed</span>, <span class='va'>error</span><span class='op'>)</span>
<span class='fu'>Hausman.test</span><span class='op'>(</span><span class='va'>error</span><span class='op'>)</span>
<span class='va'>columbus</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"shapes/columbus.shp"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, quiet<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>col.gal.nb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='read.gal.html'>read.gal</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"weights/columbus.gal"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>col.listw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>col.gal.nb</span><span class='op'>)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='st'><a href='https://www.math.uzh.ch/pages/spam/'>"spam"</a></span>, quietly<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>col.sp</span> <span class='op'>&lt;-</span> <span class='fu'>as.spam.listw</span><span class='op'>(</span><span class='va'>col.listw</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>col.sp</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressMessages</a></span><span class='op'>(</span><span class='va'>nyadjmat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='fu'>foreign</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/foreign/man/read.dbf.html'>read.dbf</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span>
 <span class='st'>"misc/nyadjwts.dbf"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>nyadjlw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mat2listw.html'>mat2listw</a></span><span class='op'>(</span><span class='va'>nyadjmat</span><span class='op'>)</span>
<span class='va'>listw_NY</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>nyadjlw</span><span class='op'>$</span><span class='va'>neighbours</span>, style<span class='op'>=</span><span class='st'>"B"</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://Matrix.R-forge.R-project.org/'>Matrix</a></span><span class='op'>)</span>
<span class='va'>W_C</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>listw_NY</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='va'>W_R</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>listw_NY</span>, <span class='st'>"RsparseMatrix"</span><span class='op'>)</span>
<span class='va'>W_S</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>listw_NY</span>, <span class='st'>"symmetricMatrix"</span><span class='op'>)</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>W_S</span><span class='op'>)</span>
<span class='va'>I</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/Matrix/man/Diagonal.html'>Diagonal</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>
<span class='va'>rho</span> <span class='op'>&lt;-</span> <span class='fl'>0.1</span>
<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/det.html'>determinant</a></span><span class='op'>(</span><span class='va'>I</span> <span class='op'>-</span> <span class='va'>rho</span> <span class='op'>*</span> <span class='va'>W_S</span>, logarithm<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>$</span><span class='va'>modulus</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>rho</span> <span class='op'>*</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='va'>listw_NY</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>nW</span> <span class='op'>&lt;-</span> <span class='op'>-</span> <span class='va'>W_S</span>
<span class='va'>nChol</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/Matrix/man/Cholesky.html'>Cholesky</a></span><span class='op'>(</span><span class='va'>nW</span>, Imult<span class='op'>=</span><span class='fl'>8</span><span class='op'>)</span>
<span class='va'>n</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>rho</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>2</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/det.html'>determinant</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>nChol</span>, <span class='va'>nW</span>, <span class='fl'>1</span><span class='op'>/</span><span class='va'>rho</span><span class='op'>)</span><span class='op'>)</span><span class='op'>$</span><span class='va'>modulus</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>nb7rt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='cell2nb.html'>cell2nb</a></span><span class='op'>(</span><span class='fl'>7</span>, <span class='fl'>7</span>, torus<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>500</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>nb7rt</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>, nrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>nb7rt</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>W</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>nb7rt</span><span class='op'>)</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>ee</span> <span class='op'>&lt;-</span> <span class='fu'>powerWeights</span><span class='op'>(</span><span class='va'>W</span>, rho<span class='op'>=</span><span class='fl'>0.9</span>, X<span class='op'>=</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>#all.equal(e, as(ee, "matrix"), check.attributes=FALSE)</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>e</span> <span class='op'>&lt;-</span> <span class='fu'><a href='invIrM.html'>invIrM</a></span><span class='op'>(</span><span class='va'>nb7rt</span>, rho<span class='op'>=</span><span class='fl'>0.98</span>, method<span class='op'>=</span><span class='st'>"solve"</span>, feasible<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span> <span class='op'>%*%</span> <span class='va'>x</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>ee</span> <span class='op'>&lt;-</span> <span class='fu'>powerWeights</span><span class='op'>(</span><span class='va'>W</span>, rho<span class='op'>=</span><span class='fl'>0.98</span>, X<span class='op'>=</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span><span class='op'>(</span><span class='va'>ee</span>, <span class='st'>"internal"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>e</span>, <span class='fu'>as</span><span class='op'>(</span><span class='va'>ee</span>, <span class='st'>"matrix"</span><span class='op'>)</span>, check.attributes<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>ee</span> <span class='op'>&lt;-</span> <span class='fu'>powerWeights</span><span class='op'>(</span><span class='va'>W</span>, rho<span class='op'>=</span><span class='fl'>0.98</span>, order<span class='op'>=</span><span class='fl'>1000</span>, X<span class='op'>=</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>e</span>, <span class='fu'>as</span><span class='op'>(</span><span class='va'>ee</span>, <span class='st'>"matrix"</span><span class='op'>)</span>, check.attributes<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>nb60rt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='cell2nb.html'>cell2nb</a></span><span class='op'>(</span><span class='fl'>60</span>, <span class='fl'>60</span>, torus<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>W</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>nb60rt</span><span class='op'>)</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>W</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>, ncol<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>ee</span> <span class='op'>&lt;-</span> <span class='fu'>powerWeights</span><span class='op'>(</span><span class='va'>W</span>, rho<span class='op'>=</span><span class='fl'>0.3</span>, X<span class='op'>=</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='fu'>as</span><span class='op'>(</span><span class='va'>ee</span>, <span class='st'>"matrix"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>obj</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='fu'>as</span><span class='op'>(</span><span class='va'>ee</span>, <span class='st'>"matrix"</span><span class='op'>)</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span> <span class='op'>~</span> <span class='fl'>1</span>, listw<span class='op'>=</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>nb60rt</span><span class='op'>)</span>, method<span class='op'>=</span><span class='st'>"Matrix"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coefficients</a></span><span class='op'>(</span><span class='va'>obj</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>oldcol</span><span class='op'>)</span>
<span class='va'>W.eig</span> <span class='op'>&lt;-</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fl'>1</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>W.eig</span><span class='op'>)</span>
<span class='va'>S.eig</span> <span class='op'>&lt;-</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"S"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fl'>1</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>S.eig</span><span class='op'>)</span>
<span class='va'>B.eig</span> <span class='op'>&lt;-</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"B"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fl'>1</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>B.eig</span><span class='op'>)</span>
<span class='co'># cases for intrinsically asymmetric weights</span>
<span class='va'>crds</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>COL.OLD</span><span class='op'>$</span><span class='va'>X</span>, <span class='va'>COL.OLD</span><span class='op'>$</span><span class='va'>Y</span><span class='op'>)</span>
<span class='va'>k3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='knn2nb.html'>knn2nb</a></span><span class='op'>(</span><span class='fu'><a href='knearneigh.html'>knearneigh</a></span><span class='op'>(</span><span class='va'>crds</span>, k<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='is.symmetric.nb.html'>is.symmetric.nb</a></span><span class='op'>(</span><span class='va'>k3</span><span class='op'>)</span>
<span class='va'>k3eig</span> <span class='op'>&lt;-</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>k3</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/complex.html'>is.complex</a></span><span class='op'>(</span><span class='va'>k3eig</span><span class='op'>)</span>
<span class='va'>rho</span> <span class='op'>&lt;-</span> <span class='fl'>0.5</span>
<span class='va'>Jc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>rho</span> <span class='op'>*</span> <span class='va'>k3eig</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># complex eigenvalue Jacobian</span>
<span class='va'>Jc</span>
<span class='va'>W</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>k3</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='va'>I</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/diag.html'>diag</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>k3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>Jl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/diag.html'>diag</a></span><span class='op'>(</span><span class='fu'>slot</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/Matrix/man/lu.html'>lu</a></span><span class='op'>(</span><span class='va'>I</span> <span class='op'>-</span> <span class='va'>rho</span> <span class='op'>*</span> <span class='va'>W</span><span class='op'>)</span>, <span class='st'>"U"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># LU Jacobian equals complex eigenvalue Jacobian</span>
<span class='va'>Jl</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Re</a></span><span class='op'>(</span><span class='va'>Jc</span><span class='op'>)</span>, <span class='va'>Jl</span><span class='op'>)</span>
<span class='co'># wrong value if only real part used</span>
<span class='va'>Jr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>rho</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Re</a></span><span class='op'>(</span><span class='va'>k3eig</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>Jr</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>Jr</span>, <span class='va'>Jl</span><span class='op'>)</span>
<span class='co'># construction of Jacobian from complex conjugate pairs (Jan Hauke)</span>
<span class='va'>Rev</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Re</a></span><span class='op'>(</span><span class='va'>k3eig</span><span class='op'>)</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Im</a></span><span class='op'>(</span><span class='va'>k3eig</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>]</span>
<span class='co'># real eigenvalues</span>
<span class='va'>Cev</span> <span class='op'>&lt;-</span> <span class='va'>k3eig</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Im</a></span><span class='op'>(</span><span class='va'>k3eig</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>]</span>
<span class='va'>pCev</span> <span class='op'>&lt;-</span> <span class='va'>Cev</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Im</a></span><span class='op'>(</span><span class='va'>Cev</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>]</span>
<span class='co'># separate complex conjugate pairs</span>
<span class='va'>RpCev</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Re</a></span><span class='op'>(</span><span class='va'>pCev</span><span class='op'>)</span>
<span class='va'>IpCev</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Im</a></span><span class='op'>(</span><span class='va'>pCev</span><span class='op'>)</span>
<span class='co'># reassemble Jacobian</span>
<span class='va'>Jc1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>rho</span><span class='op'>*</span><span class='va'>Rev</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>rho</span> <span class='op'>*</span> <span class='va'>RpCev</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>rho</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='va'>IpCev</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Re</a></span><span class='op'>(</span><span class='va'>Jc</span><span class='op'>)</span>, <span class='va'>Jc1</span><span class='op'>)</span>
<span class='co'># impact of omitted complex part term in real part only Jacobian</span>
<span class='va'>Jc2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>rho</span><span class='op'>*</span><span class='va'>Rev</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>rho</span> <span class='op'>*</span> <span class='va'>RpCev</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>Jr</span>, <span class='va'>Jc2</span><span class='op'>)</span>
<span class='co'># trace of asymmetric (WW) and crossprod of complex eigenvalues for APLE</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>W</span> <span class='op'>%*%</span> <span class='va'>W</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/Matrix/man/matrix-products.html'>crossprod</a></span><span class='op'>(</span><span class='va'>k3eig</span><span class='op'>)</span>
<span class='co'># analytical regular grid eigenvalues</span>
<span class='va'>run</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/yixuan/RSpectra'>"RSpectra"</a></span>, quietly<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='va'>run</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>rg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='cell2nb.html'>cell2nb</a></span><span class='op'>(</span>ncol<span class='op'>=</span><span class='fl'>7</span>, nrow<span class='op'>=</span><span class='fl'>7</span>, type<span class='op'>=</span><span class='st'>"rook"</span><span class='op'>)</span>
<span class='va'>B</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>rg</span>, style<span class='op'>=</span><span class='st'>"B"</span><span class='op'>)</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='va'>res1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/RSpectra/man/eigs.html'>eigs</a></span><span class='op'>(</span><span class='va'>B</span>, k<span class='op'>=</span><span class='fl'>1</span>, which<span class='op'>=</span><span class='st'>"LR"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>values</span>
<span class='va'>resn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/RSpectra/man/eigs.html'>eigs</a></span><span class='op'>(</span><span class='va'>B</span>, k<span class='op'>=</span><span class='fl'>1</span>, which<span class='op'>=</span><span class='st'>"SR"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>values</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Re</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>resn</span>, <span class='va'>res1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>rg_eig</span> <span class='op'>&lt;-</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>rg</span>, style<span class='op'>=</span><span class='st'>"B"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Re</a></span><span class='op'>(</span><span class='va'>rg_eig</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>resn</span>, <span class='va'>res1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> 
<span class='op'>}</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>lw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>rg</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>
<span class='va'>rg_eig</span> <span class='op'>&lt;-</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'>similar.listw</span><span class='op'>(</span><span class='va'>lw</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Re</a></span><span class='op'>(</span><span class='va'>rg_eig</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>W</span>  <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>lw</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Re</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/RSpectra/man/eigs.html'>eigs</a></span><span class='op'>(</span><span class='va'>W</span>, k<span class='op'>=</span><span class='fl'>1</span>, which<span class='op'>=</span><span class='st'>"SR"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>values</span>, <span class='fu'><a href='https://rdrr.io/pkg/RSpectra/man/eigs.html'>eigs</a></span><span class='op'>(</span><span class='va'>W</span>, k<span class='op'>=</span><span class='fl'>1</span>, which<span class='op'>=</span><span class='st'>"LR"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>values</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>oldcol</span><span class='op'>)</span>
<span class='va'>COL.W</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>
<span class='va'>COL.S</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"S"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='fl'>0.5</span> <span class='op'>*</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='va'>COL.W</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='fl'>0.5</span> <span class='op'>*</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'>similar.listw</span><span class='op'>(</span><span class='va'>COL.W</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>W_J</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='fu'>as_dsTMatrix_listw</span><span class='op'>(</span><span class='fu'>similar.listw</span><span class='op'>(</span><span class='va'>COL.W</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='va'>I</span> <span class='op'>&lt;-</span> <span class='fu'>as_dsCMatrix_I</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>W_J</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/det.html'>determinant</a></span><span class='op'>(</span><span class='va'>I</span> <span class='op'>-</span> <span class='fl'>0.5</span> <span class='op'>*</span> <span class='va'>W_J</span>, logarithm<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>$</span><span class='va'>modulus</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='fl'>0.5</span> <span class='op'>*</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='va'>COL.S</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='fl'>0.5</span> <span class='op'>*</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'>similar.listw</span><span class='op'>(</span><span class='va'>COL.S</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>W_J</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='fu'>as_dsTMatrix_listw</span><span class='op'>(</span><span class='fu'>similar.listw</span><span class='op'>(</span><span class='va'>COL.S</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/det.html'>determinant</a></span><span class='op'>(</span><span class='va'>I</span> <span class='op'>-</span> <span class='fl'>0.5</span> <span class='op'>*</span> <span class='va'>W_J</span>, logarithm<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>$</span><span class='va'>modulus</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>boston</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span>
<span class='va'>lw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>boston.soi</span><span class='op'>)</span>
<span class='va'>can.sim</span> <span class='op'>&lt;-</span> <span class='fu'>spdep</span><span class='fu'>:::</span><span class='fu'>can.be.simmed</span><span class='op'>(</span><span class='va'>lw</span><span class='op'>)</span>
<span class='va'>env</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>new.env</a></span><span class='op'>(</span>parent<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/environment.html'>globalenv</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"listw"</span>, <span class='va'>lw</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"can.sim"</span>, <span class='va'>can.sim</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"similar"</span>, <span class='cn'>FALSE</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"verbose"</span>, <span class='cn'>FALSE</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"family"</span>, <span class='st'>"SAR"</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'>eigen_setup</span><span class='op'>(</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/get.html'>get</a></span><span class='op'>(</span><span class='st'>"similar"</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'>do_ldet</span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>env</span><span class='op'>)</span>
<span class='va'>env</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>new.env</a></span><span class='op'>(</span>parent<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/environment.html'>globalenv</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"listw"</span>, <span class='va'>lw</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"can.sim"</span>, <span class='va'>can.sim</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"similar"</span>, <span class='cn'>FALSE</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"verbose"</span>, <span class='cn'>FALSE</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"family"</span>, <span class='st'>"SAR"</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"n"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>boston.soi</span><span class='op'>)</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'>eigen_pre_setup</span><span class='op'>(</span><span class='va'>env</span>, pre_eig<span class='op'>=</span><span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'>similar.listw</span><span class='op'>(</span><span class='va'>lw</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>do_ldet</span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>env</span><span class='op'>)</span>
<span class='va'>env</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>new.env</a></span><span class='op'>(</span>parent<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/environment.html'>globalenv</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"listw"</span>, <span class='va'>lw</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"can.sim"</span>, <span class='va'>can.sim</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"similar"</span>, <span class='cn'>FALSE</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"family"</span>, <span class='st'>"SAR"</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"n"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>boston.soi</span><span class='op'>)</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'>Matrix_setup</span><span class='op'>(</span><span class='va'>env</span>, Imult<span class='op'>=</span><span class='fl'>2</span>, super<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/get.html'>get</a></span><span class='op'>(</span><span class='st'>"similar"</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'>do_ldet</span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>env</span><span class='op'>)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='st'><a href='https://www.math.uzh.ch/pages/spam/'>"spam"</a></span>, quietly<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>env</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>new.env</a></span><span class='op'>(</span>parent<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/environment.html'>globalenv</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"listw"</span>, <span class='va'>lw</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"n"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>boston.soi</span><span class='op'>)</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"can.sim"</span>, <span class='va'>can.sim</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"similar"</span>, <span class='cn'>FALSE</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"family"</span>, <span class='st'>"SAR"</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'>spam_setup</span><span class='op'>(</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/get.html'>get</a></span><span class='op'>(</span><span class='st'>"similar"</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'>do_ldet</span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>env</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>env</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>new.env</a></span><span class='op'>(</span>parent<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/environment.html'>globalenv</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"listw"</span>, <span class='va'>lw</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"n"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>boston.soi</span><span class='op'>)</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"similar"</span>, <span class='cn'>FALSE</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"family"</span>, <span class='st'>"SAR"</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'>LU_setup</span><span class='op'>(</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/get.html'>get</a></span><span class='op'>(</span><span class='st'>"similar"</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'>do_ldet</span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>env</span><span class='op'>)</span>
<span class='va'>env</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>new.env</a></span><span class='op'>(</span>parent<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/environment.html'>globalenv</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"listw"</span>, <span class='va'>lw</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"n"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>boston.soi</span><span class='op'>)</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"similar"</span>, <span class='cn'>FALSE</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"family"</span>, <span class='st'>"SAR"</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'>LU_prepermutate_setup</span><span class='op'>(</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/get.html'>get</a></span><span class='op'>(</span><span class='st'>"similar"</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'>do_ldet</span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>env</span><span class='op'>)</span>
<span class='va'>env</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>new.env</a></span><span class='op'>(</span>parent<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/environment.html'>globalenv</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"listw"</span>, <span class='va'>lw</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"similar"</span>, <span class='cn'>FALSE</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"family"</span>, <span class='st'>"SAR"</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'>cheb_setup</span><span class='op'>(</span><span class='va'>env</span>, q<span class='op'>=</span><span class='fl'>5</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/get.html'>get</a></span><span class='op'>(</span><span class='st'>"similar"</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'>do_ldet</span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>env</span><span class='op'>)</span>
<span class='va'>env</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>new.env</a></span><span class='op'>(</span>parent<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/environment.html'>globalenv</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"listw"</span>, <span class='va'>lw</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"n"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>boston.soi</span><span class='op'>)</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"similar"</span>, <span class='cn'>FALSE</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/assign.html'>assign</a></span><span class='op'>(</span><span class='st'>"family"</span>, <span class='st'>"SAR"</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span>
<span class='fu'>mcdet_setup</span><span class='op'>(</span><span class='va'>env</span>, p<span class='op'>=</span><span class='fl'>16</span>, m<span class='op'>=</span><span class='fl'>30</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/get.html'>get</a></span><span class='op'>(</span><span class='st'>"similar"</span>, envir<span class='op'>=</span><span class='va'>env</span><span class='op'>)</span>
<span class='fu'>do_ldet</span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='va'>env</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>env</span><span class='op'>)</span>
<span class='va'>nydata</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"shapes/NY8_bna_utm18.gpkg"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, quiet<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressMessages</a></span><span class='op'>(</span><span class='va'>nyadjmat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='fu'>foreign</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/foreign/man/read.dbf.html'>read.dbf</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span>
 <span class='st'>"misc/nyadjwts.dbf"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressMessages</a></span><span class='op'>(</span><span class='va'>ID</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='fu'>foreign</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/foreign/man/read.dbf.html'>read.dbf</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span>
 <span class='st'>"misc/nyadjwts.dbf"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/identical.html'>identical</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substring</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='fl'>2</span>, <span class='fl'>10</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substring</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>nydata</span><span class='op'>$</span><span class='va'>AREAKEY</span><span class='op'>)</span>, <span class='fl'>2</span>, <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>nyadjlw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mat2listw.html'>mat2listw</a></span><span class='op'>(</span><span class='va'>nyadjmat</span><span class='op'>)</span>
<span class='va'>listw_NY</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>nyadjlw</span><span class='op'>$</span><span class='va'>neighbours</span>, style<span class='op'>=</span><span class='st'>"B"</span><span class='op'>)</span>
<span class='va'>esar1f</span> <span class='op'>&lt;-</span> <span class='fu'>spautolm</span><span class='op'>(</span><span class='va'>Z</span> <span class='op'>~</span> <span class='va'>PEXPOSURE</span> <span class='op'>+</span> <span class='va'>PCTAGE65P</span> <span class='op'>+</span> <span class='va'>PCTOWNHOME</span>, data<span class='op'>=</span><span class='va'>nydata</span>,
 listw<span class='op'>=</span><span class='va'>listw_NY</span>, family<span class='op'>=</span><span class='st'>"SAR"</span>, method<span class='op'>=</span><span class='st'>"eigen"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>esar1f</span><span class='op'>)</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>MCMCsamp</span><span class='op'>(</span><span class='va'>esar1f</span>, mcmc<span class='op'>=</span><span class='fl'>5000</span>, burnin<span class='op'>=</span><span class='fl'>500</span>, listw<span class='op'>=</span><span class='va'>listw_NY</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
<span class='co'>#esar1fw &lt;- spautolm(Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data=nydata,</span>
<span class='co'># listw=listw_NY, weights=POP8, family="SAR", method="eigen")</span>
<span class='co'>#summary(esar1fw)</span>
<span class='co'>#res &lt;- MCMCsamp(esar1fw, mcmc=5000, burnin=500, listw=listw_NY)</span>
<span class='co'>#summary(res)</span>
<span class='va'>ecar1f</span> <span class='op'>&lt;-</span> <span class='fu'>spautolm</span><span class='op'>(</span><span class='va'>Z</span> <span class='op'>~</span> <span class='va'>PEXPOSURE</span> <span class='op'>+</span> <span class='va'>PCTAGE65P</span> <span class='op'>+</span> <span class='va'>PCTOWNHOME</span>, data<span class='op'>=</span><span class='va'>nydata</span>,
 listw<span class='op'>=</span><span class='va'>listw_NY</span>, family<span class='op'>=</span><span class='st'>"CAR"</span>, method<span class='op'>=</span><span class='st'>"eigen"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ecar1f</span><span class='op'>)</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>MCMCsamp</span><span class='op'>(</span><span class='va'>ecar1f</span>, mcmc<span class='op'>=</span><span class='fl'>5000</span>, burnin<span class='op'>=</span><span class='fl'>500</span>, listw<span class='op'>=</span><span class='va'>listw_NY</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
<span class='co'>#esar1fw &lt;- spautolm(Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data=nydata,</span>
<span class='co'># listw=listw_NY, weights=POP8, family="SAR", method="eigen")</span>
<span class='co'>#summary(esar1fw)</span>
<span class='co'>#res &lt;- MCMCsamp(esar1fw, mcmc=5000, burnin=500, listw=listw_NY)</span>
<span class='co'>#summary(res)</span>
<span class='co'>#ecar1fw &lt;- spautolm(Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data=nydata,</span>
<span class='co'># listw=listw_NY, weights=POP8, family="CAR", method="eigen")</span>
<span class='co'>#summary(ecar1fw)</span>
<span class='co'>#res &lt;- MCMCsamp(ecar1fw, mcmc=5000, burnin=500, listw=listw_NY)</span>
<span class='co'>#summary(res)</span>
<span class='va'>esar0</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>Z</span> <span class='op'>~</span> <span class='va'>PEXPOSURE</span> <span class='op'>+</span> <span class='va'>PCTAGE65P</span> <span class='op'>+</span> <span class='va'>PCTOWNHOME</span>, data<span class='op'>=</span><span class='va'>nydata</span>,
 listw<span class='op'>=</span><span class='va'>listw_NY</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>esar0</span><span class='op'>)</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>MCMCsamp</span><span class='op'>(</span><span class='va'>esar0</span>, mcmc<span class='op'>=</span><span class='fl'>5000</span>, burnin<span class='op'>=</span><span class='fl'>500</span>, listw<span class='op'>=</span><span class='va'>listw_NY</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
<span class='co'>#esar0w &lt;- errorsarlm(Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data=nydata,</span>
<span class='co'># listw=listw_NY, weights=POP8)</span>
<span class='co'>#summary(esar0w)</span>
<span class='co'>#res &lt;- MCMCsamp(esar0w, mcmc=5000, burnin=500, listw=listw_NY)</span>
<span class='co'>#summary(res)</span>
<span class='va'>esar1</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>Z</span> <span class='op'>~</span> <span class='va'>PEXPOSURE</span> <span class='op'>+</span> <span class='va'>PCTAGE65P</span> <span class='op'>+</span> <span class='va'>PCTOWNHOME</span>, data<span class='op'>=</span><span class='va'>nydata</span>,
 listw<span class='op'>=</span><span class='va'>listw_NY</span>, etype<span class='op'>=</span><span class='st'>"emixed"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>esar1</span><span class='op'>)</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>MCMCsamp</span><span class='op'>(</span><span class='va'>esar1</span>, mcmc<span class='op'>=</span><span class='fl'>5000</span>, burnin<span class='op'>=</span><span class='fl'>500</span>, listw<span class='op'>=</span><span class='va'>listw_NY</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
<span class='va'>lsar0</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>Z</span> <span class='op'>~</span> <span class='va'>PEXPOSURE</span> <span class='op'>+</span> <span class='va'>PCTAGE65P</span> <span class='op'>+</span> <span class='va'>PCTOWNHOME</span>, data<span class='op'>=</span><span class='va'>nydata</span>,
 listw<span class='op'>=</span><span class='va'>listw_NY</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>lsar0</span><span class='op'>)</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>MCMCsamp</span><span class='op'>(</span><span class='va'>lsar0</span>, mcmc<span class='op'>=</span><span class='fl'>5000</span>, burnin<span class='op'>=</span><span class='fl'>500</span>, listw<span class='op'>=</span><span class='va'>listw_NY</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
<span class='va'>lsar1</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>Z</span> <span class='op'>~</span> <span class='va'>PEXPOSURE</span> <span class='op'>+</span> <span class='va'>PCTAGE65P</span> <span class='op'>+</span> <span class='va'>PCTOWNHOME</span>, data<span class='op'>=</span><span class='va'>nydata</span>,
 listw<span class='op'>=</span><span class='va'>listw_NY</span>, type<span class='op'>=</span><span class='st'>"mixed"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>lsar1</span><span class='op'>)</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>MCMCsamp</span><span class='op'>(</span><span class='va'>lsar1</span>, mcmc<span class='op'>=</span><span class='fl'>5000</span>, burnin<span class='op'>=</span><span class='fl'>500</span>, listw<span class='op'>=</span><span class='va'>listw_NY</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
<span class='va'>ssar0</span> <span class='op'>&lt;-</span> <span class='fu'>sacsarlm</span><span class='op'>(</span><span class='va'>Z</span> <span class='op'>~</span> <span class='va'>PEXPOSURE</span> <span class='op'>+</span> <span class='va'>PCTAGE65P</span> <span class='op'>+</span> <span class='va'>PCTOWNHOME</span>, data<span class='op'>=</span><span class='va'>nydata</span>,
 listw<span class='op'>=</span><span class='va'>listw_NY</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ssar0</span><span class='op'>)</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>MCMCsamp</span><span class='op'>(</span><span class='va'>ssar0</span>, mcmc<span class='op'>=</span><span class='fl'>5000</span>, burnin<span class='op'>=</span><span class='fl'>500</span>, listw<span class='op'>=</span><span class='va'>listw_NY</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
<span class='va'>ssar1</span> <span class='op'>&lt;-</span> <span class='fu'>sacsarlm</span><span class='op'>(</span><span class='va'>Z</span> <span class='op'>~</span> <span class='va'>PEXPOSURE</span> <span class='op'>+</span> <span class='va'>PCTAGE65P</span> <span class='op'>+</span> <span class='va'>PCTOWNHOME</span>, data<span class='op'>=</span><span class='va'>nydata</span>,
 listw<span class='op'>=</span><span class='va'>listw_NY</span>, type<span class='op'>=</span><span class='st'>"sacmixed"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ssar1</span><span class='op'>)</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>MCMCsamp</span><span class='op'>(</span><span class='va'>ssar1</span>, mcmc<span class='op'>=</span><span class='fl'>5000</span>, burnin<span class='op'>=</span><span class='fl'>500</span>, listw<span class='op'>=</span><span class='va'>listw_NY</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
<span class='va'>nydata</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"shapes/NY8_bna_utm18.gpkg"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, quiet<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>lm0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>Z</span> <span class='op'>~</span> <span class='va'>PEXPOSURE</span> <span class='op'>+</span> <span class='va'>PCTAGE65P</span> <span class='op'>+</span> <span class='va'>PCTOWNHOME</span>, data<span class='op'>=</span><span class='va'>nydata</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>lm0</span><span class='op'>)</span>
<span class='va'>lm0w</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>Z</span> <span class='op'>~</span> <span class='va'>PEXPOSURE</span> <span class='op'>+</span> <span class='va'>PCTAGE65P</span> <span class='op'>+</span> <span class='va'>PCTOWNHOME</span>, data<span class='op'>=</span><span class='va'>nydata</span>, weights<span class='op'>=</span><span class='va'>POP8</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>lm0w</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressMessages</a></span><span class='op'>(</span><span class='va'>nyadjmat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='fu'>foreign</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/foreign/man/read.dbf.html'>read.dbf</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span>
 <span class='st'>"misc/nyadjwts.dbf"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressMessages</a></span><span class='op'>(</span><span class='va'>ID</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='fu'>foreign</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/foreign/man/read.dbf.html'>read.dbf</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span>
 <span class='st'>"misc/nyadjwts.dbf"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/identical.html'>identical</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substring</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='fl'>2</span>, <span class='fl'>10</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substring</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>nydata</span><span class='op'>$</span><span class='va'>AREAKEY</span><span class='op'>)</span>, <span class='fl'>2</span>, <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>nyadjlw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mat2listw.html'>mat2listw</a></span><span class='op'>(</span><span class='va'>nyadjmat</span>, <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>nydata</span><span class='op'>$</span><span class='va'>AREAKEY</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>listw_NY</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>nyadjlw</span><span class='op'>$</span><span class='va'>neighbours</span>, style<span class='op'>=</span><span class='st'>"B"</span><span class='op'>)</span>
<span class='va'>esar0</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>Z</span> <span class='op'>~</span> <span class='va'>PEXPOSURE</span> <span class='op'>+</span> <span class='va'>PCTAGE65P</span> <span class='op'>+</span> <span class='va'>PCTOWNHOME</span>, data<span class='op'>=</span><span class='va'>nydata</span>,
 listw<span class='op'>=</span><span class='va'>listw_NY</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>esar0</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>esar1f</span> <span class='op'>&lt;-</span> <span class='fu'>spautolm</span><span class='op'>(</span><span class='va'>Z</span> <span class='op'>~</span> <span class='va'>PEXPOSURE</span> <span class='op'>+</span> <span class='va'>PCTAGE65P</span> <span class='op'>+</span> <span class='va'>PCTOWNHOME</span>,
 data<span class='op'>=</span><span class='va'>nydata</span>, listw<span class='op'>=</span><span class='va'>listw_NY</span>, family<span class='op'>=</span><span class='st'>"SAR"</span>, method<span class='op'>=</span><span class='st'>"eigen"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>esar1f</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>$</span><span class='va'>resvar</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>esar1f</span><span class='op'>$</span><span class='va'>fit</span><span class='op'>$</span><span class='va'>imat</span><span class='op'>)</span><span class='op'>*</span><span class='va'>esar1f</span><span class='op'>$</span><span class='va'>fit</span><span class='op'>$</span><span class='va'>s2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>esar1f</span><span class='op'>$</span><span class='va'>fdHess</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>esar1M</span> <span class='op'>&lt;-</span> <span class='fu'>spautolm</span><span class='op'>(</span><span class='va'>Z</span> <span class='op'>~</span> <span class='va'>PEXPOSURE</span> <span class='op'>+</span> <span class='va'>PCTAGE65P</span> <span class='op'>+</span> <span class='va'>PCTOWNHOME</span>,
 data<span class='op'>=</span><span class='va'>nydata</span>, listw<span class='op'>=</span><span class='va'>listw_NY</span>, family<span class='op'>=</span><span class='st'>"SAR"</span>, method<span class='op'>=</span><span class='st'>"Matrix"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>esar1M</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>esar1M</span> <span class='op'>&lt;-</span> <span class='fu'>spautolm</span><span class='op'>(</span><span class='va'>Z</span> <span class='op'>~</span> <span class='va'>PEXPOSURE</span> <span class='op'>+</span> <span class='va'>PCTAGE65P</span> <span class='op'>+</span> <span class='va'>PCTOWNHOME</span>,
 data<span class='op'>=</span><span class='va'>nydata</span>, listw<span class='op'>=</span><span class='va'>listw_NY</span>, family<span class='op'>=</span><span class='st'>"SAR"</span>, method<span class='op'>=</span><span class='st'>"Matrix"</span>,
 control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>super<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>esar1M</span><span class='op'>)</span>
<span class='co'>#esar1wf &lt;- spautolm(Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data=nydata,</span>
<span class='co'># listw=listw_NY, weights=POP8, family="SAR", method="eigen")</span>
<span class='co'>#summary(esar1wf)</span>
<span class='co'>#system.time(esar1wM &lt;- spautolm(Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME,</span>
<span class='co'># data=nydata, listw=listw_NY, weights=POP8, family="SAR", method="Matrix"))</span>
<span class='co'>#summary(esar1wM)</span>
<span class='co'>#esar1wlu &lt;- spautolm(Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data=nydata,</span>
<span class='co'># listw=listw_NY, weights=POP8, family="SAR", method="LU")</span>
<span class='co'>#summary(esar1wlu)</span>
<span class='co'>#esar1wch &lt;- spautolm(Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data=nydata,</span>
<span class='co'># listw=listw_NY, weights=POP8, family="SAR", method="Chebyshev")</span>
<span class='co'>#summary(esar1wch)</span>
<span class='va'>ecar1f</span> <span class='op'>&lt;-</span> <span class='fu'>spautolm</span><span class='op'>(</span><span class='va'>Z</span> <span class='op'>~</span> <span class='va'>PEXPOSURE</span> <span class='op'>+</span> <span class='va'>PCTAGE65P</span> <span class='op'>+</span> <span class='va'>PCTOWNHOME</span>, data<span class='op'>=</span><span class='va'>nydata</span>,
 listw<span class='op'>=</span><span class='va'>listw_NY</span>, family<span class='op'>=</span><span class='st'>"CAR"</span>, method<span class='op'>=</span><span class='st'>"eigen"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ecar1f</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>ecar1M</span> <span class='op'>&lt;-</span> <span class='fu'>spautolm</span><span class='op'>(</span><span class='va'>Z</span> <span class='op'>~</span> <span class='va'>PEXPOSURE</span> <span class='op'>+</span> <span class='va'>PCTAGE65P</span> <span class='op'>+</span> <span class='va'>PCTOWNHOME</span>,
 data<span class='op'>=</span><span class='va'>nydata</span>, listw<span class='op'>=</span><span class='va'>listw_NY</span>, family<span class='op'>=</span><span class='st'>"CAR"</span>, method<span class='op'>=</span><span class='st'>"Matrix"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ecar1M</span><span class='op'>)</span>
<span class='co'>#ecar1wf &lt;- spautolm(Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data=nydata,</span>
<span class='co'># listw=listw_NY, weights=nydata$POP8, family="CAR", method="eigen")</span>
<span class='co'>#summary(ecar1wf)</span>
<span class='co'>#system.time(ecar1wM &lt;- spautolm(Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME,</span>
<span class='co'># data=nydata, listw=listw_NY, weights=POP8, family="CAR", method="Matrix"))</span>
<span class='co'>#summary(ecar1wM)</span>
<span class='va'>nc.sids</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"shapes/sids.shp"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, quiet<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>ft.SID74</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fl'>1000</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>nc.sids</span><span class='op'>$</span><span class='va'>SID74</span><span class='op'>/</span><span class='va'>nc.sids</span><span class='op'>$</span><span class='va'>BIR74</span><span class='op'>)</span> <span class='op'>+</span>
 <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>nc.sids</span><span class='op'>$</span><span class='va'>SID74</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>/</span><span class='va'>nc.sids</span><span class='op'>$</span><span class='va'>BIR74</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>lm_nc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>ft.SID74</span> <span class='op'>~</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='va'>sids.nhbr30</span> <span class='op'>&lt;-</span> <span class='fu'><a href='dnearneigh.html'>dnearneigh</a></span><span class='op'>(</span><span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>nc.sids</span><span class='op'>$</span><span class='va'>east</span>, <span class='va'>nc.sids</span><span class='op'>$</span><span class='va'>north</span><span class='op'>)</span>, <span class='fl'>0</span>, <span class='fl'>30</span>, row.names<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/row.names.html'>row.names</a></span><span class='op'>(</span><span class='va'>nc.sids</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>sids.nhbr30.dist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nbdists.html'>nbdists</a></span><span class='op'>(</span><span class='va'>sids.nhbr30</span>, <span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>nc.sids</span><span class='op'>$</span><span class='va'>east</span>, <span class='va'>nc.sids</span><span class='op'>$</span><span class='va'>north</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>sids.nhbr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='listw2sn.html'>listw2sn</a></span><span class='op'>(</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>sids.nhbr30</span>, glist<span class='op'>=</span><span class='va'>sids.nhbr30.dist</span>, style<span class='op'>=</span><span class='st'>"B"</span>, zero.policy<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dij</span> <span class='op'>&lt;-</span> <span class='va'>sids.nhbr</span><span class='op'>[</span>,<span class='fl'>3</span><span class='op'>]</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='va'>nc.sids</span><span class='op'>$</span><span class='va'>BIR74</span>
<span class='va'>el1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>dij</span><span class='op'>)</span><span class='op'>/</span><span class='va'>dij</span>
<span class='va'>el2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>[</span><span class='va'>sids.nhbr</span><span class='op'>$</span><span class='va'>to</span><span class='op'>]</span><span class='op'>/</span><span class='va'>n</span><span class='op'>[</span><span class='va'>sids.nhbr</span><span class='op'>$</span><span class='va'>from</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>sids.nhbr</span><span class='op'>$</span><span class='va'>weights</span> <span class='op'>&lt;-</span> <span class='va'>el1</span><span class='op'>*</span><span class='va'>el2</span>
<span class='va'>sids.nhbr.listw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='listw2sn.html'>sn2listw</a></span><span class='op'>(</span><span class='va'>sids.nhbr</span><span class='op'>)</span>
<span class='va'>both</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>nc.sids</span><span class='op'>$</span><span class='va'>L_id</span>, <span class='va'>nc.sids</span><span class='op'>$</span><span class='va'>M_id</span>, sep<span class='op'>=</span><span class='st'>":"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>ft.NWBIR74</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fl'>1000</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>nc.sids</span><span class='op'>$</span><span class='va'>NWBIR74</span><span class='op'>/</span><span class='va'>nc.sids</span><span class='op'>$</span><span class='va'>BIR74</span><span class='op'>)</span> <span class='op'>+</span>
 <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>nc.sids</span><span class='op'>$</span><span class='va'>NWBIR74</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>/</span><span class='va'>nc.sids</span><span class='op'>$</span><span class='va'>BIR74</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>mdata</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>both</span>, <span class='va'>ft.NWBIR74</span>, <span class='va'>ft.SID74</span>, BIR74<span class='op'>=</span><span class='va'>nc.sids</span><span class='op'>$</span><span class='va'>BIR74</span><span class='op'>)</span>
<span class='va'>outl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.min.html'>which.max</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/influence.measures.html'>rstandard</a></span><span class='op'>(</span><span class='va'>lm_nc</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>nc.sids</span><span class='op'>$</span><span class='va'>NAME</span><span class='op'>[</span><span class='va'>outl</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>mdata.4</span> <span class='op'>&lt;-</span> <span class='va'>mdata</span><span class='op'>[</span><span class='op'>-</span><span class='va'>outl</span>,<span class='op'>]</span>
<span class='va'>W</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2mat.html'>listw2mat</a></span><span class='op'>(</span><span class='va'>sids.nhbr.listw</span><span class='op'>)</span>
<span class='va'>W.4</span> <span class='op'>&lt;-</span> <span class='va'>W</span><span class='op'>[</span><span class='op'>-</span><span class='va'>outl</span>, <span class='op'>-</span><span class='va'>outl</span><span class='op'>]</span>
<span class='va'>sids.nhbr.listw.4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mat2listw.html'>mat2listw</a></span><span class='op'>(</span><span class='va'>W.4</span><span class='op'>)</span>
<span class='va'>esarI</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>ft.SID74</span> <span class='op'>~</span> <span class='fl'>1</span>, data<span class='op'>=</span><span class='va'>mdata</span>, listw<span class='op'>=</span><span class='va'>sids.nhbr.listw</span>,
 zero.policy<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>esarI</span><span class='op'>)</span>
<span class='va'>esarIa</span> <span class='op'>&lt;-</span> <span class='fu'>spautolm</span><span class='op'>(</span><span class='va'>ft.SID74</span> <span class='op'>~</span> <span class='fl'>1</span>, data<span class='op'>=</span><span class='va'>mdata</span>, listw<span class='op'>=</span><span class='va'>sids.nhbr.listw</span>,
 family<span class='op'>=</span><span class='st'>"SAR"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>esarIa</span><span class='op'>)</span>
<span class='va'>esarIV</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>ft.SID74</span> <span class='op'>~</span> <span class='va'>ft.NWBIR74</span>, data<span class='op'>=</span><span class='va'>mdata</span>, listw<span class='op'>=</span><span class='va'>sids.nhbr.listw</span>,
 zero.policy<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>esarIV</span><span class='op'>)</span>
<span class='va'>esarIVa</span> <span class='op'>&lt;-</span> <span class='fu'>spautolm</span><span class='op'>(</span><span class='va'>ft.SID74</span> <span class='op'>~</span> <span class='va'>ft.NWBIR74</span>, data<span class='op'>=</span><span class='va'>mdata</span>, listw<span class='op'>=</span><span class='va'>sids.nhbr.listw</span>,
 family<span class='op'>=</span><span class='st'>"SAR"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>esarIVa</span><span class='op'>)</span>
<span class='co'>#esarIaw &lt;- spautolm(ft.SID74 ~ 1, data=mdata, listw=sids.nhbr.listw,</span>
<span class='co'># weights=BIR74, family="SAR")</span>
<span class='co'>#summary(esarIaw)</span>
<span class='co'>#esarIIaw &lt;- spautolm(ft.SID74 ~ both - 1, data=mdata, listw=sids.nhbr.listw,</span>
<span class='co'># weights=BIR74, family="SAR")</span>
<span class='co'>#summary(esarIIaw)</span>
<span class='co'>#esarIVaw &lt;- spautolm(ft.SID74 ~ ft.NWBIR74, data=mdata,</span>
<span class='co'># listw=sids.nhbr.listw, weights=BIR74, family="SAR")</span>
<span class='co'>#summary(esarIVaw)</span>
<span class='co'>#ecarIaw &lt;- spautolm(ft.SID74 ~ 1, data=mdata.4, listw=sids.nhbr.listw.4,</span>
<span class='co'># weights=BIR74, family="CAR")</span>
<span class='co'>#summary(ecarIaw)</span>
<span class='co'>#ecarIIaw &lt;- spautolm(ft.SID74 ~ both - 1, data=mdata.4,</span>
<span class='co'># listw=sids.nhbr.listw.4, weights=BIR74, family="CAR")</span>
<span class='co'>#summary(ecarIIaw)</span>
<span class='co'>#ecarIVaw &lt;- spautolm(ft.SID74 ~ ft.NWBIR74, data=mdata.4,</span>
<span class='co'># listw=sids.nhbr.listw.4, weights=BIR74, family="CAR")</span>
<span class='co'>#summary(ecarIVaw)</span>
<span class='co'>#nc.sids$fitIV &lt;- append(fitted.values(ecarIVaw), NA, outl-1)</span>
<span class='co'>#plot(nc.sids[,"fitIV"], nbreaks=12) # Cressie 1993, p. 565</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>oldcol</span><span class='op'>)</span>
<span class='va'>COL.errW.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span><span class='op'>)</span>
<span class='va'>COL.errW.sar</span> <span class='op'>&lt;-</span> <span class='fu'>spautolm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.errW.sar</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>boston</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span>
<span class='va'>gp1</span> <span class='op'>&lt;-</span> <span class='fu'>spautolm</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>CMEDV</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>CRIM</span> <span class='op'>+</span> <span class='va'>ZN</span> <span class='op'>+</span> <span class='va'>INDUS</span> <span class='op'>+</span> <span class='va'>CHAS</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>NOX</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>
 <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>RM</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>AGE</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>DIS</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>RAD</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>TAX</span> <span class='op'>+</span> <span class='va'>PTRATIO</span> <span class='op'>+</span> <span class='va'>B</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>LSTAT</span><span class='op'>)</span>, 
 data<span class='op'>=</span><span class='va'>boston.c</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>boston.soi</span><span class='op'>)</span>, family<span class='op'>=</span><span class='st'>"SMA"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>gp1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>oldcol</span><span class='op'>)</span>
<span class='va'>listw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>
<span class='va'>ev</span> <span class='op'>&lt;-</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='va'>listw</span><span class='op'>)</span>
<span class='va'>COL.sacW.eig</span> <span class='op'>&lt;-</span> <span class='fu'>sacsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, <span class='va'>listw</span>,
 control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig1<span class='op'>=</span><span class='va'>ev</span>, pre_eig2<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.sacW.eig</span><span class='op'>)</span>
<span class='va'>W</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>listw</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='va'>trMatc</span> <span class='op'>&lt;-</span> <span class='fu'>trW</span><span class='op'>(</span><span class='va'>W</span>, type<span class='op'>=</span><span class='st'>"mult"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.sacW.eig</span>, tr<span class='op'>=</span><span class='va'>trMatc</span>, R<span class='op'>=</span><span class='fl'>2000</span><span class='op'>)</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span>, short<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>coda</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>COL.sacW.B0</span> <span class='op'>&lt;-</span> <span class='fu'>spBreg_sac</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, <span class='va'>listw</span>,
 Durbin<span class='op'>=</span><span class='cn'>FALSE</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>ndraw<span class='op'>=</span><span class='fl'>1500L</span>, nomit<span class='op'>=</span><span class='fl'>500L</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.sacW.B0</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.sacW.B0</span>, tr<span class='op'>=</span><span class='va'>trMatc</span><span class='op'>)</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span>, short<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>COL.sacW.B1</span> <span class='op'>&lt;-</span> <span class='fu'>spBreg_sac</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, <span class='va'>listw</span>,
 Durbin<span class='op'>=</span><span class='cn'>TRUE</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>ndraw<span class='op'>=</span><span class='fl'>1500L</span>, nomit<span class='op'>=</span><span class='fl'>500L</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.sacW.B1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.sacW.B1</span>, tr<span class='op'>=</span><span class='va'>trMatc</span><span class='op'>)</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span>, short<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>COL.msacW.eig</span> <span class='op'>&lt;-</span> <span class='fu'>sacsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, <span class='va'>listw</span>,
 type<span class='op'>=</span><span class='st'>"sacmixed"</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig1<span class='op'>=</span><span class='va'>ev</span>, pre_eig2<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.msacW.eig</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.msacW.eig</span>, tr<span class='op'>=</span><span class='va'>trMatc</span>, R<span class='op'>=</span><span class='fl'>2000</span><span class='op'>)</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span>, short<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>COL.msacW1.eig</span> <span class='op'>&lt;-</span> <span class='fu'>sacsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, <span class='va'>listw</span>,
 Durbin<span class='op'>=</span><span class='cn'>TRUE</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig1<span class='op'>=</span><span class='va'>ev</span>, pre_eig2<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.msacW1.eig</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.msacW1.eig</span>, tr<span class='op'>=</span><span class='va'>trMatc</span>, R<span class='op'>=</span><span class='fl'>2000</span><span class='op'>)</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span>, short<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>COL.msacW2.eig</span> <span class='op'>&lt;-</span> <span class='fu'>sacsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>DISCBD</span> <span class='op'>+</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, 
 <span class='va'>listw</span>, Durbin<span class='op'>=</span> <span class='op'>~</span> <span class='va'>INC</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig1<span class='op'>=</span><span class='va'>ev</span>, pre_eig2<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.msacW2.eig</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.msacW2.eig</span>, tr<span class='op'>=</span><span class='va'>trMatc</span>, R<span class='op'>=</span><span class='fl'>2000</span><span class='op'>)</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span>, short<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>coda</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>oldcol</span><span class='op'>)</span>
<span class='va'>lw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>
<span class='va'>COL.err.Bayes</span> <span class='op'>&lt;-</span> <span class='fu'>spBreg_err</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, listw<span class='op'>=</span><span class='va'>lw</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.err.Bayes</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/raftery.diag.html'>raftery.diag</a></span><span class='op'>(</span><span class='va'>COL.err.Bayes</span>, r<span class='op'>=</span><span class='fl'>0.01</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>COL.err.Bayes</span> <span class='op'>&lt;-</span> <span class='fu'>spBreg_err</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, listw<span class='op'>=</span><span class='va'>lw</span>,
 control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>prior<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>lambdaMH<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.err.Bayes</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/raftery.diag.html'>raftery.diag</a></span><span class='op'>(</span><span class='va'>COL.err.Bayes</span>, r<span class='op'>=</span><span class='fl'>0.01</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>COL.err.Bayes</span> <span class='op'>&lt;-</span> <span class='fu'>spBreg_err</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, listw<span class='op'>=</span><span class='va'>lw</span>,
 Durbin<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.err.Bayes</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.err.Bayes</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/raftery.diag.html'>raftery.diag</a></span><span class='op'>(</span><span class='va'>COL.err.Bayes</span>, r<span class='op'>=</span><span class='fl'>0.01</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>COL.err.Bayes</span> <span class='op'>&lt;-</span> <span class='fu'>spBreg_err</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, listw<span class='op'>=</span><span class='va'>lw</span>,
 Durbin<span class='op'>=</span><span class='cn'>TRUE</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>prior<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>lambdaMH<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.err.Bayes</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.err.Bayes</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/raftery.diag.html'>raftery.diag</a></span><span class='op'>(</span><span class='va'>COL.err.Bayes</span>, r<span class='op'>=</span><span class='fl'>0.01</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>COL.err.Bayes</span> <span class='op'>&lt;-</span> <span class='fu'>spBreg_err</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, listw<span class='op'>=</span><span class='va'>lw</span>,
 Durbin<span class='op'>=</span><span class='op'>~</span><span class='va'>INC</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.err.Bayes</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.err.Bayes</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/raftery.diag.html'>raftery.diag</a></span><span class='op'>(</span><span class='va'>COL.err.Bayes</span>, r<span class='op'>=</span><span class='fl'>0.01</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>COL.err.Bayes</span> <span class='op'>&lt;-</span> <span class='fu'>spBreg_err</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, listw<span class='op'>=</span><span class='va'>lw</span>,
 Durbin<span class='op'>=</span><span class='op'>~</span><span class='va'>INC</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>prior<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>lambdaMH<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.err.Bayes</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.err.Bayes</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/raftery.diag.html'>raftery.diag</a></span><span class='op'>(</span><span class='va'>COL.err.Bayes</span>, r<span class='op'>=</span><span class='fl'>0.01</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>oldcol</span><span class='op'>)</span>
<span class='va'>listw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>
<span class='va'>COL.lag.Bayes</span> <span class='op'>&lt;-</span> <span class='fu'>spBreg_lag</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 listw<span class='op'>=</span><span class='va'>listw</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.lag.Bayes</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.lag.Bayes</span>, tr<span class='op'>=</span><span class='va'>trMatc</span><span class='op'>)</span>, short<span class='op'>=</span><span class='cn'>TRUE</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.lag.Bayes</span>, evalues<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span>, short<span class='op'>=</span><span class='cn'>TRUE</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>COL.D0.Bayes</span> <span class='op'>&lt;-</span> <span class='fu'>spBreg_lag</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 listw<span class='op'>=</span><span class='va'>listw</span>, Durbin<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.D0.Bayes</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.D0.Bayes</span>, tr<span class='op'>=</span><span class='va'>trMatc</span><span class='op'>)</span>, short<span class='op'>=</span><span class='cn'>TRUE</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>COL.D1.Bayes</span> <span class='op'>&lt;-</span> <span class='fu'>spBreg_lag</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>DISCBD</span> <span class='op'>+</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 listw<span class='op'>=</span><span class='va'>listw</span>, Durbin<span class='op'>=</span> <span class='op'>~</span> <span class='va'>INC</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.D1.Bayes</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.D1.Bayes</span>, tr<span class='op'>=</span><span class='va'>trMatc</span><span class='op'>)</span>, short<span class='op'>=</span><span class='cn'>TRUE</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='co'>#data(elect80, package="spData")</span>
<span class='co'>#lw &lt;- nb2listw(e80_queen, zero.policy=TRUE)</span>
<span class='co'>#el_ml &lt;- lagsarlm(log(pc_turnout) ~ log(pc_college) + log(pc_homeownership)</span>
<span class='co'># + log(pc_income), data=elect80, listw=lw, zero.policy=TRUE, method="LU")</span>
<span class='co'>#summary(el_ml)</span>
<span class='co'>#set.seed(1)</span>
<span class='co'>#el_B &lt;- spBreg_lag(log(pc_turnout) ~ log(pc_college) + log(pc_homeownership)</span>
<span class='co'># + log(pc_income), data=elect80, listw=lw, zero.policy=TRUE)</span>
<span class='co'>#summary(el_B)</span>
<span class='co'>#el_ml$timings</span>
<span class='co'>#attr(el_B, "timings")</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>oldcol</span>, package<span class='op'>=</span><span class='st'>"spdep"</span><span class='op'>)</span>
<span class='va'>lw</span> <span class='op'>&lt;-</span> <span class='fu'>spdep</span><span class='fu'>::</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span>
<span class='va'>COL.SLX</span> <span class='op'>&lt;-</span> <span class='fu'>lmSLX</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, listw<span class='op'>=</span><span class='va'>lw</span><span class='op'>)</span>
<span class='va'>pslx0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>COL.SLX</span><span class='op'>)</span>
<span class='va'>pslx1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>COL.SLX</span>, newdata<span class='op'>=</span><span class='va'>COL.OLD</span>, listw<span class='op'>=</span><span class='va'>lw</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>pslx0</span>, <span class='va'>pslx1</span><span class='op'>)</span>
<span class='va'>COL.OLD1</span> <span class='op'>&lt;-</span> <span class='va'>COL.OLD</span>
<span class='va'>COL.OLD1</span><span class='op'>$</span><span class='va'>INC</span> <span class='op'>&lt;-</span> <span class='va'>COL.OLD1</span><span class='op'>$</span><span class='va'>INC</span> <span class='op'>+</span> <span class='fl'>1</span>
<span class='va'>pslx2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>COL.SLX</span>, newdata<span class='op'>=</span><span class='va'>COL.OLD1</span>, listw<span class='op'>=</span><span class='va'>lw</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>COL.SLX</span><span class='op'>)</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>4</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>pslx2</span><span class='op'>-</span><span class='va'>pslx1</span><span class='op'>)</span>
<span class='va'>COL.SLX</span> <span class='op'>&lt;-</span> <span class='fu'>lmSLX</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, listw<span class='op'>=</span><span class='va'>lw</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.SLX</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.SLX</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>COL.SLX</span> <span class='op'>&lt;-</span> <span class='fu'>lmSLX</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>HOVAL</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, listw<span class='op'>=</span><span class='va'>lw</span>, Durbin<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.SLX</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.SLX</span><span class='op'>)</span>
<span class='va'>COL.SLX</span> <span class='op'>&lt;-</span> <span class='fu'>lmSLX</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>HOVAL</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, listw<span class='op'>=</span><span class='va'>lw</span>, Durbin<span class='op'>=</span><span class='op'>~</span><span class='va'>INC</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.SLX</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.SLX</span><span class='op'>)</span>
<span class='va'>COL.SLX</span> <span class='op'>&lt;-</span> <span class='fu'>lmSLX</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, listw<span class='op'>=</span><span class='va'>lw</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.SLX</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.SLX</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>crds</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>COL.OLD</span><span class='op'>$</span><span class='va'>X</span>, <span class='va'>COL.OLD</span><span class='op'>$</span><span class='va'>Y</span><span class='op'>)</span>
<span class='va'>mdist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/diff.html'>diff</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>crds</span>, <span class='fl'>2</span>, <span class='va'>range</span><span class='op'>)</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dnb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='dnearneigh.html'>dnearneigh</a></span><span class='op'>(</span><span class='va'>crds</span>, <span class='fl'>0</span>, <span class='va'>mdist</span><span class='op'>)</span>
<span class='va'>dists</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nbdists.html'>nbdists</a></span><span class='op'>(</span><span class='va'>dnb</span>, <span class='va'>crds</span><span class='op'>)</span>
<span class='va'>f</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>form</span>, <span class='va'>data</span>, <span class='va'>dnb</span>, <span class='va'>dists</span>, <span class='va'>verbose</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>glst</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>dists</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>d</span><span class='op'>)</span> <span class='fl'>1</span><span class='op'>/</span><span class='op'>(</span><span class='va'>d</span><span class='op'>^</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>lw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>dnb</span>, glist<span class='op'>=</span><span class='va'>glst</span>, style<span class='op'>=</span><span class='st'>"B"</span><span class='op'>)</span>
  <span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/logLik.html'>logLik</a></span><span class='op'>(</span><span class='fu'>lmSLX</span><span class='op'>(</span>form<span class='op'>=</span><span class='va'>form</span>, data<span class='op'>=</span><span class='va'>data</span>, listw<span class='op'>=</span><span class='va'>lw</span><span class='op'>)</span><span class='op'>)</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>verbose</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='st'>"power:"</span>, <span class='va'>x</span>, <span class='st'>"logLik:"</span>, <span class='va'>res</span>, <span class='st'>"\n"</span><span class='op'>)</span>
  <span class='va'>res</span>
<span class='op'>}</span>
<span class='va'>opt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/optimize.html'>optimize</a></span><span class='op'>(</span><span class='va'>f</span>, interval<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>4</span><span class='op'>)</span>, form<span class='op'>=</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>,
 data<span class='op'>=</span><span class='va'>COL.OLD</span>, dnb<span class='op'>=</span><span class='va'>dnb</span>, dists<span class='op'>=</span><span class='va'>dists</span>, verbose<span class='op'>=</span><span class='cn'>TRUE</span>, maximum<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>glst</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>dists</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>d</span><span class='op'>)</span> <span class='fl'>1</span><span class='op'>/</span><span class='op'>(</span><span class='va'>d</span><span class='op'>^</span><span class='va'>opt</span><span class='op'>$</span><span class='va'>maximum</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>lw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>dnb</span>, glist<span class='op'>=</span><span class='va'>glst</span>, style<span class='op'>=</span><span class='st'>"B"</span><span class='op'>)</span>
<span class='va'>SLX</span> <span class='op'>&lt;-</span> <span class='fu'>lmSLX</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, listw<span class='op'>=</span><span class='va'>lw</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>SLX</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>SLX</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>columbus</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"shapes/columbus.shp"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, quiet<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>col.gal.nb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='read.gal.html'>read.gal</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"weights/columbus.gal"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
<span class='co'># fit models for comparison</span>
<span class='va'>lm.mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>HOVAL</span> <span class='op'>+</span> <span class='va'>INC</span>, data<span class='op'>=</span><span class='va'>columbus</span><span class='op'>)</span>
<span class='va'>lag</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>HOVAL</span> <span class='op'>+</span> <span class='va'>INC</span>, data<span class='op'>=</span><span class='va'>columbus</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>col.gal.nb</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>mixed</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>HOVAL</span> <span class='op'>+</span> <span class='va'>INC</span>, data<span class='op'>=</span><span class='va'>columbus</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>col.gal.nb</span><span class='op'>)</span>,
  Durbin<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>error</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>HOVAL</span> <span class='op'>+</span> <span class='va'>INC</span>, data<span class='op'>=</span><span class='va'>columbus</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>col.gal.nb</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># compare nested models</span>
<span class='fu'>LR.sarlm</span><span class='op'>(</span><span class='va'>mixed</span>, <span class='va'>error</span><span class='op'>)</span>
<span class='co'>#anova(lag, lm.mod)</span>
<span class='co'>#anova(lag, error, mixed)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/AIC.html'>AIC</a></span><span class='op'>(</span><span class='va'>lag</span>, <span class='va'>error</span>, <span class='va'>mixed</span><span class='op'>)</span>
<span class='va'>columbus</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"shapes/columbus.shp"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, quiet<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>col.gal.nb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='read.gal.html'>read.gal</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"weights/columbus.gal"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>error.col</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>HOVAL</span> <span class='op'>+</span> <span class='va'>INC</span>, data<span class='op'>=</span><span class='va'>columbus</span>,
 <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>col.gal.nb</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>bptest.sarlm</span><span class='op'>(</span><span class='va'>error.col</span><span class='op'>)</span>
<span class='fu'>bptest.sarlm</span><span class='op'>(</span><span class='va'>error.col</span>, studentize<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>lm.target</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>error.col</span><span class='op'>$</span><span class='va'>tary</span> <span class='op'>~</span> <span class='va'>error.col</span><span class='op'>$</span><span class='va'>tarX</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'>lmtest</span><span class='op'>)</span> <span class='op'>&amp;&amp;</span> <span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://sandwich.R-Forge.R-project.org/'>sandwich</a></span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/lmtest/man/coeftest.html'>coeftest</a></span><span class='op'>(</span><span class='va'>lm.target</span>, vcov<span class='op'>=</span><span class='fu'><a href='https://sandwich.R-Forge.R-project.org//reference/vcovHC.html'>vcovHC</a></span><span class='op'>(</span><span class='va'>lm.target</span>, type<span class='op'>=</span><span class='st'>"HC0"</span><span class='op'>)</span>, df<span class='op'>=</span><span class='cn'>Inf</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>oldcol</span><span class='op'>)</span>
<span class='va'>lw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>
<span class='va'>ev</span> <span class='op'>&lt;-</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'>similar.listw</span><span class='op'>(</span><span class='va'>lw</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>COL.errW.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>lw</span>, quiet<span class='op'>=</span><span class='cn'>FALSE</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span><span class='op'>)</span>
<span class='va'>COL.errW.eig_ev</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>lw</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coefficients</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coefficients</a></span><span class='op'>(</span><span class='va'>COL.errW.eig_ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>COL.errB.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"B"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.errB.eig</span><span class='op'>)</span>
<span class='va'>W</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='va'>trMatc</span> <span class='op'>&lt;-</span> <span class='fu'>trW</span><span class='op'>(</span><span class='va'>W</span>, type<span class='op'>=</span><span class='st'>"mult"</span><span class='op'>)</span>
<span class='va'>COL.errW.M</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>lw</span>, method<span class='op'>=</span><span class='st'>"Matrix"</span>, quiet<span class='op'>=</span><span class='cn'>FALSE</span>, trs<span class='op'>=</span><span class='va'>trMatc</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.errW.M</span><span class='op'>)</span>
<span class='va'>COL.SDEM.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>lw</span>, etype<span class='op'>=</span><span class='st'>"emixed"</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.SDEM.eig</span><span class='op'>)</span>
<span class='va'>COL.SDEM.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>lw</span>, Durbin<span class='op'>=</span><span class='cn'>TRUE</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.SDEM.eig</span><span class='op'>)</span>
<span class='va'>COL.SDEM.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>DISCBD</span> <span class='op'>+</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>lw</span>, Durbin<span class='op'>=</span><span class='op'>~</span><span class='va'>INC</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.SDEM.eig</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.SDEM.eig</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>NA.COL.OLD</span> <span class='op'>&lt;-</span> <span class='va'>COL.OLD</span>
<span class='va'>NA.COL.OLD</span><span class='op'>$</span><span class='va'>CRIME</span><span class='op'>[</span><span class='fl'>20</span><span class='op'>:</span><span class='fl'>25</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
<span class='va'>COL.err.NA</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>NA.COL.OLD</span>,
 <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span>, na.action<span class='op'>=</span><span class='va'>na.exclude</span><span class='op'>)</span>
<span class='va'>COL.err.NA</span><span class='op'>$</span><span class='va'>na.action</span>
<span class='va'>COL.err.NA</span>
<span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>resid</a></span><span class='op'>(</span><span class='va'>COL.err.NA</span><span class='op'>)</span>
<span class='va'>lw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>ev</span> <span class='op'>&lt;-</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'>similar.listw</span><span class='op'>(</span><span class='va'>lw</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>lw</span>, method<span class='op'>=</span><span class='st'>"eigen"</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>ocoef</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coefficients</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>lw</span>, method<span class='op'>=</span><span class='st'>"eigen"</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig<span class='op'>=</span><span class='va'>ev</span>, LAPACK<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>ocoef</span>, <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coefficients</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>lw</span>, method<span class='op'>=</span><span class='st'>"eigen"</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig<span class='op'>=</span><span class='va'>ev</span>, compiled_sse<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>ocoef</span>, <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coefficients</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>lw</span>, method<span class='op'>=</span><span class='st'>"Matrix_J"</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>super<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>ocoef</span>, <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coefficients</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>lw</span>, method<span class='op'>=</span><span class='st'>"Matrix_J"</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>super<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>ocoef</span>, <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coefficients</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>lw</span>, method<span class='op'>=</span><span class='st'>"Matrix_J"</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>super<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/logical.html'>as.logical</a></span><span class='op'>(</span><span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>ocoef</span>, <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coefficients</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>lw</span>, method<span class='op'>=</span><span class='st'>"Matrix"</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>super<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>ocoef</span>, <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coefficients</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>lw</span>, method<span class='op'>=</span><span class='st'>"Matrix"</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>super<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>ocoef</span>, <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coefficients</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>lw</span>, method<span class='op'>=</span><span class='st'>"Matrix"</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>super<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/logical.html'>as.logical</a></span><span class='op'>(</span><span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>ocoef</span>, <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coefficients</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='st'><a href='https://www.math.uzh.ch/pages/spam/'>"spam"</a></span>, quietly<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>lw</span>, method<span class='op'>=</span><span class='st'>"spam"</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>spamPivot<span class='op'>=</span><span class='st'>"MMD"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>ocoef</span>, <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coefficients</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>lw</span>, method<span class='op'>=</span><span class='st'>"spam"</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>spamPivot<span class='op'>=</span><span class='st'>"RCM"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>ocoef</span>, <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coefficients</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>lw</span>, method<span class='op'>=</span><span class='st'>"spam_update"</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>spamPivot<span class='op'>=</span><span class='st'>"MMD"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>ocoef</span>, <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coefficients</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>lw</span>, method<span class='op'>=</span><span class='st'>"spam_update"</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>spamPivot<span class='op'>=</span><span class='st'>"RCM"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>ocoef</span>, <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coefficients</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>columbus</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"shapes/columbus.shp"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, quiet<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>col.gal.nb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='read.gal.html'>read.gal</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"weights/columbus.gal"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>listw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>col.gal.nb</span><span class='op'>)</span>
<span class='va'>ev</span> <span class='op'>&lt;-</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='va'>listw</span><span class='op'>)</span>
<span class='va'>lobj</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, <span class='va'>columbus</span>, <span class='va'>listw</span>,
 control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>lobj</span><span class='op'>)</span>
<span class='va'>mobj</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, <span class='va'>columbus</span>, <span class='va'>listw</span>, Durbin<span class='op'>=</span><span class='cn'>TRUE</span>,
 control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>mobj</span><span class='op'>)</span>
<span class='va'>mobj1</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, <span class='va'>columbus</span>, <span class='va'>listw</span>, Durbin<span class='op'>=</span> <span class='op'>~</span> <span class='va'>INC</span>,
 control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>mobj1</span><span class='op'>)</span>
<span class='va'>W</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>listw</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='va'>trMatc</span> <span class='op'>&lt;-</span> <span class='fu'>trW</span><span class='op'>(</span><span class='va'>W</span>, type<span class='op'>=</span><span class='st'>"mult"</span><span class='op'>)</span>
<span class='va'>trMC</span> <span class='op'>&lt;-</span> <span class='fu'>trW</span><span class='op'>(</span><span class='va'>W</span>, type<span class='op'>=</span><span class='st'>"MC"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'>impacts</span><span class='op'>(</span><span class='va'>lobj</span>, listw<span class='op'>=</span><span class='va'>listw</span><span class='op'>)</span>
<span class='fu'>impacts</span><span class='op'>(</span><span class='va'>lobj</span>, tr<span class='op'>=</span><span class='va'>trMatc</span><span class='op'>)</span>
<span class='fu'>impacts</span><span class='op'>(</span><span class='va'>lobj</span>, tr<span class='op'>=</span><span class='va'>trMC</span><span class='op'>)</span>
<span class='fu'>impacts</span><span class='op'>(</span><span class='va'>lobj</span>, evalues<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>coda</span><span class='op'>)</span>
<span class='va'>lobjIQ5</span> <span class='op'>&lt;-</span> <span class='fu'>impacts</span><span class='op'>(</span><span class='va'>lobj</span>, tr<span class='op'>=</span><span class='va'>trMatc</span>, R<span class='op'>=</span><span class='fl'>200</span>, Q<span class='op'>=</span><span class='fl'>5</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>lobjIQ5</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span>, short<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>lobjIQ5</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span>, short<span class='op'>=</span><span class='cn'>TRUE</span>, reportQ<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'>impacts</span><span class='op'>(</span><span class='va'>mobj</span>, listw<span class='op'>=</span><span class='va'>listw</span><span class='op'>)</span>
<span class='fu'>impacts</span><span class='op'>(</span><span class='va'>mobj</span>, tr<span class='op'>=</span><span class='va'>trMatc</span><span class='op'>)</span>
<span class='fu'>impacts</span><span class='op'>(</span><span class='va'>mobj</span>, tr<span class='op'>=</span><span class='va'>trMC</span><span class='op'>)</span>
<span class='fu'>impacts</span><span class='op'>(</span><span class='va'>mobj1</span>, tr<span class='op'>=</span><span class='va'>trMatc</span><span class='op'>)</span>
<span class='fu'>impacts</span><span class='op'>(</span><span class='va'>mobj1</span>, listw<span class='op'>=</span><span class='va'>listw</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/try.html'>try</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>mobj</span>, evalues<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span>, silent<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>, <span class='st'>"\n"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>mobj</span>, tr<span class='op'>=</span><span class='va'>trMatc</span>, R<span class='op'>=</span><span class='fl'>200</span><span class='op'>)</span>, short<span class='op'>=</span><span class='cn'>TRUE</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>mobj1</span>, tr<span class='op'>=</span><span class='va'>trMatc</span>, R<span class='op'>=</span><span class='fl'>200</span><span class='op'>)</span>, short<span class='op'>=</span><span class='cn'>TRUE</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='co'>#xobj &lt;- lmSLX(CRIME ~ INC + HOVAL, columbus, listw)</span>
<span class='co'>#summary(impacts(xobj))</span>
<span class='va'>eobj</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, <span class='va'>columbus</span>, <span class='va'>listw</span>, etype<span class='op'>=</span><span class='st'>"emixed"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>eobj</span><span class='op'>)</span>, adjust_k<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>mobj1</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, <span class='va'>columbus</span>, <span class='va'>listw</span>, type<span class='op'>=</span><span class='st'>"mixed"</span>, 
method<span class='op'>=</span><span class='st'>"Matrix"</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>fdHess<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>mobj1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>mobj1</span>, tr<span class='op'>=</span><span class='va'>trMatc</span>, R<span class='op'>=</span><span class='fl'>1000</span><span class='op'>)</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span>, short<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>mobj</span>, tr<span class='op'>=</span><span class='va'>trMatc</span>, R<span class='op'>=</span><span class='fl'>1000</span><span class='op'>)</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span>, short<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>mobj2</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, <span class='va'>columbus</span>, <span class='va'>listw</span>, type<span class='op'>=</span><span class='st'>"mixed"</span>, 
method<span class='op'>=</span><span class='st'>"Matrix"</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>fdHess<span class='op'>=</span><span class='cn'>TRUE</span>, optimHess<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>mobj2</span>, tr<span class='op'>=</span><span class='va'>trMatc</span>, R<span class='op'>=</span><span class='fl'>1000</span><span class='op'>)</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span>, short<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='st'><a href='https://www.math.uzh.ch/pages/spam/'>"spam"</a></span>, quietly<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>mobj3</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, <span class='va'>columbus</span>, <span class='va'>listw</span>, type<span class='op'>=</span><span class='st'>"mixed"</span>, 
method<span class='op'>=</span><span class='st'>"spam"</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>fdHess<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>mobj3</span>, tr<span class='op'>=</span><span class='va'>trMatc</span>, R<span class='op'>=</span><span class='fl'>1000</span><span class='op'>)</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span>, short<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>boston</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span>
<span class='va'>Wb</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>boston.soi</span><span class='op'>)</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='va'>trMatb</span> <span class='op'>&lt;-</span> <span class='fu'>trW</span><span class='op'>(</span><span class='va'>Wb</span>, type<span class='op'>=</span><span class='st'>"mult"</span><span class='op'>)</span>
<span class='va'>gp2mMi</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>CMEDV</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>CRIM</span> <span class='op'>+</span> <span class='va'>ZN</span> <span class='op'>+</span> <span class='va'>INDUS</span> <span class='op'>+</span> <span class='va'>CHAS</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>NOX</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span> 
<span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>RM</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span>  <span class='va'>AGE</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>DIS</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>RAD</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>TAX</span> <span class='op'>+</span> <span class='va'>PTRATIO</span> <span class='op'>+</span> <span class='va'>B</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>LSTAT</span><span class='op'>)</span>, 
data<span class='op'>=</span><span class='va'>boston.c</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>boston.soi</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"mixed"</span>, method<span class='op'>=</span><span class='st'>"Matrix"</span>, 
control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>fdHess<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>, trs<span class='op'>=</span><span class='va'>trMatb</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>gp2mMi</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>gp2mMi</span>, tr<span class='op'>=</span><span class='va'>trMatb</span>, R<span class='op'>=</span><span class='fl'>1000</span><span class='op'>)</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span>, short<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='co'>#data(house, package="spData")</span>
<span class='co'>#lw &lt;- nb2listw(LO_nb)</span>
<span class='co'>#form &lt;- formula(log(price) ~ age + I(age^2) + I(age^3) + log(lotsize) +</span>
<span class='co'>#   rooms + log(TLA) + beds + syear)</span>
<span class='co'>#lobj &lt;- lagsarlm(form, house, lw, method="Matrix",</span>
<span class='co'># control=list(fdHess=TRUE), trs=trMat)</span>
<span class='co'>#summary(lobj)</span>
<span class='co'>#loobj &lt;- impacts(lobj, tr=trMat, R=1000)</span>
<span class='co'>#summary(loobj, zstats=TRUE, short=TRUE)</span>
<span class='co'>#lobj1 &lt;- stsls(form, house, lw)</span>
<span class='co'>#loobj1 &lt;- impacts(lobj1, tr=trMat, R=1000)</span>
<span class='co'>#summary(loobj1, zstats=TRUE, short=TRUE)</span>
<span class='co'>#mobj &lt;- lagsarlm(form, house, lw, type="mixed",</span>
<span class='co'># method="Matrix", control=list(fdHess=TRUE), trs=trMat)</span>
<span class='co'>#summary(mobj)</span>
<span class='co'>#moobj &lt;- impacts(mobj, tr=trMat, R=1000)</span>
<span class='co'>#summary(moobj, zstats=TRUE, short=TRUE)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>oldcol</span><span class='op'>)</span>
<span class='va'>listw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>
<span class='va'>ev</span> <span class='op'>&lt;-</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='va'>listw</span><span class='op'>)</span>
<span class='va'>W</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>listw</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='va'>trMatc</span> <span class='op'>&lt;-</span> <span class='fu'>trW</span><span class='op'>(</span><span class='va'>W</span>, type<span class='op'>=</span><span class='st'>"mult"</span><span class='op'>)</span>
<span class='va'>COL.lag.eig</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, listw<span class='op'>=</span><span class='va'>listw</span>,
 method<span class='op'>=</span><span class='st'>"eigen"</span>, quiet<span class='op'>=</span><span class='cn'>FALSE</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig<span class='op'>=</span><span class='va'>ev</span>, OrdVsign<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.lag.eig</span>, correlation<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>COL.lag.eig</span><span class='op'>$</span><span class='va'>fdHess</span>
<span class='va'>COL.lag.eig</span><span class='op'>$</span><span class='va'>resvar</span>
<span class='co'># using the apparent sign in Ord (1975, equation B.1) </span>
<span class='va'>COL.lag.eigb</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, listw<span class='op'>=</span><span class='va'>listw</span>,
 method<span class='op'>=</span><span class='st'>"eigen"</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig<span class='op'>=</span><span class='va'>ev</span>, OrdVsign<span class='op'>=</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.lag.eigb</span><span class='op'>)</span>
<span class='va'>COL.lag.eigb</span><span class='op'>$</span><span class='va'>fdHess</span>
<span class='va'>COL.lag.eigb</span><span class='op'>$</span><span class='va'>resvar</span>
<span class='co'># force numerical Hessian</span>
<span class='va'>COL.lag.eig1</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 listw<span class='op'>=</span><span class='va'>listw</span>, method<span class='op'>=</span><span class='st'>"Matrix"</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>small<span class='op'>=</span><span class='fl'>25</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.lag.eig1</span><span class='op'>)</span>
<span class='va'>COL.lag.eig1</span><span class='op'>$</span><span class='va'>fdHess</span>
<span class='co'># force LeSage &amp; Pace (2008, p. 57) approximation </span>
<span class='va'>COL.lag.eig1a</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 listw<span class='op'>=</span><span class='va'>listw</span>, method<span class='op'>=</span><span class='st'>"Matrix"</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>small<span class='op'>=</span><span class='fl'>25</span><span class='op'>)</span>, trs<span class='op'>=</span><span class='va'>trMatc</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.lag.eig1a</span><span class='op'>)</span>
<span class='va'>COL.lag.eig1a</span><span class='op'>$</span><span class='va'>fdHess</span>
<span class='va'>COL.lag.eig</span><span class='op'>$</span><span class='va'>resvar</span><span class='op'>[</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>]</span>
<span class='co'># using the apparent sign in Ord (1975, equation B.1) </span>
<span class='va'>COL.lag.eigb</span><span class='op'>$</span><span class='va'>resvar</span><span class='op'>[</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>]</span>
<span class='co'># force numerical Hessian</span>
<span class='va'>COL.lag.eig1</span><span class='op'>$</span><span class='va'>fdHess</span><span class='op'>[</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>]</span>
<span class='co'># force LeSage &amp; Pace (2008, p. 57) approximation </span>
<span class='va'>COL.lag.eig1a</span><span class='op'>$</span><span class='va'>fdHess</span><span class='op'>[</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>COL.lag.M</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span>, method<span class='op'>=</span><span class='st'>"Matrix"</span>, quiet<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.lag.M</span><span class='op'>)</span>
<span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.lag.M</span>, listw<span class='op'>=</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span><span class='op'>)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='st'><a href='https://www.math.uzh.ch/pages/spam/'>"spam"</a></span>, quietly<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>COL.lag.sp</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span>, method<span class='op'>=</span><span class='st'>"spam"</span>, quiet<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.lag.sp</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>COL.lag.B</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"B"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.lag.B</span><span class='op'>)</span>
<span class='va'>COL.mixed.B</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"B"</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"mixed"</span>, tol.solve<span class='op'>=</span><span class='fl'>1e-9</span>,
 control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.mixed.B</span><span class='op'>)</span>
<span class='va'>COL.mixed.W</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>listw</span>, type<span class='op'>=</span><span class='st'>"mixed"</span>,
 control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.mixed.W</span><span class='op'>)</span>
<span class='va'>COL.mixed.D00</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>listw</span>, Durbin<span class='op'>=</span><span class='cn'>TRUE</span>,
 control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.mixed.D00</span><span class='op'>)</span>
<span class='va'>COL.mixed.D01</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>listw</span>, Durbin<span class='op'>=</span><span class='cn'>FALSE</span>,
 control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.mixed.D01</span><span class='op'>)</span>
<span class='va'>COL.mixed.D1</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>listw</span>, Durbin<span class='op'>=</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>,
 control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.mixed.D1</span><span class='op'>)</span>
<span class='va'>f</span> <span class='op'>&lt;-</span> <span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>
<span class='va'>COL.mixed.D2</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>f</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, <span class='va'>listw</span>,
 Durbin<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/formula.html'>as.formula</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/delete.response.html'>delete.response</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/terms.html'>terms</a></span><span class='op'>(</span><span class='va'>f</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,
 control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.mixed.D2</span><span class='op'>)</span>
<span class='va'>COL.mixed.D1a</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>listw</span>, Durbin<span class='op'>=</span> <span class='op'>~</span> <span class='va'>INC</span>,
 control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.mixed.D1a</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/try.html'>try</a></span><span class='op'>(</span><span class='va'>COL.mixed.D1</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>listw</span>, Durbin<span class='op'>=</span> <span class='op'>~</span> <span class='va'>inc</span> <span class='op'>+</span> <span class='va'>HOVAL</span>,
 control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/try.html'>try</a></span><span class='op'>(</span><span class='va'>COL.mixed.D1</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='va'>listw</span>, Durbin<span class='op'>=</span> <span class='op'>~</span> <span class='va'>DISCBD</span> <span class='op'>+</span> <span class='va'>HOVAL</span>,
 control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>NA.COL.OLD</span> <span class='op'>&lt;-</span> <span class='va'>COL.OLD</span>
<span class='va'>NA.COL.OLD</span><span class='op'>$</span><span class='va'>CRIME</span><span class='op'>[</span><span class='fl'>20</span><span class='op'>:</span><span class='fl'>25</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
<span class='va'>COL.lag.NA</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>NA.COL.OLD</span>,
 <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span>, na.action<span class='op'>=</span><span class='va'>na.exclude</span>, 
 control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>tol.opt<span class='op'>=</span><span class='va'>.Machine</span><span class='op'>$</span><span class='va'>double.eps</span><span class='op'>^</span><span class='fl'>0.4</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>COL.lag.NA</span><span class='op'>$</span><span class='va'>na.action</span>
<span class='va'>COL.lag.NA</span>
<span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>resid</a></span><span class='op'>(</span><span class='va'>COL.lag.NA</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>boston</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span>
<span class='va'>gp2mM</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>CMEDV</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>CRIM</span> <span class='op'>+</span> <span class='va'>ZN</span> <span class='op'>+</span> <span class='va'>INDUS</span> <span class='op'>+</span> <span class='va'>CHAS</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>NOX</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span> 
<span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>RM</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span>  <span class='va'>AGE</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>DIS</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>RAD</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>TAX</span> <span class='op'>+</span> <span class='va'>PTRATIO</span> <span class='op'>+</span> <span class='va'>B</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>LSTAT</span><span class='op'>)</span>, 
data<span class='op'>=</span><span class='va'>boston.c</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>boston.soi</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"mixed"</span>, method<span class='op'>=</span><span class='st'>"Matrix"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>gp2mM</span><span class='op'>)</span>
<span class='va'>W</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>boston.soi</span><span class='op'>)</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='va'>trMatb</span> <span class='op'>&lt;-</span> <span class='fu'>trW</span><span class='op'>(</span><span class='va'>W</span>, type<span class='op'>=</span><span class='st'>"mult"</span><span class='op'>)</span>
<span class='va'>gp2mMi</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>CMEDV</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>CRIM</span> <span class='op'>+</span> <span class='va'>ZN</span> <span class='op'>+</span> <span class='va'>INDUS</span> <span class='op'>+</span> <span class='va'>CHAS</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>NOX</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span> 
<span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>RM</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span>  <span class='va'>AGE</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>DIS</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>RAD</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>TAX</span> <span class='op'>+</span> <span class='va'>PTRATIO</span> <span class='op'>+</span> <span class='va'>B</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>LSTAT</span><span class='op'>)</span>, 
data<span class='op'>=</span><span class='va'>boston.c</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>boston.soi</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"mixed"</span>, method<span class='op'>=</span><span class='st'>"Matrix"</span>, 
trs<span class='op'>=</span><span class='va'>trMatb</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>gp2mMi</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>oldcol</span><span class='op'>)</span>
<span class='va'>lw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span>
<span class='va'>COL.lag.eig</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, <span class='va'>lw</span><span class='op'>)</span>

<span class='va'>COL.mix.eig</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, <span class='va'>lw</span>,
  type<span class='op'>=</span><span class='st'>"mixed"</span><span class='op'>)</span>
<span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/print.html'>print</a></span><span class='op'>(</span><span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>COL.mix.eig</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>#print(p2 &lt;- predict(COL.mix.eig, newdata=COL.OLD, listw=lw, pred.type = "TS",</span>
<span class='co'># legacy.mixed = TRUE))</span>
<span class='fu'><a href='https://rdrr.io/r/stats/AIC.html'>AIC</a></span><span class='op'>(</span><span class='va'>COL.mix.eig</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/deviance.html'>deviance</a></span><span class='op'>(</span><span class='va'>COL.mix.eig</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>COL.OLD</span><span class='op'>$</span><span class='va'>CRIME</span> <span class='op'>-</span> <span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/Coercion.html'>as.vector</a></span><span class='op'>(</span><span class='va'>p1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>#sqrt(sum((COL.OLD$CRIME - as.vector(p2))^2)/length(COL.nb))</span>

<span class='va'>COL.err.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, <span class='va'>lw</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/AIC.html'>AIC</a></span><span class='op'>(</span><span class='va'>COL.err.eig</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/deviance.html'>deviance</a></span><span class='op'>(</span><span class='va'>COL.err.eig</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>COL.OLD</span><span class='op'>$</span><span class='va'>CRIME</span> <span class='op'>-</span> <span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/Coercion.html'>as.vector</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>COL.err.eig</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>#sqrt(sum((COL.OLD$CRIME - as.vector(predict(COL.err.eig, newdata=COL.OLD,</span>
<span class='co'>#  listw=lw, pred.type = "TS")))^2)/length(COL.nb))</span>

<span class='va'>COL.SDerr.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, <span class='va'>lw</span>,
 etype<span class='op'>=</span><span class='st'>"emixed"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/AIC.html'>AIC</a></span><span class='op'>(</span><span class='va'>COL.SDerr.eig</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/deviance.html'>deviance</a></span><span class='op'>(</span><span class='va'>COL.SDerr.eig</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>COL.OLD</span><span class='op'>$</span><span class='va'>CRIME</span> <span class='op'>-</span> <span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/Coercion.html'>as.vector</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>COL.SDerr.eig</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>#sqrt(sum((COL.OLD$CRIME - as.vector(predict(COL.SDerr.eig, newdata=COL.OLD,</span>
<span class='co'>#  listw=lw, pred.type = "TS")))^2)/length(COL.nb))</span>

<span class='fu'><a href='https://rdrr.io/r/stats/AIC.html'>AIC</a></span><span class='op'>(</span><span class='va'>COL.lag.eig</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/deviance.html'>deviance</a></span><span class='op'>(</span><span class='va'>COL.lag.eig</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>COL.OLD</span><span class='op'>$</span><span class='va'>CRIME</span> <span class='op'>-</span> <span class='fu'><a href='https://www.math.uzh.ch/pages/spam//reference/Coercion.html'>as.vector</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>COL.lag.eig</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>#sqrt(sum((COL.OLD$CRIME - as.vector(predict(COL.lag.eig, newdata=COL.OLD,</span>
<span class='co'>#  listw=lw, pred.type = "TS")))^2)/length(COL.nb))</span>

<span class='co'>#p3 &lt;- predict(COL.mix.eig, newdata=COL.OLD, listw=lw, pred.type = "TS",</span>
<span class='co'># legacy=FALSE, legacy.mixed = TRUE)</span>
<span class='co'>#all.equal(p2, p3, check.attributes=FALSE)</span>
<span class='co'>#p4 &lt;- predict(COL.mix.eig, newdata=COL.OLD, listw=lw, pred.type = "TS",</span>
<span class='co'># legacy=FALSE, power=TRUE, legacy.mixed = TRUE)</span>
<span class='co'>#all.equal(p2, p4, check.attributes=FALSE)</span>
<span class='co'>#p5 &lt;- predict(COL.mix.eig, newdata=COL.OLD, listw=lw, pred.type = "TS",</span>
<span class='co'># legacy=TRUE, power=TRUE, legacy.mixed = TRUE)</span>
<span class='co'>#all.equal(p2, p5, check.attributes=FALSE)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>oldcol</span><span class='op'>)</span>
<span class='va'>listw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>
<span class='va'>ev</span> <span class='op'>&lt;-</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='va'>listw</span><span class='op'>)</span>
<span class='va'>COL.sacW.eig</span> <span class='op'>&lt;-</span> <span class='fu'>sacsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, <span class='va'>listw</span>,
 control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig1<span class='op'>=</span><span class='va'>ev</span>, pre_eig2<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.sacW.eig</span><span class='op'>)</span>
<span class='va'>W</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>listw</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='va'>trMatc</span> <span class='op'>&lt;-</span> <span class='fu'>trW</span><span class='op'>(</span><span class='va'>W</span>, type<span class='op'>=</span><span class='st'>"mult"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.sacW.eig</span>, tr<span class='op'>=</span><span class='va'>trMatc</span>, R<span class='op'>=</span><span class='fl'>2000</span><span class='op'>)</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span>, short<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>COL.msacW.eig</span> <span class='op'>&lt;-</span> <span class='fu'>sacsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, <span class='va'>listw</span>,
 type<span class='op'>=</span><span class='st'>"sacmixed"</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig1<span class='op'>=</span><span class='va'>ev</span>, pre_eig2<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.msacW.eig</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.msacW.eig</span>, tr<span class='op'>=</span><span class='va'>trMatc</span>, R<span class='op'>=</span><span class='fl'>2000</span><span class='op'>)</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span>, short<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>COL.msacW1.eig</span> <span class='op'>&lt;-</span> <span class='fu'>sacsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, <span class='va'>listw</span>,
 Durbin<span class='op'>=</span><span class='cn'>TRUE</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig1<span class='op'>=</span><span class='va'>ev</span>, pre_eig2<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.msacW1.eig</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.msacW1.eig</span>, tr<span class='op'>=</span><span class='va'>trMatc</span>, R<span class='op'>=</span><span class='fl'>2000</span><span class='op'>)</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span>, short<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>COL.msacW2.eig</span> <span class='op'>&lt;-</span> <span class='fu'>sacsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>DISCBD</span> <span class='op'>+</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>, 
 <span class='va'>listw</span>, Durbin<span class='op'>=</span> <span class='op'>~</span> <span class='va'>INC</span>, control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pre_eig1<span class='op'>=</span><span class='va'>ev</span>, pre_eig2<span class='op'>=</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.msacW2.eig</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>impacts</span><span class='op'>(</span><span class='va'>COL.msacW2.eig</span>, tr<span class='op'>=</span><span class='va'>trMatc</span>, R<span class='op'>=</span><span class='fl'>2000</span><span class='op'>)</span>, zstats<span class='op'>=</span><span class='cn'>TRUE</span>, short<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>oldcol</span><span class='op'>)</span>
<span class='va'>COL.mix.eig</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"mixed"</span>, method<span class='op'>=</span><span class='st'>"eigen"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.mix.eig</span>, correlation<span class='op'>=</span><span class='cn'>TRUE</span>, Nagelkerke<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>COL.mix.M</span> <span class='op'>&lt;-</span> <span class='fu'>lagsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"mixed"</span>, method<span class='op'>=</span><span class='st'>"Matrix"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.mix.M</span>, correlation<span class='op'>=</span><span class='cn'>TRUE</span>, Nagelkerke<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>COL.errW.eig</span> <span class='op'>&lt;-</span> <span class='fu'>errorsarlm</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
  <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>, method<span class='op'>=</span><span class='st'>"eigen"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span>, correlation<span class='op'>=</span><span class='cn'>TRUE</span>, Nagelkerke<span class='op'>=</span><span class='cn'>TRUE</span>, Hausman<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>columbus</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"shapes/columbus.shp"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, quiet<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>col.gal.nb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='read.gal.html'>read.gal</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"weights/columbus.gal"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>listw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>col.gal.nb</span><span class='op'>)</span>
<span class='va'>W</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>listw</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>trMat</span> <span class='op'>&lt;-</span> <span class='fu'>trW</span><span class='op'>(</span><span class='va'>W</span>, type<span class='op'>=</span><span class='st'>"mult"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>trMat</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1100</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>trMC</span> <span class='op'>&lt;-</span> <span class='fu'>trW</span><span class='op'>(</span><span class='va'>W</span>, type<span class='op'>=</span><span class='st'>"MC"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>trMC</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>trMat</span>, <span class='va'>trMC</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>0</span>, b<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>3</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>trMC</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
 <span class='fu'><a href='https://rdrr.io/r/graphics/segments.html'>segments</a></span><span class='op'>(</span><span class='va'>trMat</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, <span class='va'>trMC</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>-</span><span class='fl'>2</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span><span class='op'>(</span><span class='va'>trMC</span>, <span class='st'>"sd"</span><span class='op'>)</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, <span class='va'>trMat</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>,
  <span class='va'>trMC</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>+</span><span class='fl'>2</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span><span class='op'>(</span><span class='va'>trMC</span>, <span class='st'>"sd"</span><span class='op'>)</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>listwS</span> <span class='op'>&lt;-</span> <span class='fu'>similar.listw</span><span class='op'>(</span><span class='va'>listw</span><span class='op'>)</span>
<span class='va'>W</span> <span class='op'>&lt;-</span> <span class='fu'>Matrix</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/Matrix/man/forceSymmetric.html'>forceSymmetric</a></span><span class='op'>(</span><span class='fu'>as</span><span class='op'>(</span><span class='va'>listwS</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>trmom</span> <span class='op'>&lt;-</span> <span class='fu'>trW</span><span class='op'>(</span><span class='va'>W</span>, m<span class='op'>=</span><span class='fl'>24</span>, type<span class='op'>=</span><span class='st'>"moments"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>trmom</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>trMat</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>24</span><span class='op'>]</span>, <span class='va'>trmom</span>, check.attributes<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>trMat</span> <span class='op'>&lt;-</span> <span class='fu'>trW</span><span class='op'>(</span><span class='va'>W</span>, m<span class='op'>=</span><span class='fl'>24</span>, type<span class='op'>=</span><span class='st'>"mult"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>trMat</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>trMat</span>, <span class='va'>trmom</span>, check.attributes<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>trMC</span> <span class='op'>&lt;-</span> <span class='fu'>trW</span><span class='op'>(</span><span class='va'>W</span>, m<span class='op'>=</span><span class='fl'>24</span>, type<span class='op'>=</span><span class='st'>"MC"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>trMC</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>boston</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span>
<span class='va'>listw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>boston.soi</span><span class='op'>)</span>
<span class='va'>listwS</span> <span class='op'>&lt;-</span> <span class='fu'>similar.listw</span><span class='op'>(</span><span class='va'>listw</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>trmom</span> <span class='op'>&lt;-</span> <span class='fu'>trW</span><span class='op'>(</span>listw<span class='op'>=</span><span class='va'>listwS</span>, m<span class='op'>=</span><span class='fl'>24</span>, type<span class='op'>=</span><span class='st'>"moments"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>trmom</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>parallel</span><span class='op'>)</span>
<span class='va'>nc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/parallel/detectCores.html'>detectCores</a></span><span class='op'>(</span>logical<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='co'># set nc to 1L here</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='va'>nc</span> <span class='op'>&gt;</span> <span class='fl'>1L</span><span class='op'>)</span> <span class='va'>nc</span> <span class='op'>&lt;-</span> <span class='fl'>1L</span>
<span class='va'>coresOpt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='set.mcOption.html'>get.coresOption</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/invisible.html'>invisible</a></span><span class='op'>(</span><span class='fu'><a href='set.mcOption.html'>set.coresOption</a></span><span class='op'>(</span><span class='va'>nc</span><span class='op'>)</span><span class='op'>)</span>
<span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='set.mcOption.html'>get.mcOption</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>cl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></span><span class='op'>(</span><span class='fu'><a href='set.mcOption.html'>get.coresOption</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
  <span class='fu'><a href='set.mcOption.html'>set.ClusterOption</a></span><span class='op'>(</span><span class='va'>cl</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='op'>}</span> <span class='co'>#dontrun</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Roger Bivand.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


