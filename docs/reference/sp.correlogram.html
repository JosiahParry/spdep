<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Spatial correlogram — sp.correlogram • spdep</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Spatial correlogram — sp.correlogram" />

<meta property="og:description" content="Spatial correlograms for Moran's I and the autocorrelation coefficient, with
print and plot helper functions." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spdep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/CO69.html">“The Problem of Spatial Autocorrelation:” forty years on</a>
    </li>
    <li>
      <a href="../articles/nb_igraph.html">Spatial weights objects as sparse matrices and graphs</a>
    </li>
    <li>
      <a href="../articles/nb_sf.html">Creating Neighbours using sf objects</a>
    </li>
    <li>
      <a href="../articles/sids.html">Introduction to the North Carolina SIDS data set (re-revised)</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-spatial/spdep">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Spatial correlogram</h1>
    
    <div class="hidden name"><code>sp.correlogram.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Spatial correlograms for Moran's I and the autocorrelation coefficient, with
print and plot helper functions.</p>
    
    </div>

    <pre class="usage"><span class='fu'>sp.correlogram</span>(<span class='no'>neighbours</span>, <span class='no'>var</span>, <span class='kw'>order</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"corr"</span>,
 <span class='kw'>style</span> <span class='kw'>=</span> <span class='st'>"W"</span>, <span class='kw'>randomisation</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>zero.policy</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>spChk</span><span class='kw'>=</span><span class='kw'>NULL</span>)
<span class='co'># S3 method for spcor</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>x</span>, <span class='no'>main</span>, <span class='no'>ylab</span>, <span class='no'>ylim</span>, <span class='no'>...</span>)
<span class='co'># S3 method for spcor</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>x</span>, <span class='kw'>p.adj.method</span><span class='kw'>=</span><span class='st'>"none"</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>neighbours</th>
      <td><p>an object of class <code>nb</code></p></td>
    </tr>
    <tr>
      <th>var</th>
      <td><p>a numeric vector</p></td>
    </tr>
    <tr>
      <th>order</th>
      <td><p>maximum lag order</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>"corr" for correlation, "I" for Moran's I, "C" for Geary's C</p></td>
    </tr>
    <tr>
      <th>style</th>
      <td><p><code>style</code> can take values W, B, C, and S</p></td>
    </tr>
    <tr>
      <th>randomisation</th>
      <td><p>variance of I or C calculated under the assumption of randomisation, if FALSE normality</p></td>
    </tr>
    <tr>
      <th>zero.policy</th>
      <td><p>default NULL, use global option value; if FALSE stop with error for any empty neighbour sets, 
if TRUE permit the weights list to be formed with zero-length weights vectors</p></td>
    </tr>
    <tr>
      <th>spChk</th>
      <td><p>should the data vector names be checked against the spatial objects for identity integrity, TRUE, or FALSE, default NULL to use <code><a href='set.spChkOption.html'>get.spChkOption()</a></code></p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>an object from <code>sp.correlogram()</code> of class <code>spcor</code></p></td>
    </tr>
    <tr>
      <th>p.adj.method</th>
      <td><p>correction method as in <code>p.adjust</code></p></td>
    </tr>
    <tr>
      <th>main</th>
      <td><p>an overall title for the plot</p></td>
    </tr>
    <tr>
      <th>ylab</th>
      <td><p>a title for the y axis</p></td>
    </tr>
    <tr>
      <th>ylim</th>
      <td><p>the y limits of the plot</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>further arguments passed through</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The print function also calculates the standard deviates of Moran's I or Geary's C and a two-sided probability value, optionally using <code>p.adjust</code> to correct by the nymber of lags. The plot function plots a bar from the estimated Moran's I, or Geary's C value to +/- twice the square root of its variance (in previous releases only once, not twice). The table includes the count of included observations in brackets after the lag order. Care needs to be shown when interpreting results for few remaining included observations as lag order increases.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>returns a list of class <code>spcor</code>:</p>
<dt>res</dt><dd><p>for "corr" a vector of values; for "I", a matrix of estimates of "I", expectations, and variances</p></dd>
  <dt>method</dt><dd><p>"I" or "corr"</p></dd>
  <dt>cardnos</dt><dd><p>list of tables of neighbour cardinalities for the lag orders used</p></dd>
  <dt>var</dt><dd><p>variable name</p></dd>

    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Cliff, A. D., Ord, J. K. 1981 <em>Spatial processes</em>, Pion, pp. 
118--122, Martin, R. L., Oeppen, J. E. 1975 The identification of regional
forecasting models using space-time correlation functions, <em>Transactions
of the Institute of British Geographers</em>, 66, 95--118.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='nblag.html'>nblag</a></code>, <code><a href='moran.html'>moran</a></code>, <code><a href='https://www.rdocumentation.org/packages/stats/topics/p.adjust'>p.adjust</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>nc.sids</span> <span class='kw'>&lt;-</span> <span class='fu'>st_read</span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"shapes/sids.shp"</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"spData"</span>)[<span class='fl'>1</span>], <span class='kw'>quiet</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>rn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/character'>as.character</a></span>(<span class='no'>nc.sids</span>$<span class='no'>FIPS</span>)
<span class='no'>ncCC89_nb</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='read.gal.html'>read.gal</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"weights/ncCC89.gal"</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"spData"</span>)[<span class='fl'>1</span>],
 <span class='kw'>region.id</span><span class='kw'>=</span><span class='no'>rn</span>)
<span class='no'>ft.SID74</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/MathFun'>sqrt</a></span>(<span class='fl'>1000</span>)*(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/MathFun'>sqrt</a></span>(<span class='no'>nc.sids</span>$<span class='no'>SID74</span>/<span class='no'>nc.sids</span>$<span class='no'>BIR74</span>) +
  <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/MathFun'>sqrt</a></span>((<span class='no'>nc.sids</span>$<span class='no'>SID74</span>+<span class='fl'>1</span>)/<span class='no'>nc.sids</span>$<span class='no'>BIR74</span>))
<span class='no'>tr.SIDS74</span> <span class='kw'>&lt;-</span> <span class='no'>ft.SID74</span>*<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/MathFun'>sqrt</a></span>(<span class='no'>nc.sids</span>$<span class='no'>BIR74</span>)
<span class='no'>cspc</span> <span class='kw'>&lt;-</span> <span class='fu'>sp.correlogram</span>(<span class='no'>ncCC89_nb</span>, <span class='no'>tr.SIDS74</span>, <span class='kw'>order</span><span class='kw'>=</span><span class='fl'>8</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"corr"</span>,
 <span class='kw'>zero.policy</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>cspc</span>)</div><div class='output co'>#&gt; Spatial correlogram for tr.SIDS74 
#&gt; method: Spatial autocorrelation
#&gt;           1           2           3           4           5           6 
#&gt;  0.38193491  0.47679881  0.11740653  0.09935901  0.27819159  0.30153012 
#&gt;           7           8 
#&gt; -0.05150923  0.05283813 </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>cspc</span>)</div><div class='img'><img src='sp.correlogram-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>Ispc</span> <span class='kw'>&lt;-</span> <span class='fu'>sp.correlogram</span>(<span class='no'>ncCC89_nb</span>, <span class='no'>tr.SIDS74</span>, <span class='kw'>order</span><span class='kw'>=</span><span class='fl'>8</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"I"</span>,
 <span class='kw'>zero.policy</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>Ispc</span>)</div><div class='output co'>#&gt; Spatial correlogram for tr.SIDS74 
#&gt; method: Moran's I
#&gt;          estimate expectation   variance standard deviate Pr(I) two sided    
#&gt; 1 (98)  0.2311685  -0.0103093  0.0055378           3.2450       0.0011747 ** 
#&gt; 2 (98)  0.2246930  -0.0103093  0.0037817           3.8214       0.0001327 ***
#&gt; 3 (98)  0.0193576  -0.0103093  0.0029386           0.5473       0.5841914    
#&gt; 4 (98)  0.0042255  -0.0103093  0.0024974           0.2908       0.7711687    
#&gt; 5 (98)  0.0875548  -0.0103093  0.0022875           2.0462       0.0407386 *  
#&gt; 6 (98)  0.0758362  -0.0103093  0.0021583           1.8543       0.0637011 .  
#&gt; 7 (98) -0.0752243  -0.0103093  0.0022282          -1.3752       0.1690654    
#&gt; 8 (98) -0.0261063  -0.0103093  0.0025211          -0.3146       0.7530514    
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>Ispc</span>, <span class='st'>"bonferroni"</span>)</div><div class='output co'>#&gt; Spatial correlogram for tr.SIDS74 
#&gt; method: Moran's I
#&gt;          estimate expectation   variance standard deviate Pr(I) two sided   
#&gt; 1 (98)  0.2311685  -0.0103093  0.0055378           3.2450        0.009397 **
#&gt; 2 (98)  0.2246930  -0.0103093  0.0037817           3.8214        0.001061 **
#&gt; 3 (98)  0.0193576  -0.0103093  0.0029386           0.5473        1.000000   
#&gt; 4 (98)  0.0042255  -0.0103093  0.0024974           0.2908        1.000000   
#&gt; 5 (98)  0.0875548  -0.0103093  0.0022875           2.0462        0.325909   
#&gt; 6 (98)  0.0758362  -0.0103093  0.0021583           1.8543        0.509609   
#&gt; 7 (98) -0.0752243  -0.0103093  0.0022282          -1.3752        1.000000   
#&gt; 8 (98) -0.0261063  -0.0103093  0.0025211          -0.3146        1.000000   
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>Ispc</span>)</div><div class='img'><img src='sp.correlogram-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>Cspc</span> <span class='kw'>&lt;-</span> <span class='fu'>sp.correlogram</span>(<span class='no'>ncCC89_nb</span>, <span class='no'>tr.SIDS74</span>, <span class='kw'>order</span><span class='kw'>=</span><span class='fl'>8</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"C"</span>,
 <span class='kw'>zero.policy</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>Cspc</span>)</div><div class='output co'>#&gt; Spatial correlogram for tr.SIDS74 
#&gt; method: Geary's C
#&gt;         estimate expectation  variance standard deviate Pr(I) two sided    
#&gt; 1 (98) 0.7172624   1.0000000 0.0059986          -3.6506       0.0002617 ***
#&gt; 2 (98) 0.6817819   1.0000000 0.0046785          -4.6523       3.282e-06 ***
#&gt; 3 (98) 0.9470179   1.0000000 0.0044311          -0.7959       0.4260762    
#&gt; 4 (98) 1.0016202   1.0000000 0.0041985           0.0250       0.9800516    
#&gt; 5 (98) 0.8977501   1.0000000 0.0038054          -1.6575       0.0974119 .  
#&gt; 6 (98) 0.9173310   1.0000000 0.0036428          -1.3697       0.1707819    
#&gt; 7 (98) 1.0527148   1.0000000 0.0037227           0.8640       0.3875979    
#&gt; 8 (98) 1.0067939   1.0000000 0.0036482           0.1125       0.9104415    
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>Cspc</span>, <span class='st'>"bonferroni"</span>)</div><div class='output co'>#&gt; Spatial correlogram for tr.SIDS74 
#&gt; method: Geary's C
#&gt;         estimate expectation  variance standard deviate Pr(I) two sided    
#&gt; 1 (98) 0.7172624   1.0000000 0.0059986          -3.6506        0.002093 ** 
#&gt; 2 (98) 0.6817819   1.0000000 0.0046785          -4.6523       2.626e-05 ***
#&gt; 3 (98) 0.9470179   1.0000000 0.0044311          -0.7959        1.000000    
#&gt; 4 (98) 1.0016202   1.0000000 0.0041985           0.0250        1.000000    
#&gt; 5 (98) 0.8977501   1.0000000 0.0038054          -1.6575        0.779295    
#&gt; 6 (98) 0.9173310   1.0000000 0.0036428          -1.3697        1.000000    
#&gt; 7 (98) 1.0527148   1.0000000 0.0037227           0.8640        1.000000    
#&gt; 8 (98) 1.0067939   1.0000000 0.0036482           0.1125        1.000000    
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>Cspc</span>)</div><div class='img'><img src='sp.correlogram-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>drop.no.neighs</span> <span class='kw'>&lt;-</span> !(<span class='fl'>1</span>:<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/length'>length</a></span>(<span class='no'>ncCC89_nb</span>) <span class='kw'>%in%</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/which'>which</a></span>(<span class='fu'><a href='card.html'>card</a></span>(<span class='no'>ncCC89_nb</span>) <span class='kw'>==</span> <span class='fl'>0</span>))
<span class='no'>sub.ncCC89.nb</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/subset'>subset</a></span>(<span class='no'>ncCC89_nb</span>, <span class='no'>drop.no.neighs</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='fu'>sp.correlogram</span>(<span class='no'>sub.ncCC89.nb</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/subset'>subset</a></span>(<span class='no'>tr.SIDS74</span>,  <span class='no'>drop.no.neighs</span>),
 <span class='kw'>order</span><span class='kw'>=</span><span class='fl'>8</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"corr"</span>))</div><div class='img'><img src='sp.correlogram-4.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Roger Bivand, <a href='mailto:Roger.Bivand@nhh.no'>Roger.Bivand@nhh.no</a></p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Roger Bivand.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

