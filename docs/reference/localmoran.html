<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Local Moran's I statistic — localmoran • spdep</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Local Moran's I statistic — localmoran" />
<meta property="og:description" content="The local spatial statistic Moran's I is calculated for each zone based on the
spatial weights object used. The values returned include a Z-value, and may be
used as a diagnostic tool. The statistic is:
$$I_i = \frac{(x_i-\bar{x})}{{\sum_{k=1}^{n}(x_k-\bar{x})^2}/(n-1)}{\sum_{j=1}^{n}w_{ij}(x_j-\bar{x})}$$,
and its expectation and variance are given in Anselin (1995)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spdep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1-9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/CO69.html">“The Problem of Spatial Autocorrelation:” forty years on</a>
    </li>
    <li>
      <a href="../articles/nb.html">Creating Neighbours</a>
    </li>
    <li>
      <a href="../articles/nb_igraph.html">Spatial weights objects as sparse matrices and graphs</a>
    </li>
    <li>
      <a href="../articles/nb_sf.html">Creating Neighbours using sf objects</a>
    </li>
    <li>
      <a href="../articles/sids.html">Introduction to the North Carolina SIDS data set (re-revised)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-spatial/spdep/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Local Moran's I statistic</h1>
    
    <div class="hidden name"><code>localmoran.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The local spatial statistic Moran's I is calculated for each zone based on the
spatial weights object used. The values returned include a Z-value, and may be
used as a diagnostic tool. The statistic is:
$$I_i = \frac{(x_i-\bar{x})}{{\sum_{k=1}^{n}(x_k-\bar{x})^2}/(n-1)}{\sum_{j=1}^{n}w_{ij}(x_j-\bar{x})}$$,
and its expectation and variance are given in Anselin (1995).</p>
    </div>

    <pre class="usage"><span class='fu'>localmoran</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>listw</span>, zero.policy<span class='op'>=</span><span class='cn'>NULL</span>, na.action<span class='op'>=</span><span class='va'>na.fail</span>, conditional<span class='op'>=</span><span class='cn'>FALSE</span>,
  alternative <span class='op'>=</span> <span class='st'>"greater"</span>, p.adjust.method<span class='op'>=</span><span class='st'>"none"</span>, mlvar<span class='op'>=</span><span class='cn'>TRUE</span>,
        spChk<span class='op'>=</span><span class='cn'>NULL</span>, adjust.x<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'>localmoran_perm</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>listw</span>, nsim<span class='op'>=</span><span class='fl'>499</span>, zero.policy<span class='op'>=</span><span class='cn'>NULL</span>, na.action<span class='op'>=</span><span class='va'>na.fail</span>, 
  alternative <span class='op'>=</span> <span class='st'>"greater"</span>, p.adjust.method<span class='op'>=</span><span class='st'>"none"</span>, mlvar<span class='op'>=</span><span class='cn'>TRUE</span>,
        spChk<span class='op'>=</span><span class='cn'>NULL</span>, adjust.x<span class='op'>=</span><span class='cn'>FALSE</span>, sample_Ei<span class='op'>=</span><span class='cn'>TRUE</span>, iseed<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a numeric vector the same length as the neighbours list in listw</p></td>
    </tr>
    <tr>
      <th>listw</th>
      <td><p>a <code>listw</code> object created for example by <code>nb2listw</code></p></td>
    </tr>
    <tr>
      <th>zero.policy</th>
      <td><p>default NULL, use global option value; if TRUE assign zero to the lagged value of zones without neighbours, if FALSE assign NA</p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>a function (default <code>na.fail</code>), can also be <code>na.omit</code> or <code>na.exclude</code> - in these cases the weights list will be subsetted to remove NAs in the data. It may be necessary to set zero.policy to TRUE because this subsetting may create no-neighbour observations. Note that only weights lists created without using the glist argument to <code>nb2listw</code> may be subsetted. If <code>na.pass</code> is used, zero is substituted for NA values in calculating the spatial lag. (Note that na.exclude will only work properly starting from R 1.9.0, na.omit and na.exclude assign the wrong classes in 1.8.*)</p></td>
    </tr>
    <tr>
      <th>conditional</th>
      <td><p>default FALSE: expectation and variance are calculated using the total randomization null (Sokal 1998 Eqs. A3 &amp; A4). If TRUE: expectation and variance are calculated using the conditional randomization null (Sokal 1998 Eqs. A7 &amp; A8). Elaboration of these changes available in Sauer 2021.</p></td>
    </tr>
    <tr>
      <th>alternative</th>
      <td><p>a character string specifying the alternative hypothesis, must be one of greater (default), less or two.sided.</p></td>
    </tr>
    <tr>
      <th>p.adjust.method</th>
      <td><p>a character string specifying the probability value adjustment for multiple tests, default "none"; see <code><a href='p.adjustSP.html'>p.adjustSP</a></code>. Note that the number of multiple tests for each region is only taken as the number of neighbours + 1 for each region, rather than the total number of regions.</p></td>
    </tr>
    <tr>
      <th>mlvar</th>
      <td><p>default TRUE: values of local Moran's I are reported using the variance of the variable of interest (sum of squared deviances over n), but can be reported as the sample variance, dividing by (n-1) instead; both are used in other implementations.</p></td>
    </tr>
    <tr>
      <th>spChk</th>
      <td><p>should the data vector names be checked against the spatial objects for identity integrity, TRUE, or FALSE, default NULL to use <code><a href='set.spChkOption.html'>get.spChkOption()</a></code></p></td>
    </tr>
    <tr>
      <th>adjust.x</th>
      <td><p>default FALSE, if TRUE, x values of observations with no neighbours are omitted in the mean of x</p></td>
    </tr>
    <tr>
      <th>nsim</th>
      <td><p>default 499, number of conditonal permutation simulations</p></td>
    </tr>
    <tr>
      <th>sample_Ei</th>
      <td><p>default TRUE; if conditional permutation, use the sample $E_i$ values, or the analytical values, leaving only variances calculated by simulation.</p></td>
    </tr>
    <tr>
      <th>iseed</th>
      <td><p>default NULL, used to set the seed for possible parallel RNGs</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The values of local Moran's I are divided by the variance (or sample variance) of the variable of interest to accord with Table 1, p. 103, and formula (12), p. 99, in Anselin (1995), rather than his formula (7), p. 98. The variance of the local Moran statistic is taken from Sokal et al. (1998) p. 334, equations 4 &amp; 5 or equations 7 &amp; 8 located depending on user specification. By default, the implementation divides by n, not (n-1) in calculating the variance and higher moments. Conditional code contributed by Jeff Sauer and Levi Wolf.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<p></p>
<dt>Ii</dt><dd><p>local moran statistic</p></dd>
  <dt>E.Ii</dt><dd><p>expectation of local moran statistic</p></dd>
  <dt>Var.Ii</dt><dd><p>variance of local moran statistic</p></dd>
  <dt>Z.Ii</dt><dd><p>standard deviate of local moran statistic</p></dd>
  <dt>Pr()</dt><dd><p>p-value of local moran statistic</p></dd>

    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Conditional permutations added for comparative purposes; permutations are over the whole data vector omitting the observation itself.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Anselin, L. 1995. Local indicators of spatial association,
Geographical Analysis, 27, 93--115;
Getis, A. and Ord, J. K. 1996 Local spatial
statistics: an overview. In P. Longley and M. Batty (eds) <em>Spatial
analysis: modelling in a GIS environment</em> (Cambridge: Geoinformation
International), 261--277; Sokal, R. R, Oden, N. L. and Thomson, B. A. 1998. Local Spatial Autocorrelation in a Biological Model. Geographical Analysis, 30. 331--354; 
Bivand RS, Wong DWS 2018 Comparing implementations of global and local indicators of spatial association. TEST, 27(3), 716--748 doi: <a href='https://doi.org/10.1007/s11749-018-0599-x'>10.1007/s11749-018-0599-x</a>
; 
Sauer, J., Oshan, T. M., Rey, S., &amp; Wolf, L. J. 2021. On Null Hypotheses and Heteroskedasticity. OSF Preprints. doi: <a href='https://doi.org/10.31219/osf.io/ugkhp'>10.31219/osf.io/ugkhp</a></p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Roger Bivand <a href='mailto:Roger.Bivand@nhh.no'>Roger.Bivand@nhh.no</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='localG.html'>localG</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>afcon</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span>
<span class='va'>oid</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>afcon</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span>
<span class='va'>resI</span> <span class='op'>&lt;-</span> <span class='fu'>localmoran</span><span class='op'>(</span><span class='va'>afcon</span><span class='op'>$</span><span class='va'>totcon</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>paper.nb</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/printCoefmat.html'>printCoefmat</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>resI</span><span class='op'>[</span><span class='va'>oid</span>,<span class='op'>]</span>, row.names<span class='op'>=</span><span class='va'>afcon</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='va'>oid</span><span class='op'>]</span><span class='op'>)</span>,
 check.names<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                                  Ii       E.Ii     Var.Ii       Z.Ii Pr.z...0.
#&gt; THE GAMBIA                0.3752254 -0.0243902  0.8707799  0.4282410    0.3342
#&gt; MALI                      0.4636340 -0.0243902  0.1084938  1.4816272    0.0692
#&gt; SENEGAL                   0.2567014 -0.0243902  0.2037796  0.6226838    0.2667
#&gt; BENIN                     0.1941194 -0.0243902  0.2037796  0.4840501    0.3142
#&gt; MAURITANIA                0.0970535 -0.0243902  0.2037796  0.2690263    0.3940
#&gt; NIGER                     0.2307143 -0.0243902  0.1084938  0.7744898    0.2193
#&gt; IVORY COAST               0.2900359 -0.0243902  0.1593129  0.7877586    0.2154
#&gt; GUINEA                    0.1826275 -0.0243902  0.1593129  0.5186592    0.3020
#&gt; BURKINA FASO              0.5082778 -0.0243902  0.1296684  1.4792430    0.0695
#&gt; LIBERIA                   0.1856475 -0.0243902  0.2778907  0.3984375    0.3452
#&gt; SIERRA LEONE              0.2652337 -0.0243902  0.4261130  0.4436823    0.3286
#&gt; GHANA                     0.1476406 -0.0243902  0.2778907  0.3263392    0.3721
#&gt; TOGO                      0.2193448 -0.0243902  0.2778907  0.4623607    0.3219
#&gt; CAMEROON                  0.2592454 -0.0243902  0.1593129  0.7106167    0.2387
#&gt; NIGERIA                   0.1137709 -0.0243902  0.2037796  0.3060593    0.3798
#&gt; GABON                     0.2036649 -0.0243902  0.4261130  0.3493635    0.3634
#&gt; CENTRAL AFRICAN REPUBLIC -0.4420567 -0.0243902  0.1593129 -1.0464153    0.8523
#&gt; CHAD                     -0.1052846 -0.0243902  0.1296684 -0.2246472    0.5889
#&gt; CONGO                     0.0113803 -0.0243902  0.2037796  0.0792401    0.4684
#&gt; ZAIRE                     0.7097807 -0.0243902  0.0802610  2.5914625    0.0048
#&gt; ANGOLA                    0.1179749 -0.0243902  0.2778907  0.2700640    0.3936
#&gt; UGANDA                    1.9425080 -0.0243902  0.1593129  4.9278382    0.0000
#&gt; KENYA                     1.1969287 -0.0243902  0.1593129  3.0598747    0.0011
#&gt; TANZANIA                  0.2718545 -0.0243902  0.0926129  0.9734529    0.1652
#&gt; BURUNDI                  -0.4842787 -0.0243902  0.2778907 -0.8723997    0.8085
#&gt; RWANDA                   -0.7523578 -0.0243902  0.2037796 -1.6126187    0.9466
#&gt; SOMALIA                   0.4527658 -0.0243902  0.4261130  0.7309674    0.2324
#&gt; ETHIOPIA                  0.7251240 -0.0243902  0.2778907  1.4218143    0.0775
#&gt; ZAMBIA                    0.0421598 -0.0243902  0.0926129  0.2186818    0.4134
#&gt; ZIMBABWE                 -0.0095068 -0.0243902  0.2037796  0.0329703    0.4868
#&gt; MALAWI                   -0.2288840 -0.0243902  0.2778907 -0.3879207    0.6510
#&gt; MOZAMBIQUE                0.0167900 -0.0243902  0.1296684  0.1143594    0.4545
#&gt; SOUTH AFRICA             -0.1825396 -0.0243902  0.1084938 -0.4801368    0.6844
#&gt; LESOTHO                  -0.4193478 -0.0243902  0.8707799 -0.4232493    0.6639
#&gt; BOTSWANA                 -0.0039316 -0.0243902  0.2778907  0.0388096    0.4845
#&gt; SWAZILAND                 0.0166842 -0.0243902  0.4261130  0.0629231    0.4749
#&gt; MOROCCO                  -0.0969607 -0.0243902  0.4261130 -0.1111725    0.5443
#&gt; ALGERIA                  -0.0100369 -0.0243902  0.1296684  0.0398599    0.4841
#&gt; TUNISIA                   0.0053873 -0.0243902  0.4261130  0.0456170    0.4818
#&gt; LIBYA                     0.8038237 -0.0243902  0.1296684  2.2999872    0.0107
#&gt; SUDAN                     2.9877738 -0.0243902  0.0926129  9.8978982    0.0000
#&gt; EGYPT                     6.9467291 -0.0243902  0.4261130 10.6792343    0.0000</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>resI</span><span class='op'>[</span>,<span class='fl'>5</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='img'><img src='localmoran-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>resI</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.4167956</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>resI</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='spweights.constants.html'>Szero</a></span><span class='op'>(</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>paper.nb</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.4167956</div><div class='input'><span class='fu'><a href='moran.test.html'>moran.test</a></span><span class='op'>(</span><span class='va'>afcon</span><span class='op'>$</span><span class='va'>totcon</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>paper.nb</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 	Moran I test under randomisation
#&gt; 
#&gt; data:  afcon$totcon  
#&gt; weights: nb2listw(paper.nb)    
#&gt; 
#&gt; Moran I statistic standard deviate = 4.3485, p-value = 6.854e-06
#&gt; alternative hypothesis: greater
#&gt; sample estimates:
#&gt; Moran I statistic       Expectation          Variance 
#&gt;        0.41679563       -0.02439024        0.01029358 
#&gt; </div><div class='input'><span class='co'># note equality for mean() only when the sum of weights equals</span>
<span class='co'># the number of observations (thanks to Juergen Symanzik)</span>
<span class='va'>resI</span> <span class='op'>&lt;-</span> <span class='fu'>localmoran</span><span class='op'>(</span><span class='va'>afcon</span><span class='op'>$</span><span class='va'>totcon</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>paper.nb</span><span class='op'>)</span>,
 p.adjust.method<span class='op'>=</span><span class='st'>"bonferroni"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/printCoefmat.html'>printCoefmat</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>resI</span><span class='op'>[</span><span class='va'>oid</span>,<span class='op'>]</span>, row.names<span class='op'>=</span><span class='va'>afcon</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='va'>oid</span><span class='op'>]</span><span class='op'>)</span>,
 check.names<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                                  Ii       E.Ii     Var.Ii       Z.Ii Pr.z...0.
#&gt; THE GAMBIA                0.3752254 -0.0243902  0.8707799  0.4282410    0.6685
#&gt; MALI                      0.4636340 -0.0243902  0.1084938  1.4816272    0.5538
#&gt; SENEGAL                   0.2567014 -0.0243902  0.2037796  0.6226838    1.0000
#&gt; BENIN                     0.1941194 -0.0243902  0.2037796  0.4840501    1.0000
#&gt; MAURITANIA                0.0970535 -0.0243902  0.2037796  0.2690263    1.0000
#&gt; NIGER                     0.2307143 -0.0243902  0.1084938  0.7744898    1.0000
#&gt; IVORY COAST               0.2900359 -0.0243902  0.1593129  0.7877586    1.0000
#&gt; GUINEA                    0.1826275 -0.0243902  0.1593129  0.5186592    1.0000
#&gt; BURKINA FASO              0.5082778 -0.0243902  0.1296684  1.4792430    0.4868
#&gt; LIBERIA                   0.1856475 -0.0243902  0.2778907  0.3984375    1.0000
#&gt; SIERRA LEONE              0.2652337 -0.0243902  0.4261130  0.4436823    0.9859
#&gt; GHANA                     0.1476406 -0.0243902  0.2778907  0.3263392    1.0000
#&gt; TOGO                      0.2193448 -0.0243902  0.2778907  0.4623607    1.0000
#&gt; CAMEROON                  0.2592454 -0.0243902  0.1593129  0.7106167    1.0000
#&gt; NIGERIA                   0.1137709 -0.0243902  0.2037796  0.3060593    1.0000
#&gt; GABON                     0.2036649 -0.0243902  0.4261130  0.3493635    1.0000
#&gt; CENTRAL AFRICAN REPUBLIC -0.4420567 -0.0243902  0.1593129 -1.0464153    1.0000
#&gt; CHAD                     -0.1052846 -0.0243902  0.1296684 -0.2246472    1.0000
#&gt; CONGO                     0.0113803 -0.0243902  0.2037796  0.0792401    1.0000
#&gt; ZAIRE                     0.7097807 -0.0243902  0.0802610  2.5914625    0.0478
#&gt; ANGOLA                    0.1179749 -0.0243902  0.2778907  0.2700640    1.0000
#&gt; UGANDA                    1.9425080 -0.0243902  0.1593129  4.9278382    0.0000
#&gt; KENYA                     1.1969287 -0.0243902  0.1593129  3.0598747    0.0066
#&gt; TANZANIA                  0.2718545 -0.0243902  0.0926129  0.9734529    1.0000
#&gt; BURUNDI                  -0.4842787 -0.0243902  0.2778907 -0.8723997    1.0000
#&gt; RWANDA                   -0.7523578 -0.0243902  0.2037796 -1.6126187    1.0000
#&gt; SOMALIA                   0.4527658 -0.0243902  0.4261130  0.7309674    0.6972
#&gt; ETHIOPIA                  0.7251240 -0.0243902  0.2778907  1.4218143    0.3102
#&gt; ZAMBIA                    0.0421598 -0.0243902  0.0926129  0.2186818    1.0000
#&gt; ZIMBABWE                 -0.0095068 -0.0243902  0.2037796  0.0329703    1.0000
#&gt; MALAWI                   -0.2288840 -0.0243902  0.2778907 -0.3879207    1.0000
#&gt; MOZAMBIQUE                0.0167900 -0.0243902  0.1296684  0.1143594    1.0000
#&gt; SOUTH AFRICA             -0.1825396 -0.0243902  0.1084938 -0.4801368    1.0000
#&gt; LESOTHO                  -0.4193478 -0.0243902  0.8707799 -0.4232493    1.0000
#&gt; BOTSWANA                 -0.0039316 -0.0243902  0.2778907  0.0388096    1.0000
#&gt; SWAZILAND                 0.0166842 -0.0243902  0.4261130  0.0629231    1.0000
#&gt; MOROCCO                  -0.0969607 -0.0243902  0.4261130 -0.1111725    1.0000
#&gt; ALGERIA                  -0.0100369 -0.0243902  0.1296684  0.0398599    1.0000
#&gt; TUNISIA                   0.0053873 -0.0243902  0.4261130  0.0456170    1.0000
#&gt; LIBYA                     0.8038237 -0.0243902  0.1296684  2.2999872    0.0751
#&gt; SUDAN                     2.9877738 -0.0243902  0.0926129  9.8978982    0.0000
#&gt; EGYPT                     6.9467291 -0.0243902  0.4261130 10.6792343    0.0000</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>resI</span><span class='op'>[</span>,<span class='fl'>5</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='img'><img src='localmoran-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>totcon</span> <span class='op'>&lt;-</span><span class='va'>afcon</span><span class='op'>$</span><span class='va'>totcon</span>
<span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>totcon</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>totcon</span><span class='op'>)</span>, <span class='fl'>5</span><span class='op'>)</span>
<span class='va'>totcon</span>
</div><div class='output co'>#&gt;  [1] 1363 1421 1861 2355 5246  811  299  358  895 4751 1878  933  347 1130  241
#&gt; [16]  604 1015  998 2122 1090  848  618   NA  423   NA 3087 2273 3134 1142  824
#&gt; [31] 2881  487  604 1528 1554  629   NA  795   NA 1875   NA  363</div><div class='input'><span class='va'>resI.na</span> <span class='op'>&lt;-</span> <span class='fu'>localmoran</span><span class='op'>(</span><span class='va'>totcon</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>paper.nb</span><span class='op'>)</span>, na.action<span class='op'>=</span><span class='va'>na.exclude</span>,
 zero.policy<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span><span class='op'>(</span><span class='va'>resI.na</span>, <span class='st'>"na.action"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"exclude"</span><span class='op'>)</span> <span class='op'>{</span>
 <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>resI.na</span><span class='op'>[</span><span class='va'>oid</span>,<span class='op'>]</span>, row.names<span class='op'>=</span><span class='va'>afcon</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='va'>oid</span><span class='op'>]</span><span class='op'>)</span>, digits<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
<span class='op'>}</span> <span class='kw'>else</span> <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>resI.na</span>, digits<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                               Ii   E.Ii Var.Ii    Z.Ii Pr.z...0.
#&gt; THE GAMBIA                0.4383 -0.028  0.872  0.4992   3.1e-01
#&gt; MALI                      0.5172 -0.028  0.128  1.5259   6.4e-02
#&gt; SENEGAL                   0.3087 -0.028  0.202  0.7487   2.3e-01
#&gt; BENIN                     0.2426 -0.028  0.202  0.6017   2.7e-01
#&gt; MAURITANIA                0.1374 -0.028  0.202  0.3676   3.6e-01
#&gt; NIGER                     0.2905 -0.028  0.106  0.9763   1.6e-01
#&gt; IVORY COAST                   NA     NA     NA      NA        NA
#&gt; GUINEA                    0.2697 -0.028  0.276  0.5659   2.9e-01
#&gt; BURKINA FASO              0.5725 -0.028  0.157  1.5133   6.5e-02
#&gt; LIBERIA                       NA     NA     NA      NA        NA
#&gt; SIERRA LEONE              0.3094 -0.028  0.872  0.3611   3.6e-01
#&gt; GHANA                     0.2090 -0.028  0.425  0.3631   3.6e-01
#&gt; TOGO                      0.2665 -0.028  0.276  0.5597   2.9e-01
#&gt; CAMEROON                  0.3110 -0.028  0.157  0.8541   2.0e-01
#&gt; NIGERIA                   0.1583 -0.028  0.202  0.4141   3.4e-01
#&gt; GABON                     0.2498 -0.028  0.425  0.4258   3.4e-01
#&gt; CENTRAL AFRICAN REPUBLIC -0.4053 -0.028  0.157 -0.9518   8.3e-01
#&gt; CHAD                     -0.0834 -0.028  0.128 -0.1557   5.6e-01
#&gt; CONGO                     0.0305 -0.028  0.202  0.1298   4.5e-01
#&gt; ZAIRE                     0.5334 -0.028  0.078  2.0099   2.2e-02
#&gt; ANGOLA                    0.0566 -0.028  0.276  0.1606   4.4e-01
#&gt; UGANDA                    1.6232 -0.028  0.157  4.1624   1.6e-05
#&gt; KENYA                     0.9678 -0.028  0.157  2.5102   6.0e-03
#&gt; TANZANIA                  0.2773 -0.028  0.106  0.9358   1.7e-01
#&gt; BURUNDI                  -0.4467 -0.028  0.276 -0.7969   7.9e-01
#&gt; RWANDA                   -0.7037 -0.028  0.202 -1.5040   9.3e-01
#&gt; SOMALIA                   0.3380 -0.028  0.425  0.5610   2.9e-01
#&gt; ETHIOPIA                  0.5485 -0.028  0.276  1.0961   1.4e-01
#&gt; ZAMBIA                    0.0356 -0.028  0.128  0.1774   4.3e-01
#&gt; ZIMBABWE                 -0.1362 -0.028  0.425 -0.1663   5.7e-01
#&gt; MALAWI                   -0.4725 -0.028  0.425 -0.6820   7.5e-01
#&gt; MOZAMBIQUE                    NA     NA     NA      NA        NA
#&gt; SOUTH AFRICA             -0.1231 -0.028  0.202 -0.2122   5.8e-01
#&gt; LESOTHO                  -0.3572 -0.028  0.872 -0.3529   6.4e-01
#&gt; BOTSWANA                      NA     NA     NA      NA        NA
#&gt; SWAZILAND                     NA     NA     NA      NA        NA
#&gt; MOROCCO                  -0.1011 -0.028  0.425 -0.1124   5.4e-01
#&gt; ALGERIA                   0.0011 -0.028  0.128  0.0807   4.7e-01
#&gt; TUNISIA                  -0.0220 -0.028  0.425  0.0089   5.0e-01
#&gt; LIBYA                     0.6345 -0.028  0.128  1.8544   3.2e-02
#&gt; SUDAN                     2.5128 -0.028  0.090  8.4523   1.4e-17
#&gt; EGYPT                     6.0832 -0.028  0.425  9.3719   3.6e-21</div><div class='input'><span class='va'>resG</span> <span class='op'>&lt;-</span> <span class='fu'><a href='localG.html'>localG</a></span><span class='op'>(</span><span class='va'>afcon</span><span class='op'>$</span><span class='va'>totcon</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='fu'><a href='include.self.html'>include.self</a></span><span class='op'>(</span><span class='va'>paper.nb</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>resG</span><span class='op'>[</span><span class='va'>oid</span><span class='op'>]</span>, row.names<span class='op'>=</span><span class='va'>afcon</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='va'>oid</span><span class='op'>]</span><span class='op'>)</span>, digits<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                          resG.oid.
#&gt; THE GAMBIA                  -0.984
#&gt; MALI                        -1.699
#&gt; SENEGAL                     -1.463
#&gt; BENIN                       -1.301
#&gt; MAURITANIA                  -0.605
#&gt; NIGER                       -1.049
#&gt; IVORY COAST                 -1.417
#&gt; GUINEA                      -1.449
#&gt; BURKINA FASO                -1.751
#&gt; LIBERIA                     -1.041
#&gt; SIERRA LEONE                -0.870
#&gt; GHANA                       -1.103
#&gt; TOGO                        -0.991
#&gt; CAMEROON                    -1.133
#&gt; NIGERIA                     -1.173
#&gt; GABON                       -0.789
#&gt; CENTRAL AFRICAN REPUBLIC     1.173
#&gt; CHAD                         0.463
#&gt; CONGO                       -0.203
#&gt; ZAIRE                        2.023
#&gt; ANGOLA                       1.235
#&gt; UGANDA                       3.336
#&gt; KENYA                        3.503
#&gt; TANZANIA                     1.098
#&gt; BURUNDI                      0.774
#&gt; RWANDA                       1.457
#&gt; SOMALIA                      1.183
#&gt; ETHIOPIA                     2.627
#&gt; ZAMBIA                       0.753
#&gt; ZIMBABWE                    -0.200
#&gt; MALAWI                       0.212
#&gt; MOZAMBIQUE                  -0.288
#&gt; SOUTH AFRICA                -0.868
#&gt; LESOTHO                     -0.298
#&gt; BOTSWANA                     0.041
#&gt; SWAZILAND                   -0.659
#&gt; MOROCCO                      0.022
#&gt; ALGERIA                     -0.363
#&gt; TUNISIA                      0.579
#&gt; LIBYA                        2.553
#&gt; SUDAN                        4.039
#&gt; EGYPT                        4.421</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>resI_p</span> <span class='op'>&lt;-</span> <span class='fu'>localmoran_perm</span><span class='op'>(</span><span class='va'>afcon</span><span class='op'>$</span><span class='va'>totcon</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>paper.nb</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/printCoefmat.html'>printCoefmat</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>resI_p</span><span class='op'>[</span><span class='va'>oid</span>,<span class='op'>]</span>, row.names<span class='op'>=</span><span class='va'>afcon</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='va'>oid</span><span class='op'>]</span><span class='op'>)</span>,
 check.names<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                                   Ii        E.Ii      Var.Ii        Z.Ii
#&gt; THE GAMBIA                3.7523e-01 -3.0853e-02  9.0476e-01  4.2692e-01
#&gt; MALI                      4.6363e-01 -2.1690e-02  1.2192e-01  1.3899e+00
#&gt; SENEGAL                   2.5670e-01 -1.1288e-02  3.2719e-02  1.4816e+00
#&gt; BENIN                     1.9412e-01 -6.5012e-03  2.6046e-02  1.2431e+00
#&gt; MAURITANIA                9.7053e-02 -2.0574e-03  5.7209e-02  4.1437e-01
#&gt; NIGER                     2.3071e-01 -2.8428e-02  1.1981e-01  7.4867e-01
#&gt; IVORY COAST               2.9004e-01 -8.1011e-03  5.5564e-02  1.2648e+00
#&gt; GUINEA                    1.8263e-01  5.3454e-04  1.8397e-02  1.3425e+00
#&gt; BURKINA FASO              5.0828e-01 -2.9727e-02  1.4019e-01  1.4369e+00
#&gt; LIBERIA                   1.8565e-01 -1.9247e-03  3.6524e-02  9.8147e-01
#&gt; SIERRA LEONE              2.6523e-01  1.0225e-02  3.1505e-01  4.5432e-01
#&gt; GHANA                     1.4764e-01 -6.7639e-03  1.8646e-02  1.1307e+00
#&gt; TOGO                      2.1934e-01 -1.8012e-03  6.5187e-02  8.6616e-01
#&gt; CAMEROON                  2.5925e-01 -1.0726e-02  9.4789e-02  8.7688e-01
#&gt; NIGERIA                   1.1377e-01 -2.5672e-03  8.7720e-03  1.2421e+00
#&gt; GABON                     2.0366e-01 -3.5024e-03  1.0958e-01  6.2584e-01
#&gt; CENTRAL AFRICAN REPUBLIC -4.4206e-01  2.3901e-02  8.1700e-02 -1.6302e+00
#&gt; CHAD                     -1.0528e-01  5.9042e-03  3.0168e-02 -6.4016e-01
#&gt; CONGO                     1.1380e-02  7.0349e-03  8.9435e-03  4.5949e-02
#&gt; ZAIRE                     7.0978e-01 -2.9589e-02  2.9068e-01  1.3714e+00
#&gt; ANGOLA                    1.1797e-01 -3.0421e-04  8.6526e-03  1.2716e+00
#&gt; UGANDA                    1.9425e+00 -7.0491e-02  5.2046e-01  2.7903e+00
#&gt; KENYA                     1.1969e+00 -1.6362e-02  1.3644e-01  3.2847e+00
#&gt; TANZANIA                  2.7185e-01 -7.3309e-02  2.3454e-01  7.1272e-01
#&gt; BURUNDI                  -4.8428e-01  9.5351e-03  1.4866e-01 -1.2807e+00
#&gt; RWANDA                   -7.5236e-01 -4.0426e-02  1.7628e-01 -1.6956e+00
#&gt; SOMALIA                   4.5277e-01 -1.1165e-02  2.6266e-01  9.0523e-01
#&gt; ETHIOPIA                  7.2512e-01  8.3618e-04  7.8477e-02  2.5855e+00
#&gt; ZAMBIA                    4.2160e-02 -5.1840e-03  3.6852e-03  7.7989e-01
#&gt; ZIMBABWE                 -9.5068e-03 -6.5338e-03  6.5357e-02 -1.1629e-02
#&gt; MALAWI                   -2.2888e-01  3.6276e-03  1.3417e-01 -6.3477e-01
#&gt; MOZAMBIQUE                1.6790e-02 -2.0694e-03  4.5436e-02  8.8476e-02
#&gt; SOUTH AFRICA             -1.8254e-01 -1.1611e-02  3.0240e-02 -9.8293e-01
#&gt; LESOTHO                  -4.1935e-01 -6.6258e-02  8.7314e-01 -3.7787e-01
#&gt; BOTSWANA                 -3.9316e-03 -4.7713e-03  2.2167e-03  1.7833e-02
#&gt; SWAZILAND                 1.6684e-02 -8.4486e-02  6.4807e-01  1.2567e-01
#&gt; MOROCCO                  -9.6961e-02 -2.1623e-03  1.1253e-01 -2.8260e-01
#&gt; ALGERIA                  -1.0037e-02 -3.4326e-04  6.3541e-04 -3.8456e-01
#&gt; TUNISIA                   5.3873e-03 -1.6456e-04  6.4187e-05  6.9298e-01
#&gt; LIBYA                     8.0382e-01 -2.9038e-02  1.3319e-01  2.2821e+00
#&gt; SUDAN                     2.9878e+00 -2.5952e-01  8.2522e-01  3.5747e+00
#&gt; EGYPT                     6.9467e+00 -3.7869e-01  4.1318e+00  3.6038e+00
#&gt;                          Pr.z...0.
#&gt; THE GAMBIA                  0.3347
#&gt; MALI                        0.0823
#&gt; SENEGAL                     0.0692
#&gt; BENIN                       0.1069
#&gt; MAURITANIA                  0.3393
#&gt; NIGER                       0.2270
#&gt; IVORY COAST                 0.1030
#&gt; GUINEA                      0.0897
#&gt; BURKINA FASO                0.0754
#&gt; LIBERIA                     0.1632
#&gt; SIERRA LEONE                0.3248
#&gt; GHANA                       0.1291
#&gt; TOGO                        0.1932
#&gt; CAMEROON                    0.1903
#&gt; NIGERIA                     0.1071
#&gt; GABON                       0.2657
#&gt; CENTRAL AFRICAN REPUBLIC    0.9485
#&gt; CHAD                        0.7390
#&gt; CONGO                       0.4817
#&gt; ZAIRE                       0.0851
#&gt; ANGOLA                      0.1018
#&gt; UGANDA                      0.0026
#&gt; KENYA                       0.0005
#&gt; TANZANIA                    0.2380
#&gt; BURUNDI                     0.8999
#&gt; RWANDA                      0.9550
#&gt; SOMALIA                     0.1827
#&gt; ETHIOPIA                    0.0049
#&gt; ZAMBIA                      0.2177
#&gt; ZIMBABWE                    0.5046
#&gt; MALAWI                      0.7372
#&gt; MOZAMBIQUE                  0.4647
#&gt; SOUTH AFRICA                0.8372
#&gt; LESOTHO                     0.6472
#&gt; BOTSWANA                    0.4929
#&gt; SWAZILAND                   0.4500
#&gt; MOROCCO                     0.6113
#&gt; ALGERIA                     0.6497
#&gt; TUNISIA                     0.2442
#&gt; LIBYA                       0.0112
#&gt; SUDAN                       0.0002
#&gt; EGYPT                       0.0002</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Roger Bivand.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


